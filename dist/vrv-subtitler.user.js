// ==UserScript==
// @name         VRV Subtitler
// @namespace    http://tampermonkey.net/
// @version      0.1.26
// @description  Display SRT format subtitles on VRV
// @author       sheodox
// @match        https://static.vrv.co/vilos/player.html
// @grant        GM_getValue
// @grant        GM_setValue
// ==/UserScript==

!function(t){var e={};function n(c){if(e[c])return e[c].exports;var r=e[c]={i:c,l:!1,exports:{}};return t[c].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,c){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:c})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var c=Object.create(null);if(n.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(c,r,function(e){return t[e]}.bind(null,r));return c},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=10)}([function(t,e,n){"use strict";function c(){}n.d(e,"a",(function(){return Nt})),n.d(e,"b",(function(){return st})),n.d(e,"c",(function(){return ot})),n.d(e,"d",(function(){return q})),n.d(e,"e",(function(){return x})),n.d(e,"f",(function(){return o})),n.d(e,"g",(function(){return A})),n.d(e,"h",(function(){return Tt})),n.d(e,"i",(function(){return X})),n.d(e,"j",(function(){return gt})),n.d(e,"k",(function(){return p})),n.d(e,"l",(function(){return Q})),n.d(e,"m",(function(){return V})),n.d(e,"n",(function(){return $t})),n.d(e,"o",(function(){return At})),n.d(e,"p",(function(){return yt})),n.d(e,"q",(function(){return vt})),n.d(e,"r",(function(){return Ht})),n.d(e,"s",(function(){return v})),n.d(e,"t",(function(){return y})),n.d(e,"u",(function(){return $})),n.d(e,"v",(function(){return C})),n.d(e,"w",(function(){return St})),n.d(e,"x",(function(){return Y})),n.d(e,"y",(function(){return wt})),n.d(e,"z",(function(){return Ot})),n.d(e,"A",(function(){return r})),n.d(e,"B",(function(){return Ft})),n.d(e,"C",(function(){return m})),n.d(e,"D",(function(){return u})),n.d(e,"E",(function(){return E})),n.d(e,"F",(function(){return h})),n.d(e,"G",(function(){return Pt})),n.d(e,"H",(function(){return c})),n.d(e,"I",(function(){return d})),n.d(e,"J",(function(){return L})),n.d(e,"K",(function(){return J})),n.d(e,"L",(function(){return kt})),n.d(e,"M",(function(){return T})),n.d(e,"N",(function(){return j})),n.d(e,"O",(function(){return l})),n.d(e,"P",(function(){return a})),n.d(e,"Q",(function(){return F})),n.d(e,"R",(function(){return N})),n.d(e,"S",(function(){return M})),n.d(e,"T",(function(){return S})),n.d(e,"U",(function(){return b})),n.d(e,"V",(function(){return w})),n.d(e,"W",(function(){return k})),n.d(e,"X",(function(){return H})),n.d(e,"Y",(function(){return R})),n.d(e,"Z",(function(){return ht})),n.d(e,"ab",(function(){return xt})),n.d(e,"bb",(function(){return Ct})),n.d(e,"cb",(function(){return P}));const r=t=>t;function o(t,e){for(const n in e)t[n]=e[n];return t}function s(t){return t()}function i(){return Object.create(null)}function l(t){t.forEach(s)}function u(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function b(t,...e){if(null==t)return c;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function p(t,e,n){t.$$.on_destroy.push(b(e,n))}const f="undefined"!=typeof window;let d=f?()=>window.performance.now():()=>Date.now(),j=f?t=>requestAnimationFrame(t):c;const O=new Set;function g(t){O.forEach(e=>{e.c(t)||(O.delete(e),e.f())}),0!==O.size&&j(g)}function h(t){let e;return 0===O.size&&j(g),{promise:new Promise(n=>{O.add(e={c:t,f:n})}),abort(){O.delete(e)}}}function x(t,e){t.appendChild(e)}function m(t,e,n){t.insertBefore(e,n||null)}function y(t){t.parentNode.removeChild(t)}function v(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function $(t){return document.createElement(t)}function w(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function k(t){return document.createTextNode(t)}function S(){return k(" ")}function C(){return k("")}function E(t,e,n,c){return t.addEventListener(e,n,c),()=>t.removeEventListener(e,n,c)}function T(t){return function(e){return e.preventDefault(),t.call(this,e)}}function A(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function P(t,e,n){t.setAttributeNS("http://www.w3.org/1999/xlink",e,n)}function H(t){return""===t?void 0:+t}function F(t,e){e=""+e,t.data!==e&&(t.data=e)}function N(t,e){(null!=e||t.value)&&(t.value=e)}function M(t,e,n,c){t.style.setProperty(e,n,c?"important":"")}function R(t,e,n){t.classList[n?"add":"remove"](e)}function _(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}let W,I,z=0,B={};function G(t,e,n,c,r,o,s,i=0){const l=16.666/c;let u="{\n";for(let t=0;t<=1;t+=l){const c=e+(n-e)*o(t);u+=100*t+`%{${s(c,1-c)}}\n`}const a=u+`100% {${s(n,1-n)}}\n}`,b=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(a)}_${i}`;if(!B[b]){if(!W){const t=$("style");document.head.appendChild(t),W=t.sheet}B[b]=!0,W.insertRule(`@keyframes ${b} ${a}`,W.cssRules.length)}const p=t.style.animation||"";return t.style.animation=`${p?`${p}, `:""}${b} ${c}ms linear ${r}ms 1 both`,z+=1,b}function Z(t,e){t.style.animation=(t.style.animation||"").split(", ").filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")).join(", "),e&&!--z&&j(()=>{if(z)return;let t=W.cssRules.length;for(;t--;)W.deleteRule(t);B={}})}function V(t,e,n,o){if(!e)return c;const s=t.getBoundingClientRect();if(e.left===s.left&&e.right===s.right&&e.top===s.top&&e.bottom===s.bottom)return c;const{delay:i=0,duration:l=300,easing:u=r,start:a=d()+i,end:b=a+l,tick:p=c,css:f}=n(t,{from:e,to:s},o);let j,O=!0,g=!1;function x(){f&&Z(t,j),O=!1}return h(t=>{if(!g&&t>=a&&(g=!0),g&&t>=b&&(p(1,0),x()),!O)return!1;if(g){const e=0+1*u((t-a)/l);p(e,1-e)}return!0}),f&&(j=G(t,0,1,l,i,u,f)),i||(g=!0),p(0,1),x}function Y(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:n,height:c}=e,r=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=c,q(t,r)}}function q(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const c=getComputedStyle(t),r="none"===c.transform?"":c.transform;t.style.transform=`${r} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}function K(t){I=t}function D(){if(!I)throw new Error("Function called outside component initialization");return I}function J(t){D().$$.on_mount.push(t)}function L(t){D().$$.on_destroy.push(t)}function Q(){const t=D();return(e,n)=>{const c=t.$$.callbacks[e];if(c){const r=_(e,n);c.slice().forEach(e=>{e.call(t,r)})}}}const U=[],X=[],tt=[],et=[],nt=Promise.resolve();let ct=!1;function rt(){ct||(ct=!0,nt.then(ut))}function ot(t){tt.push(t)}function st(t){et.push(t)}let it=!1;const lt=new Set;function ut(){if(!it){it=!0;do{for(let t=0;t<U.length;t+=1){const e=U[t];K(e),at(e.$$)}for(U.length=0;X.length;)X.pop()();for(let t=0;t<tt.length;t+=1){const e=tt[t];lt.has(e)||(lt.add(e),e())}tt.length=0}while(U.length);for(;et.length;)et.pop()();ct=!1,it=!1,lt.clear()}}function at(t){if(null!==t.fragment){t.update(),l(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ot)}}let bt;function pt(){return bt||(bt=Promise.resolve(),bt.then(()=>{bt=null})),bt}function ft(t,e,n){t.dispatchEvent(_(`${e?"intro":"outro"}${n}`))}const dt=new Set;let jt;function Ot(){jt={r:0,c:[],p:jt}}function gt(){jt.r||l(jt.c),jt=jt.p}function ht(t,e){t&&t.i&&(dt.delete(t),t.i(e))}function xt(t,e,n,c){if(t&&t.o){if(dt.has(t))return;dt.add(t),jt.c.push(()=>{dt.delete(t),c&&(n&&t.d(1),c())}),t.o(e)}}const mt={duration:0};function yt(t,e,n){let o,s,i=e(t,n),l=!1,a=0;function b(){o&&Z(t,o)}function p(){const{delay:e=0,duration:n=300,easing:u=r,tick:p=c,css:f}=i||mt;f&&(o=G(t,0,1,n,e,u,f,a++)),p(0,1);const j=d()+e,O=j+n;s&&s.abort(),l=!0,ot(()=>ft(t,!0,"start")),s=h(e=>{if(l){if(e>=O)return p(1,0),ft(t,!0,"end"),b(),l=!1;if(e>=j){const t=u((e-j)/n);p(t,1-t)}}return l})}let f=!1;return{start(){f||(Z(t),u(i)?(i=i(),pt().then(p)):p())},invalidate(){f=!1},end(){l&&(b(),l=!1)}}}function vt(t,e,n){let o,s=e(t,n),i=!0;const a=jt;function b(){const{delay:e=0,duration:n=300,easing:u=r,tick:b=c,css:p}=s||mt;p&&(o=G(t,1,0,n,e,u,p));const f=d()+e,j=f+n;ot(()=>ft(t,!1,"start")),h(e=>{if(i){if(e>=j)return b(0,1),ft(t,!1,"end"),--a.r||l(a.c),!1;if(e>=f){const t=u((e-f)/n);b(1-t,t)}}return i})}return a.r+=1,u(s)?pt().then(()=>{s=s(),b()}):b(),{end(e){e&&s.tick&&s.tick(1,0),i&&(o&&Z(t,o),i=!1)}}}function $t(t,e,n,o){let s=e(t,n),i=o?0:1,a=null,b=null,p=null;function f(){p&&Z(t,p)}function j(t,e){const n=t.b-i;return e*=Math.abs(n),{a:i,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function O(e){const{delay:n=0,duration:o=300,easing:u=r,tick:O=c,css:g}=s||mt,x={start:d()+n,b:e};e||(x.group=jt,jt.r+=1),a?b=x:(g&&(f(),p=G(t,i,e,o,n,u,g)),e&&O(0,1),a=j(x,o),ot(()=>ft(t,e,"start")),h(e=>{if(b&&e>b.start&&(a=j(b,o),b=null,ft(t,a.b,"start"),g&&(f(),p=G(t,i,a.b,a.duration,0,u,s.css))),a)if(e>=a.end)O(i=a.b,1-i),ft(t,a.b,"end"),b||(a.b?f():--a.group.r||l(a.group.c)),a=null;else if(e>=a.start){const t=e-a.start;i=a.a+a.d*u(t/a.duration),O(i,1-i)}return!(!a&&!b)}))}return{run(t){u(s)?pt().then(()=>{s=s(),O(t)}):O(t)},end(){f(),a=b=null}}}const wt="undefined"!=typeof window?window:global;function kt(t,e){xt(t,1,1,()=>{e.delete(t.key)})}function St(t,e){t.f(),kt(t,e)}function Ct(t,e,n,c,r,o,s,i,l,u,a,b){let p=t.length,f=o.length,d=p;const j={};for(;d--;)j[t[d].key]=d;const O=[],g=new Map,h=new Map;for(d=f;d--;){const t=b(r,o,d),i=n(t);let l=s.get(i);l?c&&l.p(t,e):(l=u(i,t),l.c()),g.set(i,O[d]=l),i in j&&h.set(i,Math.abs(d-j[i]))}const x=new Set,m=new Set;function y(t){ht(t,1),t.m(i,a),s.set(t.key,t),a=t.first,f--}for(;p&&f;){const e=O[f-1],n=t[p-1],c=e.key,r=n.key;e===n?(a=e.first,p--,f--):g.has(r)?!s.has(c)||x.has(c)?y(e):m.has(r)?p--:h.get(c)>h.get(r)?(m.add(c),y(e)):(x.add(r),p--):(l(n,s),p--)}for(;p--;){const e=t[p];g.has(e.key)||l(e,s)}for(;f;)y(O[f-1]);return O}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let Et;function Tt(t,e,n){const c=t.$$.props[e];void 0!==c&&(t.$$.bound[c]=n,n(t.$$.ctx[c]))}function At(t){t&&t.c()}function Pt(t,e,n){const{fragment:c,on_mount:r,on_destroy:o,after_update:i}=t.$$;c&&c.m(e,n),ot(()=>{const e=r.map(s).filter(u);o?o.push(...e):l(e),t.$$.on_mount=[]}),i.forEach(ot)}function Ht(t,e){const n=t.$$;null!==n.fragment&&(l(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ft(t,e,n,r,o,s,u=[-1]){const a=I;K(t);const b=e.props||{},p=t.$$={fragment:null,ctx:null,props:s,update:c,not_equal:o,bound:i(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:i(),dirty:u};let f=!1;p.ctx=n?n(t,b,(e,n,...c)=>{const r=c.length?c[0]:n;return p.ctx&&o(p.ctx[e],p.ctx[e]=r)&&(p.bound[e]&&p.bound[e](r),f&&function(t,e){-1===t.$$.dirty[0]&&(U.push(t),rt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(t,e)),n}):[],p.update(),f=!0,l(p.before_update),p.fragment=!!r&&r(p.ctx),e.target&&(e.hydrate?p.fragment&&p.fragment.l(function(t){return Array.from(t.childNodes)}(e.target)):p.fragment&&p.fragment.c(),e.intro&&ht(t.$$.fragment),Pt(t,e.target,e.anchor),ut()),K(a)}"function"==typeof HTMLElement&&(Et=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}$destroy(){Ht(this,1),this.$destroy=c}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}});class Nt{$destroy(){Ht(this,1),this.$destroy=c}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var c=n(0);function r(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1}function o(t){const e=t-1;return e*e*e+1}n.d(e,"c",(function(){return c.A}))},function(t,e,n){"use strict";var c=n(0);n.d(e,"a",(function(){return c.l})),n.d(e,"b",(function(){return c.J})),n.d(e,"c",(function(){return c.K}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var c=n(1);n(0);function r(t,{delay:e=0,duration:n=400,easing:r=c.c}){const o=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:r,css:t=>`opacity: ${t*o}`}}function o(t,{delay:e=0,duration:n=400,easing:r=c.b,x:o=0,y:s=0,opacity:i=0}){const l=getComputedStyle(t),u=+l.opacity,a="none"===l.transform?"":l.transform,b=u*(1-i);return{delay:e,duration:n,easing:r,css:(t,e)=>`\n\t\t\ttransform: ${a} translate(${(1-t)*o}px, ${(1-t)*s}px);\n\t\t\topacity: ${u-b*e}`}}},,,,function(t,e){t.exports=class{constructor(t,e){this.format=t,this.fileName=e,this.subs=[]}getSubs(t){return this.subs.filter(e=>e.start<=t&&e.end>=t)}timeToMs(t){const[e,n,c]=t.split(":");return 36e5*+e+6e4*+n+1e3*parseFloat(c)}firstSubtitle(){return this.subs.reduce((t,e)=>e.start<t.start?e:t,{start:1/0})}}},function(t,e,n){const c=n(7),r=t=>(t.charAt(0).toLowerCase()+t.substring(1)).replace(" ",""),o=t=>{if(t){t=(t=t.replace(/[&H]/g,"")).padStart(8,"0");const[e,n,c,r,o]=t.match(/([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})/i),s=t=>parseInt(t,16);return`rgba(${s(o)}, ${s(r)}, ${s(c)}, ${255-s(n)})`}},s=(t,e,n="transparent",c=0,r=0)=>{const o=t||n;c*=2,r=`${r}px`;const s=[];for(let t=-1*(e=2*(void 0===e?1:e));t<=e;t++)for(let n=-1*e;n<=e;n++)s.push(`${t}px ${n}px ${r} ${o}`);return`text-shadow: ${s.join(", ")}, ${c}px ${c}px ${r} ${n}`},i=t=>`font-family: "${t}", "Source Han Sans", "源ノ角ゴシック", "Hiragino Sans", "HiraKakuProN-W3", "Hiragino Kaku Gothic ProN W3", "Hiragino Kaku Gothic ProN", "ヒラギノ角ゴ ProN W3", "Noto Sans", "Noto Sans CJK JP", "メイリオ", Meiryo, "游ゴシック", YuGothic, "ＭＳ Ｐゴシック", "MS PGothic", "ＭＳ ゴシック", "MS Gothic", sans-serif`;function l(t,e,n=!1){const c=new RegExp(n?`\\\\${e}\\((.*?)\\)`:`\\\\${e}([^\\\\}]*)`),r=t.match(c);if(r)return{overrides:t.replace(r[0],""),params:n?r[1].split(","):r[1]}}t.exports=class extends c{constructor(t,e){super("ass",e),t=t.replace(/\r\n/g,"\n");try{this.blocks=this.parseBlocks(t),this.subs=this.parseBlock(this.blocks.subs),this.parseInfo(this.blocks.info),this.parseSubTimings(),this.parseStyles(this.parseBlock(this.blocks.styles)),this.parseSubOverrideTags()}catch(t){console.error("ASS PARSE ERROR",t),this.subs=[]}}serialize(){return JSON.stringify({info:this.info,styles:this.styles,subs:this.subs},null,4)}debugInfo(){return[{title:"Number of styles",detail:Object.keys(this.styles).length},{title:"Number of subtitles",detail:this.subs.length}]}parseInfo(){this.info={},this.blocks.info.split("\n").forEach(t=>{const[e,n]=t.split(": ");this.info[r(e)]=n})}scaleHeight(t){return`${t/+this.info.playResY*100}vh`}scaleWidth(t){return`${t/+this.info.playResX*100}vw`}parseBlocks(t){const e=t.split(/\n(?=\[)/),n=t=>e.find(e=>{e=e.trim();const[n,c]=e.match(/^\[(.*?)]/);return c===t}).replace(/.*\n/,"").trim();return{info:n("Script Info"),styles:n("V4+ Styles"),subs:n("Events")}}parseBlock(t){const[e,...n]=t.split("\n"),c=(t,e=1/0)=>{let[n,c,r]=t.match(/(\w*): (.*)/);return r=r.split(","),r.length>e&&(r[e-1]=r.slice(e-1).join(","),r.splice(e,1/0)),{type:c,attributes:r}},o=c(e);return n.reduce((t,e)=>{if(!e||";"===e.charAt(0)||0===e.indexOf("Comment: "))return t;const n=c(e,o.attributes.length),s={dataType:n.type.toLowerCase()};return o.attributes.forEach((t,e)=>{t=t.trim();const c=r(t);s[c]=n.attributes[e]}),s.style="*Default"===s.style?"Default":s.style,t.push(s),t},[])}parseSubTimings(){this.subs.forEach(t=>{t.start=this.timeToMs(t.start),t.end=this.timeToMs(t.end)})}parseStyles(t){const e={};t.forEach(t=>{for(const e of Object.keys(t).filter(t=>/colour/i.test(t)))t[e]=o(t[e]);t.name="*Default"===t.name?"Default":t.name;const n=[],{primaryColour:c,secondaryColour:r,outlineColour:l,backColour:u,borderStyle:a,outline:b,shadow:p,fontname:f,fontsize:d,bold:j,italic:O,underline:g,strikeOut:h}=t;c&&n.push(`color: ${c}`),f&&n.push(i(f)),"1"===a?n.push(s(l,b,u,p)):"3"===a&&n.push(`background-color: ${u}`),"-1"===j&&n.push("font-weight: bold"),"-1"===O&&n.push("font-style: italic"),"-1"!==g&&"-1"!==h||n.push(`text-decoration: ${"-1"===g?"underline":""} ${"-1"===h?"line-through":""}`),e[t.name]={inline:n.join(";"),...this.genScaledFont(d),raw:t}}),this.styles=e}genScaledFont(t){return{fontScaled:this.scaleHeight(.75*t),fontMax:`${t}px`,fontScalingThreshold:+this.info.playResY,fontRaw:t}}parseSubOverrideTags(){this.subs.forEach(t=>{if(t.rawText=t.text,t.text=t.text.replace("\\N","\n"),!/{.+?}/.test(t.text))return;t.phrases=[];const e=t=>t.replace(/{.*?}/g,""),n=function*(t){const e=/({.*?}[^{]*)/g;let n;const c=t.indexOf("{");for(c>0&&(yield t.substring(0,c));null!==(n=e.exec(t));)yield n[1]}(t.text);let c=[];for(const a of n){const n=[],b={text:e(a),fadeIn:0,fadeOut:0,inline:""};let p,f,d,j,O,g=a.match(/{.*?}/),h=g?g[0]:"";function r(t,e=!1,n=(()=>{})){const c=l(h,t,e);c&&(n(c.params),h=c.overrides)}function u(t,e,n){const c=t.map((t,n)=>{const c=Array.isArray(e)?e[n]:e,r=l(h,t,c);if(r)return h=r.overrides,r.params});c.some(t=>void 0!==t)&&n(...c)}if(r("fscx"),r("fscy"),r("3c",!1,t=>{p=t}),r("4c",!1,t=>{f=t}),r("bord",!1,t=>{d=t}),r("shad",!1,t=>{j=t}),r("blur",!1,t=>{O=t}),r("be",!1,t=>{O=t}),[p,f,d,j,O].some(t=>void 0!==t)){const e=this.styles[t.style],n=(t,n)=>void 0!==t?t:e.raw[n];e&&(p=n(o(p),"outlineColour"),f=n(o(f),"backColour"),d=n(d,"outline"),j=n(j,"shadow"),c.push(s(p,d,f,j,O)))}u(["pos","an","org"],[!0,!1,!0],(t,e="5",r)=>{if(t){const[o,s]=t;n.push(`position: fixed; left: ${this.scaleWidth(o)}; top: ${this.scaleHeight(s)}`);const i={1:"50%, -150%",2:"-50%, -150%",3:"-150%, -150%",4:"50%, -50%",5:"-50%, -50%",6:"-150%, -50%",7:"50%, 50%",8:"-50%, 50%",9:"-150%, 50%"}[e];if(n.push(`transform: translate(${i})`),r){const[t,e]=r;c.push(`transform-origin: ${this.scaleWidth(t)} ${this.scaleHeight(e)}`)}}}),u(["frx","fry","frz"],!1,(t,e,r)=>{const o=[],s=(t,e,n=1)=>{if(void 0!==t)return t=parseFloat(t)*n,o.push(`rotate3d(${e.join(", ")}, ${t}deg)`)};s(t,[1,0,0]),s(r,[0,0,1],-1),s(e,[0,1,0]),o.length&&(n.push("perspective: 200px"),c.push(`display: block; transform: ${o.join(" ")}`))}),r("fad",!0,([e,n])=>{b.fadeIn=e,b.fadeOut=n,t.end-=n}),r("fsp",!1,t=>{c.push(`letter-spacing: ${t}px`)}),r("fs",!1,t=>{Object.assign(b,this.genScaledFont(t))});const x=[];r("u",!1,t=>{x.push("underline")}),r("s",!1,t=>{x.push("line-through")}),c.push(`text-decoration: ${x.length?x.join(" "):"none"}`),r("b",!1,t=>{c.push(`font-weight: ${t?"bold":"normal"}`)}),r("i",!1,t=>{c.push(`font-style: ${t?"italic":"normal"}`)}),r("fn",!1,t=>{c.push(i(t))}),r("1c",!1,t=>{c.push(`color: ${o(t)}`)}),r("r",!1,t=>{if(t){const e=this.styles[t];c=[e.inline],Object.assign(b,this.genScaledFont(e.fontRaw))}else c=[]}),b.inline=c.join(";"),t.phrases.push(b),n.length&&(t.inline=n.join(";"))}t.text=e(t.text)})}}},,function(t,e,n){"use strict";n.r(e);var c=n(0),r=n(2),o=n(3),s=n(1);function i(t,e,n){const r=getComputedStyle(t),o="none"===r.transform?"":r.transform,i=e.from.width/t.clientWidth,l=e.from.height/t.clientHeight,u=(e.from.left-e.to.left)/i,a=(e.from.top-e.to.top)/l,b=Math.sqrt(u*u+a*a),{delay:p=0,duration:f=(t=>120*Math.sqrt(t)),easing:d=s.b}=n;return{delay:p,duration:Object(c.D)(f)?f(b):f,easing:d,css:(t,e)=>`transform: ${o} translate(${e*u}px, ${e*a}px);`}}const l=[];function u(t,e=c.H){let n;const r=[];function o(e){if(Object(c.P)(t,e)&&(t=e,n)){const e=!l.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),l.push(n,t)}if(e){for(let t=0;t<l.length;t+=2)l[t][0](l[t+1]);l.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(s,i=c.H){const l=[s,i];return r.push(l),1===r.length&&(n=e(o)||c.H),s(t),()=>{const t=r.indexOf(l);-1!==t&&r.splice(t,1),0===r.length&&(n(),n=null)}}}}function a(t){return"[object Date]"===Object.prototype.toString.call(t)}function b(t,e){if(t===e||t!=t)return()=>t;const n=typeof t;if(n!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const n=e.map((e,n)=>b(t[n],e));return t=>n.map(e=>e(t))}if("object"===n){if(!t||!e)throw new Error("Object cannot be null");if(a(t)&&a(e)){t=t.getTime();const n=(e=e.getTime())-t;return e=>new Date(t+e*n)}const n=Object.keys(e),c={};return n.forEach(n=>{c[n]=b(t[n],e[n])}),t=>{const e={};return n.forEach(n=>{e[n]=c[n](t)}),e}}if("number"===n){const n=e-t;return e=>t+e*n}throw new Error(`Cannot interpolate ${n} values`)}function p(t,e,n){const c=t.slice();return c[28]=e[n],c}function f(t,e,n){const c=t.slice();return c[31]=e[n],c[33]=n,c}function d(t){let e,n,r,o,s,i,l,u,a,b,d,j,h,x,m,y,v,$,w,k,S,C,E,T,A,P,H,F,N,M,R,_,W,I,z,B,G,Z,V,Y,q,K,D,J,L,Q,U,X,tt,et,nt,ct,rt,ot,st,it,lt,ut,at,bt,pt,ft,dt,jt,Ot=[],gt=new Map,ht=t[3].fileName+"",xt=t[4]>0?"+":"",mt=(t[4]/1e3).toFixed(1)+"",yt=t[2];const vt=t=>t[31].text;for(let e=0;e<yt.length;e+=1){let n=f(t,yt,e),c=vt(n);gt.set(c,Ot[e]=O(c,n))}let $t=t[3].debugInfo(),wt=[];for(let e=0;e<$t.length;e+=1)wt[e]=g(p(t,$t,e));return{c(){e=Object(c.u)("div"),n=Object(c.u)("button"),r=Object(c.W)("Recent Subtitles"),s=Object(c.T)(),i=Object(c.u)("button"),l=Object(c.W)("Settings"),a=Object(c.T)(),b=Object(c.u)("button"),d=Object(c.W)("Debug"),h=Object(c.T)(),x=Object(c.u)("div"),m=Object(c.u)("h2"),m.textContent="Recent Subtitles",y=Object(c.T)(),v=Object(c.u)("ul");for(let t=0;t<Ot.length;t+=1)Ot[t].c();$=Object(c.T)(),w=Object(c.u)("div"),k=Object(c.u)("h2"),k.textContent="Settings",S=Object(c.T)(),C=Object(c.u)("div"),E=Object(c.u)("button"),E.textContent="Reselect subtitles",T=Object(c.T)(),A=Object(c.u)("button"),A.textContent="Realign subtitles",P=Object(c.T)(),H=Object(c.u)("div"),F=Object(c.u)("label"),F.textContent="Subtitle fallback color:",N=Object(c.T)(),M=Object(c.u)("input"),R=Object(c.T)(),_=Object(c.u)("div"),W=Object(c.u)("input"),I=Object(c.T)(),z=Object(c.u)("label"),z.textContent="Show subs over video",B=Object(c.T)(),G=Object(c.u)("div"),Z=Object(c.u)("input"),V=Object(c.T)(),Y=Object(c.u)("label"),Y.textContent="Pause when tray is open",q=Object(c.T)(),K=Object(c.u)("div"),D=Object(c.u)("input"),J=Object(c.T)(),L=Object(c.u)("label"),L.textContent="Invert subtitle vertical alignment (i.e. if subtitles should be near the bottom this will make them show near the top).\n\t\t\t\t\tYou'll likely want this enabled if you intend to watch with VRV's subtitles at the same time.",Q=Object(c.T)(),U=Object(c.u)("div"),X=Object(c.u)("h2"),X.textContent="Debug Information",tt=Object(c.T)(),et=Object(c.u)("dl"),nt=Object(c.u)("dt"),nt.textContent="Subtitles File",ct=Object(c.u)("dd"),rt=Object(c.W)(ht),ot=Object(c.u)("dt"),ot.textContent="Alignment",st=Object(c.u)("dd"),it=Object(c.W)(xt),lt=Object(c.W)(mt),ut=Object(c.W)(" seconds");for(let t=0;t<wt.length;t+=1)wt[t].c();at=Object(c.T)(),bt=Object(c.u)("a"),pt=Object(c.W)("⬇ Download Parsed Subtitles"),n.disabled=o="recent"===t[6],i.disabled=u="settings"===t[6],b.disabled=j="debug"===t[6],Object(c.g)(e,"class","tray-tab-buttons svelte-12u2uy7"),Object(c.g)(m,"class","svelte-12u2uy7"),Object(c.g)(v,"class","recent-subs svelte-12u2uy7"),Object(c.g)(x,"class","tab svelte-12u2uy7"),Object(c.Y)(x,"tab-active","recent"===t[6]),Object(c.g)(k,"class","svelte-12u2uy7"),Object(c.g)(C,"class","row svelte-12u2uy7"),Object(c.g)(F,"for","subtitle-color"),Object(c.g)(M,"type","color"),Object(c.g)(M,"id","subtitle-color"),Object(c.g)(H,"class","row svelte-12u2uy7"),Object(c.g)(W,"id","show-subs"),Object(c.g)(W,"type","checkbox"),W.checked=!0,Object(c.g)(z,"for","show-subs"),Object(c.g)(_,"class","row svelte-12u2uy7"),Object(c.g)(Z,"id","pause-on-tray"),Object(c.g)(Z,"type","checkbox"),Object(c.g)(Y,"for","pause-on-tray"),Object(c.g)(G,"class","row svelte-12u2uy7"),Object(c.g)(D,"id","invert-subtitle-alignment"),Object(c.g)(D,"type","checkbox"),Object(c.g)(L,"for","invert-subtitle-alignment"),Object(c.g)(K,"class","row svelte-12u2uy7"),Object(c.g)(w,"class","tab svelte-12u2uy7"),Object(c.Y)(w,"tab-active","settings"===t[6]),Object(c.g)(X,"class","svelte-12u2uy7"),Object(c.g)(nt,"class","svelte-12u2uy7"),Object(c.g)(ct,"class","svelte-12u2uy7"),Object(c.g)(ot,"class","svelte-12u2uy7"),Object(c.g)(st,"class","svelte-12u2uy7"),Object(c.g)(bt,"href",ft=t[12]()),Object(c.g)(bt,"download","parsed-subtitles.json"),Object(c.g)(bt,"class","svelte-12u2uy7"),Object(c.g)(U,"class","tab svelte-12u2uy7"),Object(c.Y)(U,"tab-active","debug"===t[6])},m(o,u){Object(c.C)(o,e,u),Object(c.e)(e,n),Object(c.e)(n,r),Object(c.e)(e,s),Object(c.e)(e,i),Object(c.e)(i,l),Object(c.e)(e,a),Object(c.e)(e,b),Object(c.e)(b,d),Object(c.C)(o,h,u),Object(c.C)(o,x,u),Object(c.e)(x,m),Object(c.e)(x,y),Object(c.e)(x,v);for(let t=0;t<Ot.length;t+=1)Ot[t].m(v,null);Object(c.C)(o,$,u),Object(c.C)(o,w,u),Object(c.e)(w,k),Object(c.e)(w,S),Object(c.e)(w,C),Object(c.e)(C,E),Object(c.e)(C,T),Object(c.e)(C,A),Object(c.e)(w,P),Object(c.e)(w,H),Object(c.e)(H,F),Object(c.e)(H,N),Object(c.e)(H,M),Object(c.R)(M,t[1]),Object(c.e)(w,R),Object(c.e)(w,_),Object(c.e)(_,W),Object(c.e)(_,I),Object(c.e)(_,z),Object(c.e)(w,B),Object(c.e)(w,G),Object(c.e)(G,Z),Z.checked=t[7],Object(c.e)(G,V),Object(c.e)(G,Y),Object(c.e)(w,q),Object(c.e)(w,K),Object(c.e)(K,D),D.checked=t[0],Object(c.e)(K,J),Object(c.e)(K,L),Object(c.C)(o,Q,u),Object(c.C)(o,U,u),Object(c.e)(U,X),Object(c.e)(U,tt),Object(c.e)(U,et),Object(c.e)(et,nt),Object(c.e)(et,ct),Object(c.e)(ct,rt),Object(c.e)(et,ot),Object(c.e)(et,st),Object(c.e)(st,it),Object(c.e)(st,lt),Object(c.e)(st,ut);for(let t=0;t<wt.length;t+=1)wt[t].m(et,null);Object(c.e)(U,at),Object(c.e)(U,bt),Object(c.e)(bt,pt),dt=!0,jt=[Object(c.E)(n,"click",t[19]),Object(c.E)(i,"click",t[20]),Object(c.E)(b,"click",t[21]),Object(c.E)(E,"click",t[23]),Object(c.E)(A,"click",t[24]),Object(c.E)(M,"input",t[25]),Object(c.E)(W,"change",t[14]("show-subs")),Object(c.E)(Z,"change",t[26]),Object(c.E)(D,"change",t[27])]},p(t,e){if((!dt||64&e[0]&&o!==(o="recent"===t[6]))&&(n.disabled=o),(!dt||64&e[0]&&u!==(u="settings"===t[6]))&&(i.disabled=u),(!dt||64&e[0]&&j!==(j="debug"===t[6]))&&(b.disabled=j),2564&e[0]){const n=t[2];Object(c.z)();for(let t=0;t<Ot.length;t+=1)Ot[t].r();Ot=Object(c.bb)(Ot,e,vt,1,t,n,gt,v,c.w,O,null,f);for(let t=0;t<Ot.length;t+=1)Ot[t].a();Object(c.j)()}if(64&e[0]&&Object(c.Y)(x,"tab-active","recent"===t[6]),2&e[0]&&Object(c.R)(M,t[1]),128&e[0]&&(Z.checked=t[7]),1&e[0]&&(D.checked=t[0]),64&e[0]&&Object(c.Y)(w,"tab-active","settings"===t[6]),(!dt||8&e[0])&&ht!==(ht=t[3].fileName+"")&&Object(c.Q)(rt,ht),(!dt||16&e[0])&&xt!==(xt=t[4]>0?"+":"")&&Object(c.Q)(it,xt),(!dt||16&e[0])&&mt!==(mt=(t[4]/1e3).toFixed(1)+"")&&Object(c.Q)(lt,mt),8&e[0]){let n;for($t=t[3].debugInfo(),n=0;n<$t.length;n+=1){const c=p(t,$t,n);wt[n]?wt[n].p(c,e):(wt[n]=g(c),wt[n].c(),wt[n].m(et,null))}for(;n<wt.length;n+=1)wt[n].d(1);wt.length=$t.length}64&e[0]&&Object(c.Y)(U,"tab-active","debug"===t[6])},i(t){if(!dt){for(let t=0;t<yt.length;t+=1)Object(c.Z)(Ot[t]);dt=!0}},o(t){for(let t=0;t<Ot.length;t+=1)Object(c.ab)(Ot[t]);dt=!1},d(t){t&&Object(c.t)(e),t&&Object(c.t)(h),t&&Object(c.t)(x);for(let t=0;t<Ot.length;t+=1)Ot[t].d();t&&Object(c.t)($),t&&Object(c.t)(w),t&&Object(c.t)(Q),t&&Object(c.t)(U),Object(c.s)(wt,t),Object(c.O)(jt)}}}function j(t){let e,n;return{c(){e=Object(c.u)("button"),e.textContent="Select Subtitles",Object(c.g)(e,"class","svelte-12u2uy7")},m(r,o){Object(c.C)(r,e,o),n=Object(c.E)(e,"click",t[18])},p:c.H,i:c.H,o:c.H,d(t){t&&Object(c.t)(e),n()}}}function O(t,e){let n,r,s,l,u,a,b,p,f,d,j,O=e[31].text+"",g=c.H;return{key:t,first:null,c(){n=Object(c.u)("li"),r=Object(c.u)("a"),s=Object(c.W)(O),u=Object(c.T)(),Object(c.g)(r,"target","_blank"),Object(c.g)(r,"href",l=`https://jisho.org/search/${encodeURIComponent(e[31].text.trim())}`),Object(c.g)(r,"rel","noopener noreferrer"),Object(c.g)(r,"class","svelte-12u2uy7"),Object(c.g)(n,"style",a=e[11](e[33])),Object(c.g)(n,"class","svelte-12u2uy7"),this.first=n},m(t,o){Object(c.C)(t,n,o),Object(c.e)(n,r),Object(c.e)(r,s),Object(c.e)(n,u),d=!0,j=Object(c.E)(r,"click",e[22])},p(t,e){(!d||4&e[0])&&O!==(O=t[31].text+"")&&Object(c.Q)(s,O),(!d||4&e[0]&&l!==(l=`https://jisho.org/search/${encodeURIComponent(t[31].text.trim())}`))&&Object(c.g)(r,"href",l),(!d||4&e[0]&&a!==(a=t[11](t[33])))&&Object(c.g)(n,"style",a)},r(){f=n.getBoundingClientRect()},f(){Object(c.x)(n),g(),Object(c.d)(n,f)},a(){g(),g=Object(c.m)(n,f,i,{duration:200})},i(t){d||(Object(c.c)(()=>{p&&p.end(1),b||(b=Object(c.p)(n,o.b,{y:-50,duration:200})),b.start()}),d=!0)},o(t){b&&b.invalidate(),p=Object(c.q)(n,o.b,{y:50,duration:200}),d=!1},d(t){t&&Object(c.t)(n),t&&p&&p.end(),j()}}}function g(t){let e,n,r,o,s=t[28].title+"",i=t[28].detail+"";return{c(){e=Object(c.u)("dt"),n=Object(c.W)(s),r=Object(c.u)("dd"),o=Object(c.W)(i),Object(c.g)(e,"class","svelte-12u2uy7"),Object(c.g)(r,"class","svelte-12u2uy7")},m(t,s){Object(c.C)(t,e,s),Object(c.e)(e,n),Object(c.C)(t,r,s),Object(c.e)(r,o)},p(t,e){8&e[0]&&s!==(s=t[28].title+"")&&Object(c.Q)(n,s),8&e[0]&&i!==(i=t[28].detail+"")&&Object(c.Q)(o,i)},d(t){t&&Object(c.t)(e),t&&Object(c.t)(r)}}}function h(t){let e,n,r,o,s,i,l;const u=[j,d],a=[];function b(t,e){return"cancelled"===t[5]?0:"normal"===t[5]?1:-1}return~(o=b(t))&&(s=a[o]=u[o](t)),{c(){e=Object(c.u)("div"),n=Object(c.u)("h1"),n.textContent="VRV Subtitler",r=Object(c.T)(),s&&s.c(),Object(c.g)(n,"class","svelte-12u2uy7"),Object(c.g)(e,"class","tray svelte-12u2uy7"),Object(c.S)(e,"right",t[8]+"rem")},m(s,u){Object(c.C)(s,e,u),Object(c.e)(e,n),Object(c.e)(e,r),~o&&a[o].m(e,null),i=!0,l=[Object(c.E)(e,"mouseenter",t[13](!0)),Object(c.E)(e,"mouseleave",t[13](!1))]},p(t,n){let r=o;o=b(t),o===r?~o&&a[o].p(t,n):(s&&(Object(c.z)(),Object(c.ab)(a[r],1,1,()=>{a[r]=null}),Object(c.j)()),~o?(s=a[o],s||(s=a[o]=u[o](t),s.c()),Object(c.Z)(s,1),s.m(e,null)):s=null),(!i||256&n[0])&&Object(c.S)(e,"right",t[8]+"rem")},i(t){i||(Object(c.Z)(s),i=!0)},o(t){Object(c.ab)(s),i=!1},d(t){t&&Object(c.t)(e),~o&&a[o].d(),Object(c.O)(l)}}}function x(t,e,n){let o;const i=Object(r.a)(),l={hidden:-26,shown:0},a=function(t,e={}){const n=u(t);let r,o=t;function i(i,l){if(null==t)return n.set(t=i),Promise.resolve();o=i;let u=r,a=!1,{delay:p=0,duration:f=400,easing:d=s.c,interpolate:j=b}=Object(c.f)(Object(c.f)({},e),l);const O=Object(c.I)()+p;let g;return r=Object(c.F)(e=>{if(e<O)return!0;a||(g=j(t,i),"function"==typeof f&&(f=f(t,i)),a=!0),u&&(u.abort(),u=null);const c=e-O;return c>f?(n.set(t=i),!1):(n.set(t=g(d(c/f))),!0)}),r.promise}return{set:i,update:(e,n)=>i(e(o,t),n),subscribe:n.subscribe}}(l.hidden,{duration:300,easing:s.b});Object(c.k)(t,a,t=>n(8,o=t));let{recentSubs:p=[]}=e,{subtitles:f={}}=e,{alignment:d=0}=e,{mode:j="normal"}=e,{invertVerticalAlignment:O=!0}=e,{subtitleFallbackColor:g}=e;let h="recent",x=!0;return t.$set=t=>{"recentSubs"in t&&n(2,p=t.recentSubs),"subtitles"in t&&n(3,f=t.subtitles),"alignment"in t&&n(4,d=t.alignment),"mode"in t&&n(5,j=t.mode),"invertVerticalAlignment"in t&&n(0,O=t.invertVerticalAlignment),"subtitleFallbackColor"in t&&n(1,g=t.subtitleFallbackColor)},[O,g,p,f,d,j,h,x,o,i,a,function(t){return`font-size: ${20*(.5+(t+1)/p.length*.5)}px`},function(){const t=new Blob([f.serialize()],{type:"application/json"});return URL.createObjectURL(t)},function(t){return()=>{a.set(t?l.shown:l.hidden),t&&!x||i("tray-pauser",t)}},function(t){return e=>{i(t,e.target.checked)}},l,!1,!0,()=>i("restart"),()=>n(6,h="recent"),()=>n(6,h="settings"),()=>n(6,h="debug"),()=>i("define-pauser"),()=>i("restart"),()=>i("realign"),function(){g=this.value,n(1,g)},function(){x=this.checked,n(7,x)},function(){O=this.checked,n(0,O)}]}class m extends c.a{constructor(t){var e;super(),document.getElementById("svelte-12u2uy7-style")||((e=Object(c.u)("style")).id="svelte-12u2uy7-style",e.textContent='.tray.svelte-12u2uy7.svelte-12u2uy7{width:28rem;margin-top:0.5rem;background:rgba(255, 255, 255, 0.2);position:fixed;right:0;top:0;color:white;height:calc(100% - 5rem);display:flex;flex-direction:column}.tray.svelte-12u2uy7>.svelte-12u2uy7{visibility:hidden}.tray.svelte-12u2uy7.svelte-12u2uy7:hover{background:#111218;overflow:auto;border-radius:3px}.tray.svelte-12u2uy7:hover>.svelte-12u2uy7{visibility:visible}.tray.svelte-12u2uy7 h1.svelte-12u2uy7{font-size:2rem;padding:0.5rem 0;border-radius:3px;margin:0}.tray.svelte-12u2uy7 h2.svelte-12u2uy7{text-decoration:underline;margin:0 0 0.4rem}ul.svelte-12u2uy7.svelte-12u2uy7{list-style:none;padding:0;display:flex;flex-direction:column-reverse}a.svelte-12u2uy7.svelte-12u2uy7{color:white;transform:scaleY(0);transform-origin:top;transition:transform 0.5s ease;text-decoration:none;font-family:"Source Han Sans", "源ノ角ゴシック", "Hiragino Sans", "HiraKakuProN-W3", "Hiragino Kaku Gothic ProN W3", "Hiragino Kaku Gothic ProN", "ヒラギノ角ゴ ProN W3", "Noto Sans", "Noto Sans CJK JP", "メイリオ", Meiryo, "游ゴシック", YuGothic, "ＭＳ Ｐゴシック", "MS PGothic", "ＭＳ ゴシック", "MS Gothic", sans-serif}a.svelte-12u2uy7.svelte-12u2uy7:hover{color:#0aff8c;cursor:pointer;text-decoration:underline}li.svelte-12u2uy7.svelte-12u2uy7{padding-bottom:0.2rem;white-space:pre}li.svelte-12u2uy7.svelte-12u2uy7:not(:first-of-type)::after{content:\' \';height:0;position:relative;border:1px solid #4a4a6a;display:block;margin:0 auto;border-radius:4px}dt.svelte-12u2uy7.svelte-12u2uy7{font-weight:bold}dd.svelte-12u2uy7.svelte-12u2uy7{font-style:italic}.tab.svelte-12u2uy7.svelte-12u2uy7{display:none;text-align:left;padding:2rem;background:#1c1825}.tab-active.svelte-12u2uy7.svelte-12u2uy7{display:block;flex:1}.tray-tab-buttons.svelte-12u2uy7.svelte-12u2uy7{margin:0.2rem;border-bottom:2px solid #f47521}.row.svelte-12u2uy7.svelte-12u2uy7:not(:last-child){margin-bottom:0.5rem}',Object(c.e)(document.head,e)),Object(c.B)(this,t,x,h,c.P,{recentSubs:2,subtitles:3,alignment:4,mode:5,invertVerticalAlignment:0,subtitleFallbackColor:1},[-1,-1])}}var y=m;function v(t,e,n){const c=t.slice();return c[13]=e[n],c}function $(t,e,n){const c=t.slice();return c[10]=e[n],c}function w(t){let e,n,r=t[0],o=[];for(let e=0;e<r.length;e+=1)o[e]=E($(t,r,e));const s=t=>Object(c.ab)(o[t],1,1,()=>{o[t]=null});return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=Object(c.v)()},m(t,r){for(let e=0;e<o.length;e+=1)o[e].m(t,r);Object(c.C)(t,e,r),n=!0},p(t,n){if(13&n){let i;for(r=t[0],i=0;i<r.length;i+=1){const s=$(t,r,i);o[i]?(o[i].p(s,n),Object(c.Z)(o[i],1)):(o[i]=E(s),o[i].c(),Object(c.Z)(o[i],1),o[i].m(e.parentNode,e))}for(Object(c.z)(),i=r.length;i<o.length;i+=1)s(i);Object(c.j)()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)Object(c.Z)(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)Object(c.ab)(o[t]);n=!1},d(t){Object(c.s)(o,t),t&&Object(c.t)(e)}}}function k(t){let e,n=t[10].text+"";return{c(){e=Object(c.W)(n)},m(t,n){Object(c.C)(t,e,n)},p(t,r){1&r&&n!==(n=t[10].text+"")&&Object(c.Q)(e,n)},i:c.H,o:c.H,d(t){t&&Object(c.t)(e)}}}function S(t){let e,n,r=t[10].phrases,o=[];for(let e=0;e<r.length;e+=1)o[e]=C(v(t,r,e));const s=t=>Object(c.ab)(o[t],1,1,()=>{o[t]=null});return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=Object(c.v)()},m(t,r){for(let e=0;e<o.length;e+=1)o[e].m(t,r);Object(c.C)(t,e,r),n=!0},p(t,n){if(1&n){let i;for(r=t[10].phrases,i=0;i<r.length;i+=1){const s=v(t,r,i);o[i]?(o[i].p(s,n),Object(c.Z)(o[i],1)):(o[i]=C(s),o[i].c(),Object(c.Z)(o[i],1),o[i].m(e.parentNode,e))}for(Object(c.z)(),i=r.length;i<o.length;i+=1)s(i);Object(c.j)()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)Object(c.Z)(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)Object(c.ab)(o[t]);n=!1},d(t){Object(c.s)(o,t),t&&Object(c.t)(e)}}}function C(t){let e,n,r,s,i,l,u=t[13].text+"";return{c(){e=Object(c.u)("span"),n=Object(c.W)(u),Object(c.g)(e,"style",r=H(t[13]))},m(t,r){Object(c.C)(t,e,r),Object(c.e)(e,n),l=!0},p(t,o){(!l||1&o)&&u!==(u=t[13].text+"")&&Object(c.Q)(n,u),(!l||1&o&&r!==(r=H(t[13])))&&Object(c.g)(e,"style",r)},i(n){l||(Object(c.c)(()=>{i&&i.end(1),s||(s=Object(c.p)(e,o.a,{duration:t[13].fadeIn||0})),s.start()}),l=!0)},o(n){s&&s.invalidate(),i=Object(c.q)(e,o.a,{duration:t[13].fadeOut||0}),l=!1},d(t){t&&Object(c.t)(e),t&&i&&i.end()}}}function E(t){let e,n,r,o,s,i,l,u;const a=[S,k],b=[];function p(t,e){return t[10].phrases?0:1}function f(...e){return t[9](t[10],...e)}return n=p(t),r=b[n]=a[n](t),{c(){e=Object(c.u)("p"),r.c(),o=Object(c.T)(),Object(c.g)(e,"style",s=t[3](t[10])),Object(c.g)(e,"data-sub-style",i=t[10].style),Object(c.g)(e,"title","click to search this phrase on Jisho.org"),Object(c.g)(e,"class","svelte-ko7cxi")},m(t,r){Object(c.C)(t,e,r),b[n].m(e,null),Object(c.e)(e,o),l=!0,u=Object(c.E)(e,"click",f)},p(u,f){let d=n;n=p(t=u),n===d?b[n].p(t,f):(Object(c.z)(),Object(c.ab)(b[d],1,1,()=>{b[d]=null}),Object(c.j)(),r=b[n],r||(r=b[n]=a[n](t),r.c()),Object(c.Z)(r,1),r.m(e,o)),(!l||1&f&&s!==(s=t[3](t[10])))&&Object(c.g)(e,"style",s),(!l||1&f&&i!==(i=t[10].style))&&Object(c.g)(e,"data-sub-style",i)},i(t){l||(Object(c.Z)(r),l=!0)},o(t){Object(c.ab)(r),l=!1},d(t){t&&Object(c.t)(e),b[n].d(),u()}}}function T(t){let e,n,r=t[1]&&w(t);return{c(){e=Object(c.u)("div"),r&&r.c(),Object(c.g)(e,"class","subtitles")},m(t,o){Object(c.C)(t,e,o),r&&r.m(e,null),n=!0},p(t,[n]){t[1]?r?(r.p(t,n),Object(c.Z)(r,1)):(r=w(t),r.c(),Object(c.Z)(r,1),r.m(e,null)):r&&(Object(c.z)(),Object(c.ab)(r,1,1,()=>{r=null}),Object(c.j)())},i(t){n||(Object(c.Z)(r),n=!0)},o(t){Object(c.ab)(r),n=!1},d(t){t&&Object(c.t)(e),r&&r.d()}}}function A(t){return t.fontScaled?`font-size: ${window.innerHeight>t.fontScalingThreshold?t.fontMax:t.fontScaled}`:""}function P(t){return t.filter(t=>!!t).join(";")}function H(t){return P([t.inline,A(t)])}function F(t,e,n){let{current:c=[]}=e,{styles:o={}}=e,{format:s=""}=e,{visible:i=!0}=e,{verticalAlignment:l="inverted"}=e,{subtitleFallbackColor:u}=e;const a=Object(r.a)();function b(t){a("define-pauser"),window.open(`https://jisho.org/search/${encodeURIComponent(t.trim())}`)}return t.$set=t=>{"current"in t&&n(0,c=t.current),"styles"in t&&n(4,o=t.styles),"format"in t&&n(5,s=t.format),"visible"in t&&n(1,i=t.visible),"verticalAlignment"in t&&n(6,l=t.verticalAlignment),"subtitleFallbackColor"in t&&n(7,u=t.subtitleFallbackColor)},[c,i,b,function(t){let e=[`color: ${u}`];return"ass"===s&&t.style in o&&(e.push(o[t.style].inline),e.push(A(o[t.style]))),t.verticalAlignment&&e.push(t.verticalAlignment[l]),e=e.concat([t.inline||"",A(t)]),P(e)},o,s,l,u,a,t=>b(t.text)]}class N extends c.a{constructor(t){var e;super(),document.getElementById("svelte-ko7cxi-style")||((e=Object(c.u)("style")).id="svelte-ko7cxi-style",e.textContent='p.svelte-ko7cxi{cursor:pointer;color:white;margin:0;padding:0;white-space:pre;font-family:"Source Han Sans", "源ノ角ゴシック", "Hiragino Sans", "HiraKakuProN-W3", "Hiragino Kaku Gothic ProN W3", "Hiragino Kaku Gothic ProN", "ヒラギノ角ゴ ProN W3", "Noto Sans", "Noto Sans CJK JP", "メイリオ", Meiryo, "游ゴシック", YuGothic, "ＭＳ Ｐゴシック", "MS PGothic", "ＭＳ ゴシック", "MS Gothic", sans-serif}p.svelte-ko7cxi:hover{color:#0aff8c !important}',Object(c.e)(document.head,e)),Object(c.B)(this,t,F,T,c.P,{current:0,styles:4,format:5,visible:1,verticalAlignment:6,subtitleFallbackColor:7})}}var M=N;class R{constructor(){this.video=null,this.reasons=[]}setVideo(t){this.reasons=[],this.video=t}addPauser(t){this.reasons.includes("user-paused")&&!this.video.paused&&this.reasons.splice(this.reasons.indexOf("user-paused")),0===this.reasons.length&&this.video.paused&&this.reasons.push("user-paused"),this.reasons.push(t),this._checkPause()}removePauser(t){const e=this.reasons.indexOf(t);-1!==e&&(this.reasons.splice(e,1),this._checkPause())}_checkPause(){this.reasons.length?this.video.pause():this.video.play()}}var _=n(8),W=n.n(_),I=n(7),z=n.n(I);const B={"line-left":"0%",center:"-50%","line-right":"-100%"};class G extends z.a{constructor(t,e){super("srt",e);const n=t.replace(/\r/g,"").split("\n\n");this.subs=n.reduce((t,e)=>{let n=e.trim().split("\n");function c(){n.shift()}try{/^\d*$/.test(n[0])&&c();let[e,r]=n[0].replace(/,/g,".").match(/^([\d:\.\-> ]*)/)[0].split(/\-\->/),o=n[0].match(/([a-zA-Z].*)/);o=o&&o.length?o[1]:"";let s=[],i=[];const l=n.length-1,u=(t,e)=>{const n=o.match(new RegExp(`${t}:([\\d\\.]*)%`));return n?parseInt(n[1],10):e},a=t=>{const e=o.match(new RegExp(`${t}:([w-]*?)`));if(e)return e[1]},b=()=>{const t=o.match(/position:([\d.]*)%(?:,(\w*))?/);return t?{position:parseInt(t[1]),positionAlignment:"middle"===t[2]?"center":t[2]}:{position:50,positionAlignment:"center"}},p=5;let{position:f,positionAlignment:d}=b(),j=(a("align"),u("line",90-l*p)),O=u("size",100);i.push(`position: fixed; left: ${f}vw`),d&&d in B&&s.push(`transform: translateX(${B[d]})`),s.push(`display:block; width: ${O}vw`),c();const g=n.join("\n").replace(/<\/?c.Japanese>/g,"");s.push(`font-size: ${p}vh`),s.push("text-shadow: -4px -4px 0px rgba(9, 9, 9, 255), -4px -3px 0px rgba(9, 9, 9, 255), -4px -2px 0px rgba(9, 9, 9, 255), -4px -1px 0px rgba(9, 9, 9, 255), -4px 0px 0px rgba(9, 9, 9, 255), -4px 1px 0px rgba(9, 9, 9, 255), -4px 2px 0px rgba(9, 9, 9, 255), -4px 3px 0px rgba(9, 9, 9, 255), -4px 4px 0px rgba(9, 9, 9, 255), -3px -4px 0px rgba(9, 9, 9, 255), -3px -3px 0px rgba(9, 9, 9, 255), -3px -2px 0px rgba(9, 9, 9, 255), -3px -1px 0px rgba(9, 9, 9, 255), -3px 0px 0px rgba(9, 9, 9, 255), -3px 1px 0px rgba(9, 9, 9, 255), -3px 2px 0px rgba(9, 9, 9, 255), -3px 3px 0px rgba(9, 9, 9, 255), -3px 4px 0px rgba(9, 9, 9, 255), -2px -4px 0px rgba(9, 9, 9, 255), -2px -3px 0px rgba(9, 9, 9, 255), -2px -2px 0px rgba(9, 9, 9, 255), -2px -1px 0px rgba(9, 9, 9, 255), -2px 0px 0px rgba(9, 9, 9, 255), -2px 1px 0px rgba(9, 9, 9, 255), -2px 2px 0px rgba(9, 9, 9, 255), -2px 3px 0px rgba(9, 9, 9, 255), -2px 4px 0px rgba(9, 9, 9, 255), -1px -4px 0px rgba(9, 9, 9, 255), -1px -3px 0px rgba(9, 9, 9, 255), -1px -2px 0px rgba(9, 9, 9, 255), -1px -1px 0px rgba(9, 9, 9, 255), -1px 0px 0px rgba(9, 9, 9, 255), -1px 1px 0px rgba(9, 9, 9, 255), -1px 2px 0px rgba(9, 9, 9, 255), -1px 3px 0px rgba(9, 9, 9, 255), -1px 4px 0px rgba(9, 9, 9, 255), 0px -4px 0px rgba(9, 9, 9, 255), 0px -3px 0px rgba(9, 9, 9, 255), 0px -2px 0px rgba(9, 9, 9, 255), 0px -1px 0px rgba(9, 9, 9, 255), 0px 0px 0px rgba(9, 9, 9, 255), 0px 1px 0px rgba(9, 9, 9, 255), 0px 2px 0px rgba(9, 9, 9, 255), 0px 3px 0px rgba(9, 9, 9, 255), 0px 4px 0px rgba(9, 9, 9, 255), 1px -4px 0px rgba(9, 9, 9, 255), 1px -3px 0px rgba(9, 9, 9, 255), 1px -2px 0px rgba(9, 9, 9, 255), 1px -1px 0px rgba(9, 9, 9, 255), 1px 0px 0px rgba(9, 9, 9, 255), 1px 1px 0px rgba(9, 9, 9, 255), 1px 2px 0px rgba(9, 9, 9, 255), 1px 3px 0px rgba(9, 9, 9, 255), 1px 4px 0px rgba(9, 9, 9, 255), 2px -4px 0px rgba(9, 9, 9, 255), 2px -3px 0px rgba(9, 9, 9, 255), 2px -2px 0px rgba(9, 9, 9, 255), 2px -1px 0px rgba(9, 9, 9, 255), 2px 0px 0px rgba(9, 9, 9, 255), 2px 1px 0px rgba(9, 9, 9, 255), 2px 2px 0px rgba(9, 9, 9, 255), 2px 3px 0px rgba(9, 9, 9, 255), 2px 4px 0px rgba(9, 9, 9, 255), 3px -4px 0px rgba(9, 9, 9, 255), 3px -3px 0px rgba(9, 9, 9, 255), 3px -2px 0px rgba(9, 9, 9, 255), 3px -1px 0px rgba(9, 9, 9, 255), 3px 0px 0px rgba(9, 9, 9, 255), 3px 1px 0px rgba(9, 9, 9, 255), 3px 2px 0px rgba(9, 9, 9, 255), 3px 3px 0px rgba(9, 9, 9, 255), 3px 4px 0px rgba(9, 9, 9, 255), 4px -4px 0px rgba(9, 9, 9, 255), 4px -3px 0px rgba(9, 9, 9, 255), 4px -2px 0px rgba(9, 9, 9, 255), 4px -1px 0px rgba(9, 9, 9, 255), 4px 0px 0px rgba(9, 9, 9, 255), 4px 1px 0px rgba(9, 9, 9, 255), 4px 2px 0px rgba(9, 9, 9, 255), 4px 3px 0px rgba(9, 9, 9, 255), 4px 4px 0px rgba(9, 9, 9, 255), 2px 2px 0px rgba(20, 20, 20, 195)"),t.push({start:this.timeToMs(e),end:this.timeToMs(r),verticalAlignment:{normal:`position: fixed; top: ${j}vh;`,inverted:`position: fixed; top: ${100-j}vh; transform: translateY(-100%)`},text:g,inline:i.join("; "),phrases:[{text:g,inline:s.join("; ")}]})}catch(t){}return t},[])}serialize(){return JSON.stringify(this.subs,null,4)}debugInfo(){return[{title:"Number of subtitles",detail:this.subs.length}]}}function Z(t){let e,n,r,o,s,i,l;return{c(){e=Object(c.u)("div"),n=Object(c.u)("button"),n.textContent="⨯ Skip Subtitling For This Episode",r=Object(c.T)(),o=Object(c.u)("label"),o.textContent="≡ Select a subtitle file to begin",s=Object(c.T)(),i=Object(c.u)("input"),Object(c.g)(n,"class","small-button svelte-1n5tabm"),Object(c.g)(o,"for","srt-upload"),Object(c.g)(o,"class","svelte-1n5tabm"),Object(c.g)(i,"type","file"),Object(c.g)(i,"id","srt-upload"),Object(c.g)(i,"accept",".srt,.ass,.ssa,.vtt"),Object(c.g)(i,"class","svelte-1n5tabm"),Object(c.g)(e,"class","column svelte-1n5tabm")},m(u,a){Object(c.C)(u,e,a),Object(c.e)(e,n),Object(c.e)(e,r),Object(c.e)(e,o),Object(c.e)(e,s),Object(c.e)(e,i),l=[Object(c.E)(n,"click",t[1]),Object(c.E)(i,"change",t[0])]},p:c.H,i:c.H,o:c.H,d(t){t&&Object(c.t)(e),Object(c.O)(l)}}}function V(t){const e=Object(r.a)();return[function(t){const n=t.target.files[0],c=new FileReader;c.onload=t=>{const c={ass:W.a,ssa:W.a,srt:G,vtt:G},[r,o]=n.name.match(/\.(\w{3})$/);e("subtitles-loaded",new c[o](t.target.result,n.name))},c.readAsText(n)},function(){e("cancel")}]}class Y extends c.a{constructor(t){var e;super(),document.getElementById("svelte-1n5tabm-style")||((e=Object(c.u)("style")).id="svelte-1n5tabm-style",e.textContent=".column.svelte-1n5tabm.svelte-1n5tabm{display:flex;flex-direction:column}.column.svelte-1n5tabm>.svelte-1n5tabm{align-self:center;margin:0.5rem}label.svelte-1n5tabm.svelte-1n5tabm{background:#fd0;border:none;cursor:pointer;padding:10px;line-height:1;font-weight:bold;color:black;text-transform:uppercase;display:inline-block;font-size:1.2rem}label.svelte-1n5tabm.svelte-1n5tabm:hover{background:#ffea6d}input.svelte-1n5tabm.svelte-1n5tabm{display:none}",Object(c.e)(document.head,e)),Object(c.B)(this,t,V,Z,c.P,{})}}var q=Y;const{document:K}=c.y;function D(t){let e,n,r,o,s,i,l,u,a,b,p,f,d,j,O,g,h="number"==typeof t[3]&&!isNaN(t[3]),x=t[0].text+"",m=h&&function(t){let e,n,r,o,s,i,l,u=t[4]()+"";return{c(){e=Object(c.u)("button"),n=Object(c.W)("Use the last alignment for "),r=Object(c.u)("span"),r.textContent=`${t[2]}`,o=Object(c.W)(" ("),s=Object(c.W)(u),i=Object(c.W)(")"),Object(c.g)(r,"class","show-name svelte-n31nxo"),Object(c.g)(e,"class","svelte-n31nxo")},m(u,a){Object(c.C)(u,e,a),Object(c.e)(e,n),Object(c.e)(e,r),Object(c.e)(e,o),Object(c.e)(e,s),Object(c.e)(e,i),l=Object(c.E)(e,"click",t[5])},p:c.H,d(t){t&&Object(c.t)(e),l()}}}(t);return{c(){e=Object(c.u)("div"),n=Object(c.u)("button"),n.textContent="↺ Reselect Subtitles",r=Object(c.T)(),o=Object(c.u)("div"),m&&m.c(),s=Object(c.T)(),i=Object(c.u)("button"),i.innerHTML="No alignment adjustment<br>(use when you know the subtitles are timed properly)",l=Object(c.T)(),u=Object(c.u)("button"),u.textContent="Enter alignment manually",a=Object(c.T)(),b=Object(c.u)("button"),p=Object(c.W)("⇌ Click when the first line is said:\n\t\t"),f=Object(c.u)("br"),d=Object(c.T)(),j=Object(c.u)("pre"),O=Object(c.W)(x),Object(c.g)(n,"class","small-button svelte-n31nxo"),Object(c.g)(i,"class","svelte-n31nxo"),Object(c.g)(u,"class","svelte-n31nxo"),Object(c.g)(o,"class","row svelte-n31nxo"),Object(c.g)(b,"class","svelte-n31nxo"),Object(c.g)(e,"class","alignment-buttons svelte-n31nxo")},m(h,x){Object(c.C)(h,e,x),Object(c.e)(e,n),Object(c.e)(e,r),Object(c.e)(e,o),m&&m.m(o,null),Object(c.e)(o,s),Object(c.e)(o,i),Object(c.e)(o,l),Object(c.e)(o,u),Object(c.e)(e,a),Object(c.e)(e,b),Object(c.e)(b,p),Object(c.e)(b,f),Object(c.e)(b,d),Object(c.e)(b,j),Object(c.e)(j,O),g=[Object(c.E)(n,"click",t[11]),Object(c.E)(i,"click",t[12]),Object(c.E)(u,"click",t[6]),Object(c.E)(b,"click",t[7])]},p(t,[e]){h&&m.p(t,e),1&e&&x!==(x=t[0].text+"")&&Object(c.Q)(O,x)},i:c.H,o:c.H,d(t){t&&Object(c.t)(e),m&&m.d(),Object(c.O)(g)}}}function J(t,e,n){let{firstSubtitle:c={}}=e;const o=Object(r.a)(),s=document.querySelector(".video-title"),i=s?s.textContent:"",l=`last-used-alignment-${i}`,u=parseInt(GM_getValue(l),10),a=(u/1e3).toFixed(1);function b(t){const e=document.querySelector("video"),n="number"==typeof t?t:1e3*e.currentTime-c.start-400;GM_setValue(l,n),o("set-align",n)}return t.$set=t=>{"firstSubtitle"in t&&n(0,c=t.firstSubtitle)},[c,o,i,u,function(){return 0===u?"no adjustment":u>0?`subtitles delayed by ${a} seconds`:`subtitles hastened by ${Math.abs(a)} seconds`},function(){b(u)},function(){const t=parseFloat(prompt("Enter an alignment in seconds. Positive numbers are for when the subtitles need to be delayed (subtitle file starts too soon). \nNegative numbers will play the subtitles earlier (subtitle file is too late).",a||""));isNaN(t)||b(1e3*t)},b,s,l,a,()=>o("reselect"),()=>b(0)]}class L extends c.a{constructor(t){var e;super(),K.getElementById("svelte-n31nxo-style")||((e=Object(c.u)("style")).id="svelte-n31nxo-style",e.textContent=".alignment-buttons.svelte-n31nxo.svelte-n31nxo{display:flex;flex-direction:column}.alignment-buttons.svelte-n31nxo button.svelte-n31nxo{margin:0.5rem;align-self:center}.row.svelte-n31nxo.svelte-n31nxo{display:flex;flex-direction:row;justify-content:center}.row.svelte-n31nxo button.svelte-n31nxo{max-width:15rem}.show-name.svelte-n31nxo.svelte-n31nxo{font-style:italic}",Object(c.e)(K.head,e)),Object(c.B)(this,t,J,D,c.P,{firstSubtitle:0})}}var Q=L;const{document:U}=c.y;function X(t){let e;const n=new y({props:{mode:"cancelled"}});return n.$on("restart",t[9]),{c(){Object(c.o)(n.$$.fragment)},m(t,r){Object(c.G)(n,t,r),e=!0},p:c.H,i(t){e||(Object(c.Z)(n.$$.fragment,t),e=!0)},o(t){Object(c.ab)(n.$$.fragment,t),e=!1},d(t){Object(c.r)(n,t)}}}function tt(t){let e,n,r,o,s;function i(e){t[21].call(null,e)}let l={format:t[2].format,styles:t[2].styles,current:t[1],currentTime:t[8],visible:t[5],verticalAlignment:t[7]?"inverted":"normal"};void 0!==t[6]&&(l.subtitleFallbackColor=t[6]);const u=new M({props:l});function a(e){t[22].call(null,e)}function b(e){t[23].call(null,e)}c.i.push(()=>Object(c.h)(u,"subtitleFallbackColor",i)),u.$on("define-pauser",t[13]);let p={recentSubs:t[4],subtitles:t[2],alignment:t[3]};void 0!==t[7]&&(p.invertVerticalAlignment=t[7]),void 0!==t[6]&&(p.subtitleFallbackColor=t[6]);const f=new y({props:p});return c.i.push(()=>Object(c.h)(f,"invertVerticalAlignment",a)),c.i.push(()=>Object(c.h)(f,"subtitleFallbackColor",b)),f.$on("restart",t[9]),f.$on("tray-pauser",t[12]),f.$on("define-pauser",t[13]),f.$on("realign",t[24]),f.$on("show-subs",t[25]),{c(){Object(c.o)(u.$$.fragment),n=Object(c.T)(),Object(c.o)(f.$$.fragment)},m(t,e){Object(c.G)(u,t,e),Object(c.C)(t,n,e),Object(c.G)(f,t,e),s=!0},p(t,n){const s={};4&n&&(s.format=t[2].format),4&n&&(s.styles=t[2].styles),2&n&&(s.current=t[1]),32&n&&(s.visible=t[5]),128&n&&(s.verticalAlignment=t[7]?"inverted":"normal"),!e&&64&n&&(e=!0,s.subtitleFallbackColor=t[6],Object(c.b)(()=>e=!1)),u.$set(s);const i={};16&n&&(i.recentSubs=t[4]),4&n&&(i.subtitles=t[2]),8&n&&(i.alignment=t[3]),!r&&128&n&&(r=!0,i.invertVerticalAlignment=t[7],Object(c.b)(()=>r=!1)),!o&&64&n&&(o=!0,i.subtitleFallbackColor=t[6],Object(c.b)(()=>o=!1)),f.$set(i)},i(t){s||(Object(c.Z)(u.$$.fragment,t),Object(c.Z)(f.$$.fragment,t),s=!0)},o(t){Object(c.ab)(u.$$.fragment,t),Object(c.ab)(f.$$.fragment,t),s=!1},d(t){Object(c.r)(u,t),t&&Object(c.t)(n),Object(c.r)(f,t)}}}function et(t){let e;const n=new Q({props:{firstSubtitle:t[2].firstSubtitle()}});return n.$on("set-align",t[10]),n.$on("reselect",t[20]),{c(){Object(c.o)(n.$$.fragment)},m(t,r){Object(c.G)(n,t,r),e=!0},p(t,e){const c={};4&e&&(c.firstSubtitle=t[2].firstSubtitle()),n.$set(c)},i(t){e||(Object(c.Z)(n.$$.fragment,t),e=!0)},o(t){Object(c.ab)(n.$$.fragment,t),e=!1},d(t){Object(c.r)(n,t)}}}function nt(t){let e;const n=new q({});return n.$on("subtitles-loaded",t[11]),n.$on("cancel",t[19]),{c(){Object(c.o)(n.$$.fragment)},m(t,r){Object(c.G)(n,t,r),e=!0},p:c.H,i(t){e||(Object(c.Z)(n.$$.fragment,t),e=!0)},o(t){Object(c.ab)(n.$$.fragment,t),e=!1},d(t){Object(c.r)(n,t)}}}function ct(t){let e,n,r,o;const s=[nt,et,tt,X],i=[];function l(t,e){return"prompt"===t[0]?0:"align"===t[0]?1:"play"===t[0]?2:"cancelled"===t[0]?3:-1}return~(n=l(t))&&(r=i[n]=s[n](t)),{c(){e=Object(c.u)("div"),r&&r.c(),Object(c.g)(e,"class","subtitles-app svelte-1noo31a")},m(t,r){Object(c.C)(t,e,r),~n&&i[n].m(e,null),o=!0},p(t,[o]){let u=n;n=l(t),n===u?~n&&i[n].p(t,o):(r&&(Object(c.z)(),Object(c.ab)(i[u],1,1,()=>{i[u]=null}),Object(c.j)()),~n?(r=i[n],r||(r=i[n]=s[n](t),r.c()),Object(c.Z)(r,1),r.m(e,null)):r=null)},i(t){o||(Object(c.Z)(r),o=!0)},o(t){Object(c.ab)(r),o=!1},d(t){t&&Object(c.t)(e),~n&&i[n].d()}}}function rt(t,e,n){const c=new R;let o,s="prompt",i=[],l=null,u=null,a=-1,b=[],p=!0,f="#FFFFFF";function d(){n(0,s="prompt"),n(2,l=null),n(1,i=[])}function j(t){let e=t[t.length-1],c=b[b.length-1];!e||c&&e.text===c.text||n(4,b=[...b,e]),b.length>10&&n(4,b=b.slice(b.length-10))}function O(){"play"===s&&(n(1,i=l.getSubs(1e3*u.currentTime-a)),j(i),requestAnimationFrame(O))}Object(r.c)(()=>{document.addEventListener("visibilitychange",()=>{document.hidden||c.removePauser("define")});let t="";setInterval(()=>{const e=document.querySelector("video").getAttribute("src");e&&e!==t&&(t=e,d())},50)});return[s,i,l,a,b,p,f,o,"",d,function(t){u=document.querySelector("video"),c.setVideo(u),n(3,a=t.detail),n(4,b=[]),n(0,s="play"),O()},function(t){n(2,l=t.detail),0===l.subs.length?(console.log("subtitles object failed to parse: ",l),alert(`No subtitles were parsed from the selected .${l.format} file, verify nothing is wrong with the file. If it appears normal please submit a bug report with the episode and the subtitles file you used to the issue tracker!`)):n(0,s="align")},function(t){t.detail?c.addPauser("tray"):c.removePauser("tray")},function(){c.addPauser("define")},u,"last-used-alignment",c,j,O,()=>n(0,s="cancelled"),()=>n(0,s="prompt"),function(t){f=t,n(6,f)},function(t){o=t,n(7,o)},function(t){f=t,n(6,f)},()=>n(0,s="align"),t=>n(5,p=t.detail)]}class ot extends c.a{constructor(t){var e;super(),U.getElementById("svelte-1noo31a-style")||((e=Object(c.u)("style")).id="svelte-1noo31a-style",e.textContent=".subtitles-app.svelte-1noo31a{position:relative}.subtitles-app.svelte-1noo31a>*{z-index:1000000000}.subtitles-app.svelte-1noo31a button{background:#fd0;border:none;padding:10px;line-height:1;font-weight:bold;color:black;text-transform:uppercase;font-size:0.9rem}.subtitles-app.svelte-1noo31a .small-button{font-size:0.6rem}.subtitles-app.svelte-1noo31a button:disabled{background:#2a3450}.subtitles-app.svelte-1noo31a button:not(:disabled):hover{background:#ffea6d;cursor:pointer}",Object(c.e)(U.head,e)),Object(c.B)(this,t,rt,ct,c.P,{})}}var st=ot;const it=document.createElement("div");document.body.appendChild(it),it.id="sheodox-vrv-subtitler",it.style.height="100%",it.style.width="100%";new st({target:it})}]);
