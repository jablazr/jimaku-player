// ==UserScript==
// @name         字幕プレーヤー
// @namespace    https://github.com/sheodox
// @version      0.3.0
// @description  Study Japanese by using Japanese subtitles on VRV!
// @author       sheodox
// @match        https://static.vrv.co/vilos/player.html*
// @match        https://static.crunchyroll.com/vilos-v2/web/vilos/player.html*
// @grant        GM_getValue
// @grant        GM_setValue
// ==/UserScript==

!function(t){var e={};function n(c){if(e[c])return e[c].exports;var s=e[c]={i:c,l:!1,exports:{}};return t[c].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,c){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:c})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var c=Object.create(null);if(n.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(c,s,function(e){return t[e]}.bind(null,s));return c},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=34)}([function(t,e,n){"use strict";function c(){}n.d(e,"a",(function(){return K})),n.d(e,"b",(function(){return Dt})),n.d(e,"c",(function(){return v})),n.d(e,"d",(function(){return ht})),n.d(e,"e",(function(){return pt})),n.d(e,"f",(function(){return nt})),n.d(e,"g",(function(){return S})),n.d(e,"h",(function(){return r})),n.d(e,"i",(function(){return H})),n.d(e,"j",(function(){return Bt})),n.d(e,"k",(function(){return bt})),n.d(e,"l",(function(){return lt})),n.d(e,"m",(function(){return Ct})),n.d(e,"n",(function(){return j})),n.d(e,"o",(function(){return g})),n.d(e,"p",(function(){return ot})),n.d(e,"q",(function(){return tt})),n.d(e,"r",(function(){return Lt})),n.d(e,"s",(function(){return Gt})),n.d(e,"t",(function(){return Nt})),n.d(e,"u",(function(){return Pt})),n.d(e,"v",(function(){return O})),n.d(e,"w",(function(){return Et})),n.d(e,"x",(function(){return Ft})),n.d(e,"y",(function(){return _})),n.d(e,"z",(function(){return z})),n.d(e,"A",(function(){return J})),n.d(e,"B",(function(){return M})),n.d(e,"C",(function(){return It})),n.d(e,"D",(function(){return et})),n.d(e,"E",(function(){return f})),n.d(e,"F",(function(){return Mt})),n.d(e,"G",(function(){return St})),n.d(e,"H",(function(){return s})),n.d(e,"I",(function(){return Wt})),n.d(e,"J",(function(){return C})),n.d(e,"K",(function(){return a})),n.d(e,"L",(function(){return E})),n.d(e,"M",(function(){return A})),n.d(e,"N",(function(){return Rt})),n.d(e,"O",(function(){return c})),n.d(e,"P",(function(){return y})),n.d(e,"Q",(function(){return m})),n.d(e,"R",(function(){return it})),n.d(e,"S",(function(){return rt})),n.d(e,"T",(function(){return Tt})),n.d(e,"U",(function(){return T})),n.d(e,"V",(function(){return k})),n.d(e,"W",(function(){return l})),n.d(e,"X",(function(){return b})),n.d(e,"Y",(function(){return F})),n.d(e,"Z",(function(){return W})),n.d(e,"ab",(function(){return B})),n.d(e,"bb",(function(){return G})),n.d(e,"cb",(function(){return R})),n.d(e,"db",(function(){return L})),n.d(e,"eb",(function(){return I})),n.d(e,"fb",(function(){return d})),n.d(e,"gb",(function(){return N})),n.d(e,"hb",(function(){return P})),n.d(e,"ib",(function(){return D})),n.d(e,"jb",(function(){return zt})),n.d(e,"kb",(function(){return _t})),n.d(e,"lb",(function(){return Ht})),n.d(e,"mb",(function(){return h})),n.d(e,"nb",(function(){return q}));const s=t=>t;function r(t,e){for(const n in e)t[n]=e[n];return t}function i(t){return t()}function o(){return Object.create(null)}function l(t){t.forEach(i)}function a(t){return"function"==typeof t}function b(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function u(t){return 0===Object.keys(t).length}function d(t,...e){if(null==t)return c;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function f(t){let e;return d(t,t=>e=t)(),e}function j(t,e,n){t.$$.on_destroy.push(d(e,n))}function O(t,e,n,c){if(t){const s=p(t,e,n,c);return t[0](s)}}function p(t,e,n,c){return t[1]&&c?r(n.ctx.slice(),t[1](c(e))):n.ctx}function h(t,e,n,c,s,r,i){const o=function(t,e,n,c){if(t[2]&&c){const s=t[2](c(n));if(void 0===e.dirty)return s;if("object"==typeof s){const t=[],n=Math.max(e.dirty.length,s.length);for(let c=0;c<n;c+=1)t[c]=e.dirty[c]|s[c];return t}return e.dirty|s}return e.dirty}(e,c,s,r);if(o){const s=p(e,n,c,i);t.p(s,o)}}function g(t){const e={};for(const n in t)e[n]=!0;return e}function m(t){return null==t?"":t}function v(t){return t&&a(t.destroy)?t.destroy:c}const x="undefined"!=typeof window;let y=x?()=>window.performance.now():()=>Date.now(),k=x?t=>requestAnimationFrame(t):c;const w=new Set;function $(t){w.forEach(e=>{e.c(t)||(w.delete(e),e.f())}),0!==w.size&&k($)}function A(t){let e;return 0===w.size&&k($),{promise:new Promise(n=>{w.add(e={c:t,f:n})}),abort(){w.delete(e)}}}function S(t,e){t.appendChild(e)}function C(t,e,n){t.insertBefore(e,n||null)}function z(t){t.parentNode.removeChild(t)}function _(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function J(t){return document.createElement(t)}function N(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function P(t){return document.createTextNode(t)}function L(){return P(" ")}function M(){return P("")}function E(t,e,n,c){return t.addEventListener(e,n,c),()=>t.removeEventListener(e,n,c)}function T(t){return function(e){return e.preventDefault(),t.call(this,e)}}function I(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function H(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function q(t,e,n){t.setAttributeNS("http://www.w3.org/1999/xlink",e,n)}function B(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function G(t,e){t.value=null==e?"":e}function R(t,e,n,c){t.style.setProperty(e,n,c?"important":"")}function F(t,e){for(let n=0;n<t.options.length;n+=1){const c=t.options[n];if(c.__value===e)return void(c.selected=!0)}}function W(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function D(t,e,n){t.classList[n?"add":"remove"](e)}function V(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}class K{constructor(t=null){this.a=t,this.e=this.n=null}m(t,e,n=null){this.e||(this.e=J(e.nodeName),this.t=e,this.h(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)C(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(z)}}const X=new Set;let Y,U=0;function Z(t,e,n,c,s,r,i,o=0){const l=16.666/c;let a="{\n";for(let t=0;t<=1;t+=l){const c=e+(n-e)*r(t);a+=100*t+`%{${i(c,1-c)}}\n`}const b=a+`100% {${i(n,1-n)}}\n}`,u=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(b)}_${o}`,d=t.ownerDocument;X.add(d);const f=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(J("style")).sheet),j=d.__svelte_rules||(d.__svelte_rules={});j[u]||(j[u]=!0,f.insertRule(`@keyframes ${u} ${b}`,f.cssRules.length));const O=t.style.animation||"";return t.style.animation=`${O?O+", ":""}${u} ${c}ms linear ${s}ms 1 both`,U+=1,u}function Q(t,e){const n=(t.style.animation||"").split(", "),c=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),s=n.length-c.length;s&&(t.style.animation=c.join(", "),U-=s,U||k(()=>{U||(X.forEach(t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}}),X.clear())}))}function tt(t,e,n,r){if(!e)return c;const i=t.getBoundingClientRect();if(e.left===i.left&&e.right===i.right&&e.top===i.top&&e.bottom===i.bottom)return c;const{delay:o=0,duration:l=300,easing:a=s,start:b=y()+o,end:u=b+l,tick:d=c,css:f}=n(t,{from:e,to:i},r);let j,O=!0,p=!1;function h(){f&&Q(t,j),O=!1}return A(t=>{if(!p&&t>=b&&(p=!0),p&&t>=u&&(d(1,0),h()),!O)return!1;if(p){const e=0+1*a((t-b)/l);d(e,1-e)}return!0}),f&&(j=Z(t,0,1,l,o,a,f)),o||(p=!0),d(0,1),h}function et(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:n,height:c}=e,s=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=c,nt(t,s)}}function nt(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const c=getComputedStyle(t),s="none"===c.transform?"":c.transform;t.style.transform=`${s} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}function ct(t){Y=t}function st(){if(!Y)throw new Error("Function called outside component initialization");return Y}function rt(t){st().$$.on_mount.push(t)}function it(t){st().$$.on_destroy.push(t)}function ot(){const t=st();return(e,n)=>{const c=t.$$.callbacks[e];if(c){const s=V(e,n);c.slice().forEach(e=>{e.call(t,s)})}}}function lt(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(t=>t(e))}const at=[],bt=[],ut=[],dt=[],ft=Promise.resolve();let jt=!1;function Ot(){jt||(jt=!0,ft.then(vt))}function pt(t){ut.push(t)}function ht(t){dt.push(t)}let gt=!1;const mt=new Set;function vt(){if(!gt){gt=!0;do{for(let t=0;t<at.length;t+=1){const e=at[t];ct(e),xt(e.$$)}for(ct(null),at.length=0;bt.length;)bt.pop()();for(let t=0;t<ut.length;t+=1){const e=ut[t];mt.has(e)||(mt.add(e),e())}ut.length=0}while(at.length);for(;dt.length;)dt.pop()();jt=!1,gt=!1,mt.clear()}}function xt(t){if(null!==t.fragment){t.update(),l(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(pt)}}let yt;function kt(){return yt||(yt=Promise.resolve(),yt.then(()=>{yt=null})),yt}function wt(t,e,n){t.dispatchEvent(V(`${e?"intro":"outro"}${n}`))}const $t=new Set;let At;function St(){At={r:0,c:[],p:At}}function Ct(){At.r||l(At.c),At=At.p}function zt(t,e){t&&t.i&&($t.delete(t),t.i(e))}function _t(t,e,n,c){if(t&&t.o){if($t.has(t))return;$t.add(t),At.c.push(()=>{$t.delete(t),c&&(n&&t.d(1),c())}),t.o(e)}}const Jt={duration:0};function Nt(t,e,n){let r,i,o=e(t,n),l=!1,b=0;function u(){r&&Q(t,r)}function d(){const{delay:e=0,duration:n=300,easing:a=s,tick:d=c,css:f}=o||Jt;f&&(r=Z(t,0,1,n,e,a,f,b++)),d(0,1);const j=y()+e,O=j+n;i&&i.abort(),l=!0,pt(()=>wt(t,!0,"start")),i=A(e=>{if(l){if(e>=O)return d(1,0),wt(t,!0,"end"),u(),l=!1;if(e>=j){const t=a((e-j)/n);d(t,1-t)}}return l})}let f=!1;return{start(){f||(Q(t),a(o)?(o=o(),kt().then(d)):d())},invalidate(){f=!1},end(){l&&(u(),l=!1)}}}function Pt(t,e,n){let r,i=e(t,n),o=!0;const b=At;function u(){const{delay:e=0,duration:n=300,easing:a=s,tick:u=c,css:d}=i||Jt;d&&(r=Z(t,1,0,n,e,a,d));const f=y()+e,j=f+n;pt(()=>wt(t,!1,"start")),A(e=>{if(o){if(e>=j)return u(0,1),wt(t,!1,"end"),--b.r||l(b.c),!1;if(e>=f){const t=a((e-f)/n);u(1-t,t)}}return o})}return b.r+=1,a(i)?kt().then(()=>{i=i(),u()}):u(),{end(e){e&&i.tick&&i.tick(1,0),o&&(r&&Q(t,r),o=!1)}}}function Lt(t,e,n,r){let i=e(t,n),o=r?0:1,b=null,u=null,d=null;function f(){d&&Q(t,d)}function j(t,e){const n=t.b-o;return e*=Math.abs(n),{a:o,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function O(e){const{delay:n=0,duration:r=300,easing:a=s,tick:O=c,css:p}=i||Jt,h={start:y()+n,b:e};e||(h.group=At,At.r+=1),b||u?u=h:(p&&(f(),d=Z(t,o,e,r,n,a,p)),e&&O(0,1),b=j(h,r),pt(()=>wt(t,e,"start")),A(e=>{if(u&&e>u.start&&(b=j(u,r),u=null,wt(t,b.b,"start"),p&&(f(),d=Z(t,o,b.b,b.duration,0,a,i.css))),b)if(e>=b.end)O(o=b.b,1-o),wt(t,b.b,"end"),u||(b.b?f():--b.group.r||l(b.group.c)),b=null;else if(e>=b.start){const t=e-b.start;o=b.a+b.d*a(t/b.duration),O(o,1-o)}return!(!b&&!u)}))}return{run(t){a(i)?kt().then(()=>{i=i(),O(t)}):O(t)},end(){f(),b=u=null}}}const Mt="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function Et(t,e){t.d(1),e.delete(t.key)}function Tt(t,e){_t(t,1,1,()=>{e.delete(t.key)})}function It(t,e){t.f(),Tt(t,e)}function Ht(t,e,n,c,s,r,i,o,l,a,b,u){let d=t.length,f=r.length,j=d;const O={};for(;j--;)O[t[j].key]=j;const p=[],h=new Map,g=new Map;for(j=f;j--;){const t=u(s,r,j),o=n(t);let l=i.get(o);l?c&&l.p(t,e):(l=a(o,t),l.c()),h.set(o,p[j]=l),o in O&&g.set(o,Math.abs(j-O[o]))}const m=new Set,v=new Set;function x(t){zt(t,1),t.m(o,b),i.set(t.key,t),b=t.first,f--}for(;d&&f;){const e=p[f-1],n=t[d-1],c=e.key,s=n.key;e===n?(b=e.first,d--,f--):h.has(s)?!i.has(c)||m.has(c)?x(e):v.has(s)?d--:g.get(c)>g.get(s)?(v.add(c),x(e)):(m.add(s),d--):(l(n,i),d--)}for(;d--;){const e=t[d];h.has(e.key)||l(e,i)}for(;f;)x(p[f-1]);return p}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let qt;function Bt(t,e,n){const c=t.$$.props[e];void 0!==c&&(t.$$.bound[c]=n,n(t.$$.ctx[c]))}function Gt(t){t&&t.c()}function Rt(t,e,n){const{fragment:c,on_mount:s,on_destroy:r,after_update:o}=t.$$;c&&c.m(e,n),pt(()=>{const e=s.map(i).filter(a);r?r.push(...e):l(e),t.$$.on_mount=[]}),o.forEach(pt)}function Ft(t,e){const n=t.$$;null!==n.fragment&&(l(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Wt(t,e,n,s,r,i,a=[-1]){const b=Y;ct(t);const u=e.props||{},d=t.$$={fragment:null,ctx:null,props:i,update:c,not_equal:r,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(b?b.$$.context:[]),callbacks:o(),dirty:a,skip_bound:!1};let f=!1;if(d.ctx=n?n(t,u,(e,n,...c)=>{const s=c.length?c[0]:n;return d.ctx&&r(d.ctx[e],d.ctx[e]=s)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](s),f&&function(t,e){-1===t.$$.dirty[0]&&(at.push(t),Ot(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(t,e)),n}):[],d.update(),f=!0,l(d.before_update),d.fragment=!!s&&s(d.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);d.fragment&&d.fragment.l(t),t.forEach(z)}else d.fragment&&d.fragment.c();e.intro&&zt(t.$$.fragment),Rt(t,e.target,e.anchor),vt()}ct(b)}"function"==typeof HTMLElement&&(qt=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}$destroy(){Ft(this,1),this.$destroy=c}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!u(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class Dt{$destroy(){Ft(this,1),this.$destroy=c}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!u(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return r})),n.d(e,"d",(function(){return i}));var c=n(0);n.d(e,"b",(function(){return c.E}));const s=[];function r(t,e){return{subscribe:i(t,e).subscribe}}function i(t,e=c.O){let n;const r=[];function i(e){if(Object(c.X)(t,e)&&(t=e,n)){const e=!s.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),s.push(n,t)}if(e){for(let t=0;t<s.length;t+=2)s[t][0](s[t+1]);s.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(s,o=c.O){const l=[s,o];return r.push(l),1===r.length&&(n=e(i)||c.O),s(t),()=>{const t=r.indexOf(l);-1!==t&&r.splice(t,1),0===r.length&&(n(),n=null)}}}}function o(t,e,n){const s=!Array.isArray(t),i=s?[t]:t,o=e.length<2;return r(n,t=>{let n=!1;const r=[];let l=0,a=c.O;const b=()=>{if(l)return;a();const n=e(s?r[0]:r,t);o?t(n):a=Object(c.K)(n)?n:c.O},u=i.map((t,e)=>Object(c.fb)(t,t=>{r[e]=t,l&=~(1<<e),n&&b()},()=>{l|=1<<e}));return n=!0,b(),function(){Object(c.W)(u),a()}})}},function(t,e,n){"use strict";var c=n(0);n.d(e,"a",(function(){return c.p})),n.d(e,"b",(function(){return c.R})),n.d(e,"c",(function(){return c.S}))},function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return b}));var c=n(1);const s={subtitleFallbackColor:"#FFFFFF",showSubtitlesOnVideo:!0,pauseWhenTrayOpen:!0,invertVerticalAlignment:!0},r=Object.assign({},s,GM_getValue("settings-store",{})),i={};Object.keys(s).forEach(t=>{(i[t]=Object(c.d)(r[t])).subscribe(e=>{r[t]=e,GM_setValue("settings-store",r)})});const o=i.subtitleFallbackColor,l=i.showSubtitlesOnVideo,a=i.pauseWhenTrayOpen,b=i.invertVerticalAlignment},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return r}));var c=n(0);function s(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1}function r(t){const e=t-1;return e*e*e+1}n.d(e,"c",(function(){return c.H}))},,,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return r}));var c=n(4);n(0);function s(t,{delay:e=0,duration:n=400,easing:s=c.c}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:s,css:t=>"opacity: "+t*r}}function r(t,{delay:e=0,duration:n=400,easing:s=c.b,x:r=0,y:i=0,opacity:o=0}){const l=getComputedStyle(t),a=+l.opacity,b="none"===l.transform?"":l.transform,u=a*(1-o);return{delay:e,duration:n,easing:s,css:(t,e)=>`\n\t\t\ttransform: ${b} translate(${(1-t)*r}px, ${(1-t)*i}px);\n\t\t\topacity: ${a-u*e}`}}},,,function(t,e){const n=t=>Object.assign({},t);t.exports=class{constructor(t,e){this.format=t,this.fileName=e,this.subs=[],this.generatedIdBase=0}genId(){return"generated-id-"+this.generatedIdBase++}getSubs(t){return this.subs.filter(e=>e.start<=t&&e.end>=t)}timeToMs(t){const[e,n,c]=t.split(":");return 36e5*+e+6e4*+n+1e3*parseFloat(c)}prettyTimeDifference(t,e){return`+${parseFloat(((e-t)/1e3).toFixed(1))} seconds`}getAlignmentCandidates(t){let e=this.subs;return e.sort((t,e)=>t.start-e.end),t?e.reduce((c,s,r)=>{if(s.text.includes(t)){const t=r+1,i=e.slice(t,t+3).map(n).map(t=>(t.offset=this.prettyTimeDifference(s.start,t.start),t));c.push({type:"search-match",sub:s,subsequent:i})}return c},[]).slice(0,5):e.slice(0,20).map(n).map(t=>(t.offset=this.prettyTimeDifference(e[0].start,t.start),t))}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return r}));var c=n(1);const s=Object(c.c)(0,t=>{let e;return function n(){e=requestAnimationFrame(n);const c=document.querySelector("video");c&&t(c.currentTime)}(),()=>{cancelAnimationFrame(e)}}),r=Object(c.d)(!0);let i;function o(){r.set(!0),clearTimeout(i),i=setTimeout(()=>{r.set(!1)},2500)}document.addEventListener("keydown",o),document.addEventListener("mousemove",o)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var c=n(12),s=n.n(c);const r={"line-left":"0%",center:"-50%","line-right":"-100%"};class i extends s.a{constructor(t,e){super("subrip",e);const n=Date.now();this.parse(t),this.parseTime=Date.now()-n}parse(t){const e=t.replace(/\r/g,"").split("\n\n");this.subs=e.reduce((t,e)=>{let n=e.trim().split("\n");function c(){n.shift()}try{/^\d*$/.test(n[0])&&c();let[e,s]=n[0].replace(/,/g,".").match(/^([\d:\.\-> ]*)/)[0].split(/\-\->/),i=n[0].match(/([a-zA-Z].*)/);i=i&&i.length?i[1]:"";let o=[];const l=n.length-1,a=(t,e)=>{const n=i.match(new RegExp(t+":([-\\d\\.]*)%?"));return n?n[1]:e},b=(t,e)=>{const n=i.match(new RegExp(t+":([\\d\\.]*)%"));return n?parseInt(n[1],10):e},u=t=>{const e=i.match(new RegExp(t+":([w-]*?)"));if(e)return e[1]},d=()=>{const t=i.match(/position:([\d.]*)%(?:,(\w*))?/);return t?{position:parseInt(t[1]),positionAlignment:"middle"===t[2]?"center":t[2]}:{position:50,positionAlignment:"center"}},f=5;let{position:j,positionAlignment:O="center"}=d(),p=(u("align"),a("line",100)),h=b("size",null);const g={[p]:p,"-1":100,0:0}[p];o.push(`left: ${j}vw`);const m=`translateX(${r[O]})`;o.push("width: "+(h?h+"vw":"max-content")),c();const v=n.join("\n").replace(/<\/?c.Japanese>/g,"");o.push(`font-size: ${f}vh`);const x=l*1,y=`transform: ${m} `+(g>75?"translateY(-100%)":""),k=`transform: translateY(${g>75?"0%":"-100%"}) ${m}`,w="calc(100vh - 100px)",$=100-x+"vh",A=(t,e)=>`top: clamp(${x}vh, ${t}vh, ${e});`;t.push({_id:this.genId(),start:this.timeToMs(e),end:this.timeToMs(s),verticalAlignment:{normal:{inactive:`${A(g,$)} ${y}`,active:`${A(g,w)} ${y}`},inverted:{inactive:`${A(100-g,$)} ${k}`,active:`${A(100-g,w)} ${k}`}},text:v,inline:o.join("; ")})}catch(t){}return t},[])}serialize(t){return JSON.stringify("number"==typeof t?this.getSubs(t):this.subs,null,4)}debugInfo(){return[{title:"Number of subtitles",detail:this.subs.length}]}}},,,,function(t,e,n){"use strict";function c(t){return t.filter(t=>!!t).join(";")}n.d(e,"a",(function(){return c}))},,,,,,,,,,,,function(t,e,n){"use strict";var c=n(0),s=n(18),r=n(3),i=n(2),o=(n(9),n(13));function l(t,e,n){const c=t.slice();return c[10]=e[n],c}function a(t){let e,n=[],s=new Map,r=t[2];const i=t=>t[10]._id;for(let e=0;e<r.length;e+=1){let c=l(t,r,e),o=i(c);s.set(o,n[e]=b(o,c))}return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=Object(c.B)()},m(t,s){for(let e=0;e<n.length;e+=1)n[e].m(t,s);Object(c.J)(t,e,s)},p(t,r){if(60&r){const o=t[2];n=Object(c.lb)(n,r,i,1,t,o,s,e.parentNode,c.w,b,e,l)}},d(t){for(let e=0;e<n.length;e+=1)n[e].d(t);t&&Object(c.z)(e)}}}function b(t,e){let n,s,r,i,o,l,a,b,u=e[10].text+"";function d(...t){return e[6](e[10],...t)}return{key:t,first:null,c(){n=Object(c.A)("p"),s=Object(c.hb)(u),r=Object(c.db)(),Object(c.i)(n,"style",i=e[5](e[10],e[3])),Object(c.i)(n,"data-sub-style",o=e[10].style),Object(c.i)(n,"data-sub-id",l=e[10]._id),Object(c.i)(n,"title","click to search this phrase on Jisho.org"),Object(c.i)(n,"class","svelte-9du6gr"),this.first=n},m(t,e){Object(c.J)(t,n,e),Object(c.g)(n,s),Object(c.g)(n,r),a||(b=Object(c.L)(n,"click",d),a=!0)},p(t,r){e=t,4&r&&u!==(u=e[10].text+"")&&Object(c.ab)(s,u),12&r&&i!==(i=e[5](e[10],e[3]))&&Object(c.i)(n,"style",i),4&r&&o!==(o=e[10].style)&&Object(c.i)(n,"data-sub-style",o),4&r&&l!==(l=e[10]._id)&&Object(c.i)(n,"data-sub-id",l)},d(t){t&&Object(c.z)(n),a=!1,b()}}}function u(t){let e,n=t[1]&&a(t);return{c(){e=Object(c.A)("div"),n&&n.c(),Object(c.i)(e,"class","subtitles")},m(t,s){Object(c.J)(t,e,s),n&&n.m(e,null)},p(t,[c]){t[1]?n?n.p(t,c):(n=a(t),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},i:c.O,o:c.O,d(t){t&&Object(c.z)(e),n&&n.d()}}}function d(t,e,n){let l,a,b,u,d,f=c.O,j=()=>(f(),f=Object(c.fb)(p,t=>n(2,u=t)),p);Object(c.n)(t,r.d,t=>n(7,l=t)),Object(c.n)(t,r.a,t=>n(8,a=t)),Object(c.n)(t,r.c,t=>n(1,b=t)),Object(c.n)(t,o.b,t=>n(3,d=t)),t.$$.on_destroy.push(()=>f());const O=Object(i.a)();let{subtitles:p}=e;function h(t){O("define-pauser"),window.open("https://jisho.org/search/"+encodeURIComponent(t.trim()))}j();return t.$$set=t=>{"subtitles"in t&&j(n(0,p=t.subtitles))},[p,b,u,d,h,function(t,e){let n=["color: "+l];return t.verticalAlignment&&n.push(t.verticalAlignment[a?"inverted":"normal"][e?"active":"inactive"]),n=n.concat([t.inline||""]),Object(s.a)(n)},t=>h(t.text)]}class f extends c.b{constructor(t){var e;super(),document.getElementById("svelte-9du6gr-style")||((e=Object(c.A)("style")).id="svelte-9du6gr-style",e.textContent='p.svelte-9du6gr{cursor:pointer;position:fixed;color:white;margin:0;padding:0;white-space:pre-line;text-align:center;max-width:100vw;font-family:"Source Han Sans", "源ノ角ゴシック", "Hiragino Sans", "HiraKakuProN-W3", "Hiragino Kaku Gothic ProN W3", "Hiragino Kaku Gothic ProN", "ヒラギノ角ゴ ProN W3", "Noto Sans", "Noto Sans CJK JP", "メイリオ", Meiryo, "游ゴシック", YuGothic, "ＭＳ Ｐゴシック", "MS PGothic", "ＭＳ ゴシック", "MS Gothic", sans-serif;display:block;transition:top 0.1s;text-shadow:-4px -4px 0px rgba(9, 9, 9, 255), -4px -3px 0px rgba(9, 9, 9, 255), -4px -2px 0px rgba(9, 9, 9, 255), -4px -1px 0px rgba(9, 9, 9, 255), -4px 0px 0px rgba(9, 9, 9, 255), -4px 1px 0px rgba(9, 9, 9, 255), -4px 2px 0px rgba(9, 9, 9, 255), -4px 3px 0px rgba(9, 9, 9, 255), -4px 4px 0px rgba(9, 9, 9, 255), -3px -4px 0px rgba(9, 9, 9, 255), -3px -3px 0px rgba(9, 9, 9, 255), -3px -2px 0px rgba(9, 9, 9, 255), -3px -1px 0px rgba(9, 9, 9, 255), -3px 0px 0px rgba(9, 9, 9, 255), -3px 1px 0px rgba(9, 9, 9, 255), -3px 2px 0px rgba(9, 9, 9, 255), -3px 3px 0px rgba(9, 9, 9, 255), -3px 4px 0px rgba(9, 9, 9, 255), -2px -4px 0px rgba(9, 9, 9, 255), -2px -3px 0px rgba(9, 9, 9, 255), -2px -2px 0px rgba(9, 9, 9, 255), -2px -1px 0px rgba(9, 9, 9, 255), -2px 0px 0px rgba(9, 9, 9, 255), -2px 1px 0px rgba(9, 9, 9, 255), -2px 2px 0px rgba(9, 9, 9, 255), -2px 3px 0px rgba(9, 9, 9, 255), -2px 4px 0px rgba(9, 9, 9, 255), -1px -4px 0px rgba(9, 9, 9, 255), -1px -3px 0px rgba(9, 9, 9, 255), -1px -2px 0px rgba(9, 9, 9, 255), -1px -1px 0px rgba(9, 9, 9, 255), -1px 0px 0px rgba(9, 9, 9, 255), -1px 1px 0px rgba(9, 9, 9, 255), -1px 2px 0px rgba(9, 9, 9, 255), -1px 3px 0px rgba(9, 9, 9, 255), -1px 4px 0px rgba(9, 9, 9, 255), 0px -4px 0px rgba(9, 9, 9, 255), 0px -3px 0px rgba(9, 9, 9, 255), 0px -2px 0px rgba(9, 9, 9, 255), 0px -1px 0px rgba(9, 9, 9, 255), 0px 0px 0px rgba(9, 9, 9, 255), 0px 1px 0px rgba(9, 9, 9, 255), 0px 2px 0px rgba(9, 9, 9, 255), 0px 3px 0px rgba(9, 9, 9, 255), 0px 4px 0px rgba(9, 9, 9, 255), 1px -4px 0px rgba(9, 9, 9, 255), 1px -3px 0px rgba(9, 9, 9, 255), 1px -2px 0px rgba(9, 9, 9, 255), 1px -1px 0px rgba(9, 9, 9, 255), 1px 0px 0px rgba(9, 9, 9, 255), 1px 1px 0px rgba(9, 9, 9, 255), 1px 2px 0px rgba(9, 9, 9, 255), 1px 3px 0px rgba(9, 9, 9, 255), 1px 4px 0px rgba(9, 9, 9, 255), 2px -4px 0px rgba(9, 9, 9, 255), 2px -3px 0px rgba(9, 9, 9, 255), 2px -2px 0px rgba(9, 9, 9, 255), 2px -1px 0px rgba(9, 9, 9, 255), 2px 0px 0px rgba(9, 9, 9, 255), 2px 1px 0px rgba(9, 9, 9, 255), 2px 2px 0px rgba(9, 9, 9, 255), 2px 3px 0px rgba(9, 9, 9, 255), 2px 4px 0px rgba(9, 9, 9, 255), 3px -4px 0px rgba(9, 9, 9, 255), 3px -3px 0px rgba(9, 9, 9, 255), 3px -2px 0px rgba(9, 9, 9, 255), 3px -1px 0px rgba(9, 9, 9, 255), 3px 0px 0px rgba(9, 9, 9, 255), 3px 1px 0px rgba(9, 9, 9, 255), 3px 2px 0px rgba(9, 9, 9, 255), 3px 3px 0px rgba(9, 9, 9, 255), 3px 4px 0px rgba(9, 9, 9, 255), 4px -4px 0px rgba(9, 9, 9, 255), 4px -3px 0px rgba(9, 9, 9, 255), 4px -2px 0px rgba(9, 9, 9, 255), 4px -1px 0px rgba(9, 9, 9, 255), 4px 0px 0px rgba(9, 9, 9, 255), 4px 1px 0px rgba(9, 9, 9, 255), 4px 2px 0px rgba(9, 9, 9, 255), 4px 3px 0px rgba(9, 9, 9, 255), 4px 4px 0px rgba(9, 9, 9, 255), 2px 2px 0px rgba(20, 20, 20, 195)}p.svelte-9du6gr:hover{color:#0aff8c !important}',Object(c.g)(document.head,e)),Object(c.I)(this,t,d,u,c.X,{subtitles:0})}}e.a=f},,function(t,e,n){const c=n(12),s=t=>(t.charAt(0).toLowerCase()+t.substring(1)).replace(" ",""),r={1:1,2:2,3:3,5:7,6:8,7:9,9:4,10:5,11:6};function i(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}const o=t=>{if(t){t=(t=t.replace(/[&H]/g,"").replace(/[^0-9A-F]/g,"")).padStart(8,"0");const[e,n,c,s,r]=t.match(/([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})/i),i=t=>parseInt(t,16);return{rgba:`rgba(${i(r)}, ${i(s)}, ${i(c)}, ${((255-i(n))/255).toFixed(3)})`,weakenAlpha:t=>`rgba(${i(r)}, ${i(s)}, ${i(c)}, ${(t*((255-i(n))/255)).toFixed(3)})`}}},l=t=>{const e=[],n=/([mnlbspc][ \.0-9\-]+)/g;for(const c of t.match(n)){const[t,...n]=c.trim().split(" ");e.push({command:t,coordinates:n.map(parseFloat)})}const c=-1*e.reduce((t,{coordinates:e})=>Math.min(t,...e),0);return e.forEach(t=>{t.coordinates=t.coordinates.map(t=>t+c)}),e},a=(t,e,n="transparent",c=0,s=0)=>{const r=t||n,i=s<1?r.rgba:r.weakenAlpha(1/(4*e));s+="px";let o=[];for(let t=-1*(e=void 0===e?1:parseInt(e,10));t<=e;t++)for(let n=-1*e;n<=e;n++)o.push(`${t}px ${n}px ${s} ${i}`);return 0===e&&(o=["none"]),`text-shadow: ${o.join(", ")}; filter: drop-shadow(${c}px ${c}px ${s} ${n.rgba})`},b=t=>`font-family: "${t}", "Source Han Sans", "源ノ角ゴシック", "Hiragino Sans", "HiraKakuProN-W3", "Hiragino Kaku Gothic ProN W3", "Hiragino Kaku Gothic ProN", "ヒラギノ角ゴ ProN W3", "Noto Sans", "Noto Sans CJK JP", "メイリオ", Meiryo, "游ゴシック", YuGothic, "ＭＳ Ｐゴシック", "MS PGothic", "ＭＳ ゴシック", "MS Gothic", sans-serif`;const u=t=>parseInt(t,10),d=[{tag:"t",friendly:"animatedTransform",complex:!0,repeatable:!0},{tag:"move",friendly:"movement",complex:!0,parser:parseFloat},{tag:"clip",friendly:"clip",complex:!0,parser:t=>{if(4!==t.length){const[e,n]=1===t.length?[1,t[0]]:t;return{scale:e,commands:l(n)}}},parseTogether:!0},{tag:"3c",friendly:"outlineColor",parser:o},{tag:"4c",friendly:"shadowColor",parser:o},{tag:"bord",friendly:"outlineSize"},{tag:"shad",friendly:"shadowDepth"},{tag:"blur",friendly:"blur"},{tag:"be",friendly:"blur"},{tag:"pos",friendly:"position",complex:!0,parser:u},{tag:"an",friendly:"alignment"},{tag:"org",friendly:"origin",complex:!0},{tag:"fscx",friendly:"fontScaleX"},{tag:"fscy",friendly:"fontScaleY"},{tag:"frx",friendly:"rotateX"},{tag:"fry",friendly:"rotateY"},{tag:"frz",friendly:"rotateZ"},{tag:"fad",friendly:"fade",complex:!0,parser:u},{tag:"fsp",friendly:"letterSpacing"},{tag:"fs",friendly:"fontSize"},{tag:"u",friendly:"underline"},{tag:"s",friendly:"strikethrough"},{tag:"b",friendly:"bold",parser:u},{tag:"i",friendly:"italic",parser:u},{tag:"fn",friendly:"fontName"},{tag:"1c",friendly:"color",parser:o},{tag:"c",friendly:"color",parser:o},{tag:"r",friendly:"reset",defaultValue:!1},{tag:"q",friendly:"wrapStyle"},{tag:"p",friendly:"drawMode"},{tag:"a",friendly:"alignment",parser:t=>r[t]}];function f(t,e,n=!1){return e?n?e(t):Array.isArray(t)?t.map(e):e(t):t}function j(t){const e=t,n=t.replace(/{.*?}/g,""),c={},s={};let[r]=t.match(/{.*?}/);for(const{tag:t,friendly:e,complex:n=!1,defaultValue:i,parser:o,repeatable:l=!1,parseTogether:a}of d){let b=O(r,t,n),u=0;for(;!l&&0===u||l&&b;){if(b){r=b.overrides;const n=f(b.params,o,a)||i;c[e]=l?[...c[e]||[],n]:n,s[t]=l?[...s[t]||[],b.params]:b.params}b=O(r,t,n),u++}}return{text:n,rawText:e,overrides:c,rawOverrides:s}}function O(t,e,n=!1){if(n){const n=t.match(`\\\\${e}\\((.*)`);if(!n)return;let s=[],r="",i="",o=!1;const l=n[1];for(let n=0;n<l.length&&t;n++){const a=l[n];function c(){i+=a,r+=a}if("("===a)c(),o=!0;else if(o||","!==a&&")"!==a)o&&")"===a?(c(),o=!1):c();else if(s.push(i),r+=a,i="",")"===a)return{overrides:t.replace(`\\${e}(`+r,""),params:s}}}const s=new RegExp(`\\\\${e}([^\\\\}]*)`),r=t.match(s);if(r)return{overrides:t.replace(r[0],""),params:r[1]}}t.exports={getOverride:O,ASS:class extends c{constructor(t,e){super("ass",e);const n=Date.now();t=t.replace(/\r\n/g,"\n");try{this.blocks=this.parseBlocks(t),this.subs=this.parseBlock(this.blocks.subs),this.parseInfo(this.blocks.info),this.parseSubTimings(),this.parseStyles(this.parseBlock(this.blocks.styles)),this.parseSubOverrideTags()}catch(t){console.error("ASS PARSE ERROR",t),this.subs=[]}this.parseTime=Date.now()-n}serialize(t){let e=this.subs,n=this.styles;if("number"==typeof t){e=this.getSubs(t),n={};for(const{style:t}of e)n[t]=this.styles[t]}return JSON.stringify({info:this.info,styles:n,subs:e},null,4)}debugInfo(){return[{title:"Number of styles",detail:Object.keys(this.styles).length},{title:"Number of subtitles",detail:this.subs.length}]}parseInfo(){this.info={},this.blocks.info.split("\n").forEach(t=>{const[e,n]=t.split(/: ?/);this.info[s(e)]=n})}scaleHeight(t){return t/+this.info.playResY*100+"vh"}scaleWidth(t){return t/+this.info.playResX*100+"vw"}parseBlocks(t){const e=t.split(/\n(?=\[)/),n=t=>e.find(e=>{e=e.trim();const[n,c]=e.match(/^\[(.*?)]/);return c===t}).replace(/.*\n/,"").trim();return{info:n("Script Info"),styles:n("V4+ Styles"),subs:n("Events")}}parseBlock(t){const[e,...n]=t.split("\n"),c=(t,e=1/0)=>{let[n,c,s]=t.match(/(\w*): (.*)/);return s=s.split(","),s.length>e&&(s[e-1]=s.slice(e-1).join(","),s.splice(e,1/0)),{type:c,attributes:s}},r=c(e);return n.reduce((t,e)=>{if(!e||";"===e.charAt(0)||0===e.indexOf("Comment: "))return t;const n=c(e,r.attributes.length),i={dataType:n.type.toLowerCase()};return r.attributes.forEach((t,e)=>{t=t.trim();const c=s(t);i[c]=n.attributes[e]}),i.style="*Default"===i.style?"Default":i.style,i._id=this.genId(),t.push(i),t},[])}parseSubTimings(){this.subs.forEach(t=>{t.rawStart=t.start,t.rawEnd=t.end,t.start=this.timeToMs(t.start),t.end=this.timeToMs(t.end)})}parseStyles(t){const e={};t.forEach(t=>{for(const e of Object.keys(t).filter(t=>/colour/i.test(t)))t[e]=o(t[e]);t.name="*Default"===t.name?"Default":t.name;const n=[],{primaryColour:c,secondaryColour:s,outlineColour:r,backColour:i,borderStyle:l,outline:u,shadow:d,fontname:f,fontsize:j,bold:O,italic:p,underline:h,strikeOut:g,alignment:m,marginL:v,marginR:x,marginV:y}=t;c&&n.push("color: "+c.rgba),f&&n.push(b(f)),"1"===l?n.push(a(r,u,i,d)):"3"===l&&n.push("background-color: "+i.rgba),"-1"===O&&n.push("font-weight: bold"),"-1"===p&&n.push("font-style: italic"),"-1"!==h&&"-1"!==g||n.push(`text-decoration: ${"-1"===h?"underline":""} ${"-1"===g?"line-through":""}`),n.push(this.genScaledFont(j)),e[t.name]={inline:n.join(";"),marginL:this.scaleWidth(v),marginR:this.scaleWidth(x),marginV:this.scaleHeight(y),raw:t}}),this.styles=e}genScaledFont(t){return"font-size: "+this.scaleHeight(.7*t)}parseSubOverrideTags(){this.subs.forEach(t=>{t.rawText=t.text,t.text=t.text.replace(/\\n/g," ").replace(/\\N/g,"\n").trim().replace(/\\h/g," ");const e=this.styles[t.style];if(t.mountPoint=e.raw.alignment,!/{.+?}/.test(t.text))return;t.phrases=[];const n=function*(t){const e=/({.*?}[^{]*)/g;let n;const c=t.indexOf("{");for(c>0&&(yield{text:t.substring(0,c),overrides:{}});null!==(n=e.exec(t));)yield j(n[1])}(t.text);let c=[];for(const s of n){const n=[],r={_id:this.genId(),text:s.text,fadeIn:0,fadeOut:0,inline:"",overrides:s.overrides,rawOverrides:s.rawOverrides,rawText:s.rawText,html:""},{overrides:i}=s;if(i.outlineColor||i.shadowColor||i.outlineSize||i.shadowDepth||i.blur){const e=this.styles[t.style];if(e){const t=i.outlineColor||e.raw.outlineColour,n=i.shadowColor||e.raw.backColour,s=i.outlineSize||e.raw.outline,r=i.shadowDepth||e.raw.shadow;c.push(a(t,s,n,r,i.blur))}}let o=[];if(i.position||i.movement){if(t.mountPoint="positioned",i.position){const[t,e]=i.position;n.push(`position: fixed; left: ${this.scaleWidth(t)}; top: ${this.scaleHeight(e)}`)}else if(i.movement){const[e,n,c,s,...r]=i.movement;t.movement={x1:this.scaleWidth(e),y1:this.scaleHeight(n),x2:this.scaleWidth(c),y2:this.scaleHeight(s),timings:r.every(t=>0===t)?[]:r}}n.push("white-space: pre");const s={1:"0, -100%",2:"-50%, -100%",3:"-100%, -100%",4:"0, -50%",5:"-50%, -50%",6:"-100%, -50%",7:"0, 0",8:"-50%, 0",9:"-100%, 0"}[i.alignment||e.raw.alignment];if(n.push(`transform: translate(${s})`),i.origin){const[t,e]=i.origin;c.push(`transform-origin: ${this.scaleWidth(t)} ${this.scaleHeight(e)}`)}}else i.alignment&&(t.mountPoint=i.alignment);const{fontScaleX:l,fontScaleY:u}=i;l&&o.push(`scaleX(${l}%)`),u&&o.push(`scaleY(${u}%)`);const d=[],f=(t,e,n=1)=>{if(void 0!==t)return t=parseFloat(t)*n,d.push(`${e}(${t}deg)`)};f(i.rotateY,"rotateY"),f(i.rotateX,"rotateX"),f(i.rotateZ,"rotateZ",-1),d.length&&(o.push("perspective(200px)"),o.push(d.join(" "))),o.length&&(c.push("display: inline-block"),c.push("transform: "+o.join(" "))),i.fade&&(r.fadeIn=i.fade[0],r.fadeOut=i.fade[1],t.end-=r.fadeOut),i.letterSpacing&&c.push(`letter-spacing: ${i.letterSpacing}px`),i.fontSize&&c.push(this.genScaledFont(i.fontSize));const j=[];i.underline&&j.push("underline"),i.strikethrough&&j.push("line-through"),j.length&&c.push("text-decoration: "+(j.length?j.join(" "):"none"));const{bold:O,italic:p}=i;if(void 0!==O){const t={[O]:O,1:"bold",0:"normal"};c.push("font-weight: "+t[O])}if("number"==typeof p&&c.push("font-style: "+(p?"italic":"normal")),i.fontName&&c.push(b(i.fontName)),i.color&&c.push("color: "+i.color.rgba),i.reset){c=[this.styles[i.reset].inline]}else!1===i.reset&&(c=[]);if("1"===i.drawMode){const t=this.draw(r.text,i,e);r.html+=t.html,r.drawCommands=t.commands,r.text="",n.push("pointer-events: none"),i.blur&&c.push(`filter: blur(${i.blur}px)`)}if(i.clip){const{html:t,clipId:e}=this.clip(i.clip,r._id);c.push(`clip-path: url(#${e})`),r.html+=t}r.inline=c.join(";"),t.phrases.push(r),n.length&&(t.inline=n.join(";"))}t.text=t.text.replace(/{.*?}/g,"")})}genSvg(t,e=1){const n=function(){const t=i("svg");return t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t}(),c=i("path"),{path:s,maxHeight:r,maxWidth:o,viewBox:l}=(t=>{let e=[],n=0,c=0;function s(t,e){n=Math.max(n,t),c=Math.max(c,e)}function r(t,n,c,s){const r=[],i=n.slice();for(;i.length>0;){const e=i.splice(0,c);s&&s(...e),r.push(t+" "+e.join(" "))}e=e.concat(r)}for(let{command:n,coordinates:c}of t)"m"===n&&e.length>0&&e.push(" Z "),"n"===n&&(n="m"),"l"===n?r("L",c,2,s):"m"===n?(e.push("M"+c.join(" ")),s(...c)):"b"===n&&r("C",c,6,(t,e,n,c,r,i)=>{s(t,e),s(n,c),s(r,i)});return{path:e.join(" "),viewBox:`0 0 ${n} ${c}`,maxHeight:c,maxWidth:n}})(t);return n.setAttribute("viewBox",l),c.setAttribute("d",s),n.setAttribute("width",this.scaleWidth(o)),n.setAttribute("height",this.scaleHeight(r)),{svg:n,path:c}}clip({scale:t,commands:e},n){const{svg:c,path:s}=this.genSvg(e,t),r=i("defs"),o=i("clipPath"),l="clip-path-"+n;return o.setAttribute("id",l),c.appendChild(r),r.appendChild(o),o.appendChild(s),{html:c.outerHTML,clipId:l,commands:e}}draw(t,e,n){const c=l(t),{svg:s,path:r}=this.genSvg(c);var i,o;return r.setAttribute("fill",(i=e.color,o=n.raw.primaryColour,i?i.rgba:o.rgba)),s.appendChild(r),{html:s.outerHTML,commands:c}}}}},,function(t,e,n){"use strict";n.r(e);var c=n(0),s=n(2),r=n(1),i=n(3),o=n(9),l=n(4);function a(t,e,n){const s=getComputedStyle(t),r="none"===s.transform?"":s.transform,i=e.from.width/t.clientWidth,o=e.from.height/t.clientHeight,a=(e.from.left-e.to.left)/i,b=(e.from.top-e.to.top)/o,u=Math.sqrt(a*a+b*b),{delay:d=0,duration:f=(t=>120*Math.sqrt(t)),easing:j=l.b}=n;return{delay:d,duration:Object(c.K)(f)?f(u):f,easing:j,css:(t,e)=>`transform: ${r} translate(${e*a}px, ${e*b}px);`}}function b(t){return"[object Date]"===Object.prototype.toString.call(t)}function u(t,e){if(t===e||t!=t)return()=>t;const n=typeof t;if(n!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const n=e.map((e,n)=>u(t[n],e));return t=>n.map(e=>e(t))}if("object"===n){if(!t||!e)throw new Error("Object cannot be null");if(b(t)&&b(e)){t=t.getTime();const n=(e=e.getTime())-t;return e=>new Date(t+e*n)}const n=Object.keys(e),c={};return n.forEach(n=>{c[n]=u(t[n],e[n])}),t=>{const e={};return n.forEach(n=>{e[n]=c[n](t)}),e}}if("number"===n){const n=e-t;return e=>t+e*n}throw new Error(`Cannot interpolate ${n} values`)}const d=()=>"last-used-alignment-"+j,f=()=>"alignment-history-"+j;let j="";const O=Object(r.d)(null),p=Object(r.d)(!1),h=Object(r.d)([]),g=Object(r.a)(h,t=>t.slice(1)),m=Object(r.d)("");m.subscribe(t=>{j=t;const e=GM_getValue(d());h.set(GM_getValue(f(),[])),O.set(e),p.set("number"==typeof e)}),O.subscribe(t=>{GM_setValue(d(),t),p.set("number"==typeof t)});const v=t=>{null!==t&&h.update((e=[])=>[x(t),...e.filter(e=>e.alignment!==t)].slice(0,5))};function x(t){return{alignment:t,signed:y(t)}}function y(t){const e=parseFloat((t/1e3).toFixed(2));return e>0?"+"+e:e}h.subscribe(t=>{GM_setValue(f(),t)});const k=Object(r.a)(O,t=>parseFloat((t/1e3).toFixed(2))),w=Object(r.a)(O,t=>y(t)),$=Object(r.a)(k,t=>0===t?"no adjustment":t>0?`delayed by ${t} seconds`:`hastened by ${Math.abs(t)} seconds`);function A(t){let e,n,s,r,i,o,l,a,b,u,d,f,j,O,p,h,g,m,v,x,y,k,w,$,A,S;return{c(){e=Object(c.A)("div"),n=Object(c.A)("h1"),n.textContent="Fine Alignment",s=Object(c.db)(),r=Object(c.A)("p"),i=Object(c.hb)("Play the video and use these adjustment buttons until the subtitles show at the right time.\n\t\t"),o=Object(c.A)("br"),l=Object(c.db)(),a=Object(c.A)("strong"),b=Object(c.hb)("Subtitles are "),u=Object(c.hb)(t[0]),d=Object(c.db)(),f=Object(c.A)("p"),f.textContent="Do the subtitles show...",j=Object(c.db)(),O=Object(c.A)("button"),O.textContent="Way too late?",p=Object(c.db)(),h=Object(c.A)("button"),h.textContent="Too late?",g=Object(c.db)(),m=Object(c.A)("button"),m.textContent="Too early?",v=Object(c.db)(),x=Object(c.A)("button"),x.textContent="Way too early?",y=Object(c.db)(),k=Object(c.A)("br"),w=Object(c.db)(),$=Object(c.A)("button"),$.textContent="Done",Object(c.i)(n,"class","svelte-t5ayh1"),Object(c.i)(O,"class","secondary"),Object(c.i)(h,"class","secondary"),Object(c.i)(m,"class","secondary"),Object(c.i)(x,"class","secondary"),Object(c.i)(e,"class","fine-align svelte-t5ayh1")},m(C,z){Object(c.J)(C,e,z),Object(c.g)(e,n),Object(c.g)(e,s),Object(c.g)(e,r),Object(c.g)(r,i),Object(c.g)(r,o),Object(c.g)(r,l),Object(c.g)(r,a),Object(c.g)(a,b),Object(c.g)(a,u),Object(c.g)(e,d),Object(c.g)(e,f),Object(c.g)(e,j),Object(c.g)(e,O),Object(c.g)(e,p),Object(c.g)(e,h),Object(c.g)(e,g),Object(c.g)(e,m),Object(c.g)(e,v),Object(c.g)(e,x),Object(c.g)(e,y),Object(c.g)(e,k),Object(c.g)(e,w),Object(c.g)(e,$),A||(S=[Object(c.L)(O,"click",t[1](-1*t[2])),Object(c.L)(h,"click",t[1](-1*t[3])),Object(c.L)(m,"click",t[1](t[3])),Object(c.L)(x,"click",t[1](t[2])),Object(c.L)($,"click",t[4])],A=!0)},p(t,[e]){1&e&&Object(c.ab)(u,t[0])},i:c.O,o:c.O,d(t){t&&Object(c.z)(e),A=!1,Object(c.W)(S)}}}function S(t,e,n){let i;Object(c.n)(t,$,t=>n(0,i=t));const o=Object(s.a)();return[i,t=>()=>{O.update(e=>e+t)},1e3,200,function(){v(Object(r.b)(O)),o("close")}]}class C extends c.b{constructor(t){var e;super(),document.getElementById("svelte-t5ayh1-style")||((e=Object(c.A)("style")).id="svelte-t5ayh1-style",e.textContent=".fine-align.svelte-t5ayh1{background:rgba(27, 26, 38, 0.9);padding:1rem;color:white;position:fixed;top:50vh;left:50vw;transform:translate(-50%, -50%);max-width:20rem}h1.svelte-t5ayh1{border-bottom:2px solid #f47521}",Object(c.g)(document.head,e)),Object(c.I)(this,t,S,A,c.X,{})}}var z=C,_=n(13);let J;const N=Object(r.d)(0),P=t=>Object(r.c)([],e=>{let n,c="number"==typeof t?t:0;"number"!=typeof t&&(n=t.subscribe(t=>{c=t}));const s=_.a.subscribe(t=>{const n=1e3*t-c;N.set(n),e(J.getSubs(n))});return()=>{s(),n&&n()}});function L(t,e,n){const c=t.slice();return c[6]=e[n],c}function M(t){let e,n=t[1],s=[];for(let e=0;e<n.length;e+=1)s[e]=T(L(t,n,e));return{c(){e=Object(c.A)("div");for(let t=0;t<s.length;t+=1)s[t].c();Object(c.i)(e,"class","svelte-xof7a2"),Object(c.ib)(e,"with-previews",t[0])},m(t,n){Object(c.J)(t,e,n);for(let t=0;t<s.length;t+=1)s[t].m(e,null)},p(t,r){if(11&r){let c;for(n=t[1],c=0;c<n.length;c+=1){const i=L(t,n,c);s[c]?s[c].p(i,r):(s[c]=T(i),s[c].c(),s[c].m(e,null))}for(;c<s.length;c+=1)s[c].d(1);s.length=n.length}1&r&&Object(c.ib)(e,"with-previews",t[0])},d(t){t&&Object(c.z)(e),Object(c.y)(s,t)}}}function E(t){let e;return{c(){e=Object(c.A)("pre"),Object(c.i)(e,"class","subtitle-preview svelte-xof7a2")},m(t,n){Object(c.J)(t,e,n)},d(t){t&&Object(c.z)(e)}}}function T(t){let e,n,s,r,i,o,l,a=t[6].signed+"",b=t[0]&&E();function u(...e){return t[4](t[6],...e)}return{c(){e=Object(c.A)("button"),n=Object(c.hb)(a),s=Object(c.hb)("秒\n\t\t\t\t"),b&&b.c(),r=Object(c.db)(),Object(c.i)(e,"class","secondary svelte-xof7a2")},m(a,d){Object(c.J)(a,e,d),Object(c.g)(e,n),Object(c.g)(e,s),b&&b.m(e,null),Object(c.g)(e,r),o||(l=[Object(c.L)(e,"click",u),Object(c.c)(i=t[2].call(null,e,t[6].alignment))],o=!0)},p(s,o){t=s,2&o&&a!==(a=t[6].signed+"")&&Object(c.ab)(n,a),t[0]?b||(b=E(),b.c(),b.m(e,r)):b&&(b.d(1),b=null),i&&Object(c.K)(i.update)&&2&o&&i.update.call(null,t[6].alignment)},d(t){t&&Object(c.z)(e),b&&b.d(),o=!1,Object(c.W)(l)}}}function I(t){let e,n=t[1].length&&M(t);return{c(){n&&n.c(),e=Object(c.B)()},m(t,s){n&&n.m(t,s),Object(c.J)(t,e,s)},p(t,[c]){t[1].length?n?n.p(t,c):(n=M(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:c.O,o:c.O,d(t){n&&n.d(t),t&&Object(c.z)(e)}}}function H(t,e,n){let i;Object(c.n)(t,g,t=>n(1,i=t));let{showPreviews:o=!1}=e;const l=Object(s.a)();function a(t){O.set(t),v(t),l("aligned")}return t.$$set=t=>{"showPreviews"in t&&n(0,o=t.showPreviews)},[o,i,function(t,e){if(!o)return;const n=Object(r.d)(e),c=t.querySelector(".subtitle-preview");return{update:t=>n.set(t),destroy:P(n).subscribe(t=>{const e=t.map(t=>t.text).join("\n").trim()||"\n\n";c.textContent=e.includes("\n")?e:"\n"+e})}},a,t=>a(t.alignment)]}class q extends c.b{constructor(t){var e;super(),document.getElementById("svelte-xof7a2-style")||((e=Object(c.A)("style")).id="svelte-xof7a2-style",e.textContent="button.svelte-xof7a2{margin:0.5rem;align-self:center;max-width:20rem;overflow:hidden}pre.svelte-xof7a2{margin:0;padding:0;font-size:0.7rem}.with-previews.svelte-xof7a2{display:grid;grid-gap:0.5rem;grid-template-columns:1fr 1fr}",Object(c.g)(document.head,e)),Object(c.I)(this,t,H,I,c.X,{showPreviews:0})}}var B=q;const{document:G}=c.F;function R(t,e,n){const c=t.slice();return c[40]=e[n],c}function F(t,e,n){const c=t.slice();return c[43]=e[n],c[45]=n,c}function W(t){let e,n,s,r,i,o,l,a,b,u,d,f,j,O,p,h,g,m,v,x,y,k,w,$,A,S,C,z,_,J,N,P,L,M,E,T,I,H,q,G,W,D,Y,U,Z,Q,tt,et,nt,ct,st,rt,it,ot,lt,at,bt,ut,dt,ft,jt,Ot,pt,ht,gt,mt,vt,xt,yt,kt,wt,$t,At,St,Ct,zt,_t,Jt,Nt,Pt,Lt,Mt,Et,Tt,It,Ht,qt,Bt,Gt,Rt=[],Ft=new Map,Wt=t[1].fileName+"",Dt=t[0];const Vt=t=>t[43].text;for(let e=0;e<Dt.length;e+=1){let n=F(t,Dt,e),c=Vt(n);Ft.set(c,Rt[e]=V(c,n))}let Kt=t[9]&&K(t);D=new B({props:{showPreviews:!0}});let Xt=t[1].debugInfo(),Yt=[];for(let e=0;e<Xt.length;e+=1)Yt[e]=X(R(t,Xt,e));return{c(){e=Object(c.A)("div"),n=Object(c.A)("button"),s=Object(c.hb)("Recent Subtitles"),i=Object(c.db)(),o=Object(c.A)("button"),l=Object(c.hb)("Setup"),b=Object(c.db)(),u=Object(c.A)("button"),d=Object(c.hb)("Settings"),j=Object(c.db)(),O=Object(c.A)("div"),p=Object(c.A)("h2"),p.textContent="Recent Subtitles",h=Object(c.db)(),g=Object(c.A)("ul");for(let t=0;t<Rt.length;t+=1)Rt[t].c();m=Object(c.db)(),v=Object(c.A)("div"),x=Object(c.A)("h2"),x.textContent="Start Over",y=Object(c.db)(),k=Object(c.A)("div"),w=Object(c.A)("button"),w.textContent="Reselect subtitles",$=Object(c.db)(),A=Object(c.A)("h2"),A.textContent="Alignment",S=Object(c.db)(),C=Object(c.A)("div"),z=Object(c.A)("p"),_=Object(c.hb)(t[7]),J=Object(c.hb)(" ("),N=Object(c.hb)(t[8]),P=Object(c.hb)(")"),L=Object(c.db)(),M=Object(c.A)("div"),E=Object(c.A)("button"),E.textContent="Realign subtitles",T=Object(c.db)(),I=Object(c.A)("button"),I.textContent="Fine adjustment",H=Object(c.db)(),q=Object(c.A)("h3"),q.textContent="Switch to a previous alignment",G=Object(c.db)(),Kt&&Kt.c(),W=Object(c.db)(),Object(c.s)(D.$$.fragment),Y=Object(c.db)(),U=Object(c.A)("div"),Z=Object(c.A)("h2"),Z.textContent="Settings",Q=Object(c.db)(),tt=Object(c.A)("div"),et=Object(c.A)("label"),et.textContent="Subtitle fallback color:",nt=Object(c.db)(),ct=Object(c.A)("input"),st=Object(c.db)(),rt=Object(c.A)("div"),it=Object(c.A)("input"),ot=Object(c.db)(),lt=Object(c.A)("label"),lt.innerHTML='Show subs over video (<kbd title="Hotkey: h" class="svelte-h7adv">H</kbd>)',at=Object(c.db)(),bt=Object(c.A)("div"),ut=Object(c.A)("input"),dt=Object(c.db)(),ft=Object(c.A)("label"),ft.textContent="Pause when tray is open",jt=Object(c.db)(),Ot=Object(c.A)("div"),pt=Object(c.A)("input"),ht=Object(c.db)(),gt=Object(c.A)("label"),gt.innerHTML='Invert subtitle vertical alignment (<kbd title="Hotkey: i" class="svelte-h7adv">I</kbd>) <span class="muted svelte-h7adv">(i.e. if subtitles should be near the bottom this will make them show near the top).\n\t\t\t\t\tYou&#39;ll likely want this enabled if you intend to watch with VRV&#39;s subtitles at the same time.</span>',mt=Object(c.db)(),vt=Object(c.A)("h2"),vt.textContent="Debug Information",xt=Object(c.db)(),yt=Object(c.A)("dl"),kt=Object(c.A)("dt"),kt.textContent="Subtitles File",wt=Object(c.A)("dd"),$t=Object(c.hb)(Wt),At=Object(c.A)("dt"),At.textContent="Alignment",St=Object(c.A)("dd"),Ct=Object(c.hb)(t[7]),zt=Object(c.hb)(" ("),_t=Object(c.hb)(t[8]),Jt=Object(c.hb)(")");for(let t=0;t<Yt.length;t+=1)Yt[t].c();Nt=Object(c.db)(),Pt=Object(c.A)("div"),Lt=Object(c.A)("button"),Lt.textContent="⬇ Download parsed subtitles",Mt=Object(c.db)(),Et=Object(c.A)("div"),Tt=Object(c.A)("button"),Tt.textContent="⬇ Download currently visible parsed subtitles",It=Object(c.db)(),Ht=Object(c.A)("div"),Ht.innerHTML='<a target="_blank" href="https://github.com/sheodox/jimaku-player/issues" rel="noopener noreferrer" class="svelte-h7adv">Issue? Report it here!</a>',n.disabled=r="recent"===t[3],o.disabled=a="setup"===t[3],u.disabled=f="settings"===t[3],Object(c.i)(e,"class","tray-tab-buttons svelte-h7adv"),Object(c.i)(p,"class","svelte-h7adv"),Object(c.i)(g,"class","recent-subs svelte-h7adv"),Object(c.i)(O,"class","tab tab-recent svelte-h7adv"),Object(c.ib)(O,"tab-active","recent"===t[3]),Object(c.i)(x,"class","svelte-h7adv"),Object(c.i)(w,"class","secondary"),Object(c.i)(k,"class","row svelte-h7adv"),Object(c.i)(A,"class","svelte-h7adv"),Object(c.i)(C,"class","row svelte-h7adv"),Object(c.i)(E,"class","secondary"),Object(c.i)(I,"class","secondary"),Object(c.i)(M,"class","row svelte-h7adv"),Object(c.i)(q,"class","svelte-h7adv"),Object(c.i)(v,"class","tab svelte-h7adv"),Object(c.ib)(v,"tab-active","setup"===t[3]),Object(c.i)(Z,"class","svelte-h7adv"),Object(c.i)(et,"for","subtitle-color"),Object(c.i)(ct,"type","color"),Object(c.i)(ct,"id","subtitle-color"),Object(c.i)(tt,"class","row svelte-h7adv"),Object(c.i)(it,"id","show-subs"),Object(c.i)(it,"type","checkbox"),Object(c.i)(lt,"for","show-subs"),Object(c.i)(rt,"class","row svelte-h7adv"),Object(c.i)(ut,"id","pause-on-tray"),Object(c.i)(ut,"type","checkbox"),Object(c.i)(ft,"for","pause-on-tray"),Object(c.i)(bt,"class","row svelte-h7adv"),Object(c.i)(pt,"id","invert-subtitle-alignment"),Object(c.i)(pt,"type","checkbox"),Object(c.i)(gt,"for","invert-subtitle-alignment"),Object(c.i)(Ot,"class","row svelte-h7adv"),Object(c.i)(vt,"class","svelte-h7adv"),Object(c.i)(kt,"class","svelte-h7adv"),Object(c.i)(wt,"class","svelte-h7adv"),Object(c.i)(At,"class","svelte-h7adv"),Object(c.i)(St,"class","svelte-h7adv"),Object(c.i)(Pt,"class","row svelte-h7adv"),Object(c.i)(Et,"class","row svelte-h7adv"),Object(c.i)(Ht,"class","row svelte-h7adv"),Object(c.i)(U,"class","tab tab-settings svelte-h7adv"),Object(c.ib)(U,"tab-active","settings"===t[3])},m(r,a){Object(c.J)(r,e,a),Object(c.g)(e,n),Object(c.g)(n,s),Object(c.g)(e,i),Object(c.g)(e,o),Object(c.g)(o,l),Object(c.g)(e,b),Object(c.g)(e,u),Object(c.g)(u,d),Object(c.J)(r,j,a),Object(c.J)(r,O,a),Object(c.g)(O,p),Object(c.g)(O,h),Object(c.g)(O,g);for(let t=0;t<Rt.length;t+=1)Rt[t].m(g,null);Object(c.J)(r,m,a),Object(c.J)(r,v,a),Object(c.g)(v,x),Object(c.g)(v,y),Object(c.g)(v,k),Object(c.g)(k,w),Object(c.g)(v,$),Object(c.g)(v,A),Object(c.g)(v,S),Object(c.g)(v,C),Object(c.g)(C,z),Object(c.g)(z,_),Object(c.g)(z,J),Object(c.g)(z,N),Object(c.g)(z,P),Object(c.g)(v,L),Object(c.g)(v,M),Object(c.g)(M,E),Object(c.g)(M,T),Object(c.g)(M,I),Object(c.g)(v,H),Object(c.g)(v,q),Object(c.g)(v,G),Kt&&Kt.m(v,null),Object(c.g)(v,W),Object(c.N)(D,v,null),Object(c.J)(r,Y,a),Object(c.J)(r,U,a),Object(c.g)(U,Z),Object(c.g)(U,Q),Object(c.g)(U,tt),Object(c.g)(tt,et),Object(c.g)(tt,nt),Object(c.g)(tt,ct),Object(c.bb)(ct,t[10]),Object(c.g)(U,st),Object(c.g)(U,rt),Object(c.g)(rt,it),it.checked=t[11],Object(c.g)(rt,ot),Object(c.g)(rt,lt),Object(c.g)(U,at),Object(c.g)(U,bt),Object(c.g)(bt,ut),ut.checked=t[9],Object(c.g)(bt,dt),Object(c.g)(bt,ft),Object(c.g)(U,jt),Object(c.g)(U,Ot),Object(c.g)(Ot,pt),pt.checked=t[12],Object(c.g)(Ot,ht),Object(c.g)(Ot,gt),Object(c.g)(U,mt),Object(c.g)(U,vt),Object(c.g)(U,xt),Object(c.g)(U,yt),Object(c.g)(yt,kt),Object(c.g)(yt,wt),Object(c.g)(wt,$t),Object(c.g)(yt,At),Object(c.g)(yt,St),Object(c.g)(St,Ct),Object(c.g)(St,zt),Object(c.g)(St,_t),Object(c.g)(St,Jt);for(let t=0;t<Yt.length;t+=1)Yt[t].m(yt,null);Object(c.g)(U,Nt),Object(c.g)(U,Pt),Object(c.g)(Pt,Lt),Object(c.g)(U,Mt),Object(c.g)(U,Et),Object(c.g)(Et,Tt),Object(c.g)(U,It),Object(c.g)(U,Ht),qt=!0,Bt||(Gt=[Object(c.L)(n,"click",t[20]),Object(c.L)(o,"click",t[21]),Object(c.L)(u,"click",t[22]),Object(c.L)(w,"click",t[24]),Object(c.L)(E,"click",t[25]),Object(c.L)(I,"click",t[26]),Object(c.L)(ct,"input",t[27]),Object(c.L)(it,"change",t[28]),Object(c.L)(ut,"change",t[29]),Object(c.L)(pt,"change",t[30]),Object(c.L)(Lt,"click",t[31]),Object(c.L)(Tt,"click",t[32])],Bt=!0)},p(t,e){if((!qt||8&e[0]&&r!==(r="recent"===t[3]))&&(n.disabled=r),(!qt||8&e[0]&&a!==(a="setup"===t[3]))&&(o.disabled=a),(!qt||8&e[0]&&f!==(f="settings"===t[3]))&&(u.disabled=f),278529&e[0]){const n=t[0];Object(c.G)();for(let t=0;t<Rt.length;t+=1)Rt[t].r();Rt=Object(c.lb)(Rt,e,Vt,1,t,n,Ft,g,c.C,V,null,F);for(let t=0;t<Rt.length;t+=1)Rt[t].a();Object(c.m)()}if(8&e[0]&&Object(c.ib)(O,"tab-active","recent"===t[3]),(!qt||128&e[0])&&Object(c.ab)(_,t[7]),(!qt||256&e[0])&&Object(c.ab)(N,t[8]),t[9]?Kt?Kt.p(t,e):(Kt=K(t),Kt.c(),Kt.m(v,W)):Kt&&(Kt.d(1),Kt=null),8&e[0]&&Object(c.ib)(v,"tab-active","setup"===t[3]),1024&e[0]&&Object(c.bb)(ct,t[10]),2048&e[0]&&(it.checked=t[11]),512&e[0]&&(ut.checked=t[9]),4096&e[0]&&(pt.checked=t[12]),(!qt||2&e[0])&&Wt!==(Wt=t[1].fileName+"")&&Object(c.ab)($t,Wt),(!qt||128&e[0])&&Object(c.ab)(Ct,t[7]),(!qt||256&e[0])&&Object(c.ab)(_t,t[8]),2&e[0]){let n;for(Xt=t[1].debugInfo(),n=0;n<Xt.length;n+=1){const c=R(t,Xt,n);Yt[n]?Yt[n].p(c,e):(Yt[n]=X(c),Yt[n].c(),Yt[n].m(yt,null))}for(;n<Yt.length;n+=1)Yt[n].d(1);Yt.length=Xt.length}8&e[0]&&Object(c.ib)(U,"tab-active","settings"===t[3])},i(t){if(!qt){for(let t=0;t<Dt.length;t+=1)Object(c.jb)(Rt[t]);Object(c.jb)(D.$$.fragment,t),qt=!0}},o(t){for(let t=0;t<Rt.length;t+=1)Object(c.kb)(Rt[t]);Object(c.kb)(D.$$.fragment,t),qt=!1},d(t){t&&Object(c.z)(e),t&&Object(c.z)(j),t&&Object(c.z)(O);for(let t=0;t<Rt.length;t+=1)Rt[t].d();t&&Object(c.z)(m),t&&Object(c.z)(v),Kt&&Kt.d(),Object(c.x)(D),t&&Object(c.z)(Y),t&&Object(c.z)(U),Object(c.y)(Yt,t),Bt=!1,Object(c.W)(Gt)}}}function D(t){let e,n,s,r,i,o,l;return{c(){e=Object(c.A)("div"),n=Object(c.A)("div"),s=Object(c.A)("button"),s.textContent="Select Subtitles",r=Object(c.db)(),i=Object(c.A)("div"),i.innerHTML='<a target="_blank" href="https://github.com/sheodox/jimaku-player/issues" rel="noopener noreferrer" class="svelte-h7adv">Issue? Report it here!</a>',Object(c.i)(n,"class","row svelte-h7adv"),Object(c.i)(i,"class","row svelte-h7adv"),Object(c.i)(e,"class","tab tab-active tab-cancelled svelte-h7adv")},m(a,b){Object(c.J)(a,e,b),Object(c.g)(e,n),Object(c.g)(n,s),Object(c.g)(e,r),Object(c.g)(e,i),o||(l=Object(c.L)(s,"click",t[19]),o=!0)},p:c.O,i:c.O,o:c.O,d(t){t&&Object(c.z)(e),o=!1,l()}}}function V(t,e){let n,s,r,i,l,b,u,d,f,j,O,p,h,g=(e[43].text||"").trim()+"",m=c.O;return{key:t,first:null,c(){n=Object(c.A)("li"),s=Object(c.A)("button"),s.innerHTML='⯇<span class="sr">Rewind to this subtitle</span>',r=Object(c.db)(),i=Object(c.A)("a"),l=Object(c.hb)(g),u=Object(c.db)(),Object(c.i)(s,"class","small-button secondary"),Object(c.i)(s,"title","Rewind to this subtitle"),Object(c.i)(i,"target","_blank"),Object(c.i)(i,"href",b="https://jisho.org/search/"+encodeURIComponent(e[43].text.trim())),Object(c.i)(i,"rel","noopener noreferrer"),Object(c.i)(i,"class","svelte-h7adv"),Object(c.i)(n,"class","svelte-h7adv"),this.first=n},m(t,o){Object(c.J)(t,n,o),Object(c.g)(n,s),Object(c.g)(n,r),Object(c.g)(n,i),Object(c.g)(i,l),Object(c.g)(n,u),O=!0,p||(h=[Object(c.L)(s,"click",(function(){Object(c.K)(e[18](e[43]))&&e[18](e[43]).apply(this,arguments)})),Object(c.L)(i,"click",e[23])],p=!0)},p(t,n){e=t,(!O||1&n[0])&&g!==(g=(e[43].text||"").trim()+"")&&Object(c.ab)(l,g),(!O||1&n[0]&&b!==(b="https://jisho.org/search/"+encodeURIComponent(e[43].text.trim())))&&Object(c.i)(i,"href",b)},r(){j=n.getBoundingClientRect()},f(){Object(c.D)(n),m(),Object(c.f)(n,j)},a(){m(),m=Object(c.q)(n,j,a,{duration:200})},i(t){O||(Object(c.e)(()=>{f&&f.end(1),d||(d=Object(c.t)(n,o.b,{y:-50,duration:200})),d.start()}),O=!0)},o(t){d&&d.invalidate(),f=Object(c.u)(n,o.b,{y:50,duration:200}),O=!1},d(t){t&&Object(c.z)(n),t&&f&&f.end(),p=!1,Object(c.W)(h)}}}function K(t){let e,n,s;return{c(){e=Object(c.A)("button"),e.textContent="Resume Video",Object(c.i)(e,"id","resume-button"),Object(c.i)(e,"class","secondary svelte-h7adv")},m(t,r){Object(c.J)(t,e,r),n||(s=Object(c.L)(e,"click",Z),n=!0)},p:c.O,d(t){t&&Object(c.z)(e),n=!1,s()}}}function X(t){let e,n,s,r,i=t[40].title+"",o=t[40].detail+"";return{c(){e=Object(c.A)("dt"),n=Object(c.hb)(i),s=Object(c.A)("dd"),r=Object(c.hb)(o),Object(c.i)(e,"class","svelte-h7adv"),Object(c.i)(s,"class","svelte-h7adv")},m(t,i){Object(c.J)(t,e,i),Object(c.g)(e,n),Object(c.J)(t,s,i),Object(c.g)(s,r)},p(t,e){2&e[0]&&i!==(i=t[40].title+"")&&Object(c.ab)(n,i),2&e[0]&&o!==(o=t[40].detail+"")&&Object(c.ab)(r,o)},d(t){t&&Object(c.z)(e),t&&Object(c.z)(s)}}}function Y(t){let e,n;return e=new z({}),e.$on("close",t[33]),{c(){Object(c.s)(e.$$.fragment)},m(t,s){Object(c.N)(e,t,s),n=!0},p:c.O,i(t){n||(Object(c.jb)(e.$$.fragment,t),n=!0)},o(t){Object(c.kb)(e.$$.fragment,t),n=!1},d(t){Object(c.x)(e,t)}}}function U(t){let e,n,s,r,i,o,l,a,b,u,d,f;const j=[D,W],O=[];function p(t,e){return"cancelled"===t[2]?0:"normal"===t[2]?1:-1}~(r=p(t))&&(i=O[r]=j[r](t));let h=t[4]&&Y(t);return{c(){e=Object(c.A)("div"),n=Object(c.A)("h1"),n.textContent="字幕プレーヤー",s=Object(c.db)(),i&&i.c(),o=Object(c.db)(),l=Object(c.A)("div"),l.innerHTML='<a target="_blank" href="https://discord.gg/Vyjjyj4" rel="noopener noreferrer" class="svelte-h7adv">Release notes and discussion here on Discord!</a>',a=Object(c.db)(),h&&h.c(),b=Object(c.B)(),Object(c.i)(n,"class","svelte-h7adv"),Object(c.i)(l,"class","row svelte-h7adv"),Object(c.i)(e,"class","tray svelte-h7adv"),Object(c.cb)(e,"right",t[6]+"rem"),Object(c.ib)(e,"inactive",!t[5]),Object(c.ib)(e,"hidden",t[4])},m(i,j){Object(c.J)(i,e,j),Object(c.g)(e,n),Object(c.g)(e,s),~r&&O[r].m(e,null),Object(c.g)(e,o),Object(c.g)(e,l),Object(c.J)(i,a,j),h&&h.m(i,j),Object(c.J)(i,b,j),u=!0,d||(f=[Object(c.L)(e,"mouseenter",t[17](!0)),Object(c.L)(e,"mouseleave",t[17](!1))],d=!0)},p(t,n){let s=r;r=p(t),r===s?~r&&O[r].p(t,n):(i&&(Object(c.G)(),Object(c.kb)(O[s],1,1,()=>{O[s]=null}),Object(c.m)()),~r?(i=O[r],i||(i=O[r]=j[r](t),i.c()),Object(c.jb)(i,1),i.m(e,o)):i=null),(!u||64&n[0])&&Object(c.cb)(e,"right",t[6]+"rem"),32&n[0]&&Object(c.ib)(e,"inactive",!t[5]),16&n[0]&&Object(c.ib)(e,"hidden",t[4]),t[4]?h?(h.p(t,n),16&n[0]&&Object(c.jb)(h,1)):(h=Y(t),h.c(),Object(c.jb)(h,1),h.m(b.parentNode,b)):h&&(Object(c.G)(),Object(c.kb)(h,1,1,()=>{h=null}),Object(c.m)())},i(t){u||(Object(c.jb)(i),Object(c.jb)(h),u=!0)},o(t){Object(c.kb)(i),Object(c.kb)(h),u=!1},d(t){t&&Object(c.z)(e),~r&&O[r].d(),t&&Object(c.z)(a),h&&h.d(t),t&&Object(c.z)(b),d=!1,Object(c.W)(f)}}}function Z(){document.querySelector("video").play()}function Q(t,e,n){let o,a,b,d,f,j,p,h,g,m;Object(c.n)(t,O,t=>n(34,o=t)),Object(c.n)(t,_.b,t=>n(5,a=t)),Object(c.n)(t,$,t=>n(7,d=t)),Object(c.n)(t,w,t=>n(8,f=t)),Object(c.n)(t,i.b,t=>n(9,j=t)),Object(c.n)(t,i.d,t=>n(10,p=t)),Object(c.n)(t,i.c,t=>n(11,h=t)),Object(c.n)(t,i.a,t=>n(12,g=t)),Object(c.n)(t,N,t=>n(13,m=t));const v=Object(s.a)(),x=-26,y=0,k=function(t,e={}){const n=Object(r.d)(t);let s,i=t;function o(r,o){if(null==t)return n.set(t=r),Promise.resolve();i=r;let a=s,b=!1,{delay:d=0,duration:f=400,easing:j=l.c,interpolate:O=u}=Object(c.h)(Object(c.h)({},e),o);if(0===f)return a&&(a.abort(),a=null),n.set(t=i),Promise.resolve();const p=Object(c.P)()+d;let h;return s=Object(c.M)(e=>{if(e<p)return!0;b||(h=O(t,r),"function"==typeof f&&(f=f(t,r)),b=!0),a&&(a.abort(),a=null);const c=e-p;return c>f?(n.set(t=r),!1):(n.set(t=h(j(c/f))),!0)}),s.promise}return{set:o,update:(e,n)=>o(e(i,t),n),subscribe:n.subscribe}}(x,{duration:300,easing:l.b});Object(c.n)(t,k,t=>n(6,b=t));let{recentSubs:A=[]}=e,{subtitles:S={}}=e,{mode:C="normal"}=e,z="recent",J=!1;function P(t){const e=document.createElement("a"),n=new Blob([S.serialize(t)],{type:"application/json"});e.download="parsed-subtitles.json",e.href=URL.createObjectURL(n),document.body.appendChild(e),e.click(),document.body.removeChild(e)}return t.$$set=t=>{"recentSubs"in t&&n(0,A=t.recentSubs),"subtitles"in t&&n(1,S=t.subtitles),"mode"in t&&n(2,C=t.mode)},[A,S,C,z,J,a,b,d,f,j,p,h,g,m,v,k,P,function(t){return()=>{k.set(t?y:x),t&&!Object(r.b)(i.b)||v("tray-pauser",t)}},function(t){document.querySelector("video").currentTime=(t.start+o)/1e3-.5},()=>v("restart"),()=>n(3,z="recent"),()=>n(3,z="setup"),()=>n(3,z="settings"),()=>v("define-pauser"),()=>v("restart"),()=>v("realign"),()=>n(4,J=!0),function(){p=this.value,i.d.set(p)},function(){h=this.checked,i.c.set(h)},function(){j=this.checked,i.b.set(j)},function(){g=this.checked,i.a.set(g)},()=>P(),()=>P(m),()=>n(4,J=!1)]}class tt extends c.b{constructor(t){var e;super(),G.getElementById("svelte-h7adv-style")||((e=Object(c.A)("style")).id="svelte-h7adv-style",e.textContent='.tray.svelte-h7adv.svelte-h7adv{width:28rem;margin-top:0.5rem;background:rgba(255, 255, 255, 0.2);position:fixed;right:0;top:0;color:white;height:calc(100% - 5rem);display:flex;flex-direction:column;text-align:center}.tray.inactive.svelte-h7adv.svelte-h7adv{background:transparent;transition:background 0.2s}.tray.svelte-h7adv>.svelte-h7adv{visibility:hidden}.tray.svelte-h7adv.svelte-h7adv:hover{background:#111218;overflow:auto;border-radius:3px}.tray.svelte-h7adv:hover>.svelte-h7adv{visibility:visible}.tray.svelte-h7adv h1.svelte-h7adv{font-size:2rem;padding:0.5rem 0;border-radius:3px;margin:0}.tray.svelte-h7adv h2.svelte-h7adv{text-decoration:underline;margin:0 0 0.4rem}ul.svelte-h7adv.svelte-h7adv{list-style:none;padding:0;display:flex;flex-direction:column-reverse}a.svelte-h7adv.svelte-h7adv{color:white;transform:scaleY(0);transform-origin:top;transition:transform 0.5s ease;font-family:"Source Han Sans", "源ノ角ゴシック", "Hiragino Sans", "HiraKakuProN-W3", "Hiragino Kaku Gothic ProN W3", "Hiragino Kaku Gothic ProN", "ヒラギノ角ゴ ProN W3", "Noto Sans", "Noto Sans CJK JP", "メイリオ", Meiryo, "游ゴシック", YuGothic, "ＭＳ Ｐゴシック", "MS PGothic", "ＭＳ ゴシック", "MS Gothic", sans-serif}.tab-recent.svelte-h7adv a.svelte-h7adv:not(:hover){text-decoration:none}a.svelte-h7adv.svelte-h7adv:hover{color:#0aff8c;cursor:pointer;text-decoration:underline}li.svelte-h7adv.svelte-h7adv{padding-bottom:0.2rem}li.svelte-h7adv a.svelte-h7adv{white-space:pre}li.svelte-h7adv.svelte-h7adv:not(:first-of-type)::after{content:\' \';height:0;position:relative;border:1px solid #4a4a6a;display:block;margin:0 auto;border-radius:4px}dt.svelte-h7adv.svelte-h7adv{font-weight:bold}dd.svelte-h7adv.svelte-h7adv{font-style:italic}.tab.svelte-h7adv.svelte-h7adv{display:none;text-align:left;padding:2rem;background:#1c1825;border-top:2px solid #f47521}.tab-active.svelte-h7adv.svelte-h7adv{display:block;flex:1}.tray-tab-buttons.svelte-h7adv.svelte-h7adv{margin:0.2rem}.row.svelte-h7adv.svelte-h7adv:not(:last-child){margin-bottom:0.5rem}.tab-cancelled.svelte-h7adv.svelte-h7adv{text-align:center}.hidden.svelte-h7adv.svelte-h7adv{display:none}h3.svelte-h7adv.svelte-h7adv{margin:0}#resume-button.svelte-h7adv.svelte-h7adv{width:100%}kbd.svelte-h7adv.svelte-h7adv{color:white;background:#2f2d2d;border:1px solid #444;border-radius:0.2rem;padding:0 0.2rem;font-family:monospace}.muted.svelte-h7adv.svelte-h7adv{color:#5b5c6f}',Object(c.g)(G.head,e)),Object(c.I)(this,t,Q,U,c.X,{recentSubs:0,subtitles:1,mode:2},[-1,-1])}}var et=tt,nt=n(30),ct=n(18);function st(t,e,n){const c=t.slice();return c[7]=e[n],c}function rt(t){let e,n=t[0].text+"";return{c(){e=Object(c.hb)(n)},m(t,n){Object(c.J)(t,e,n)},p(t,s){1&s&&n!==(n=t[0].text+"")&&Object(c.ab)(e,n)},i:c.O,o:c.O,d(t){t&&Object(c.z)(e)}}}function it(t){let e,n,s=[],r=new Map,i=t[0].phrases;const o=t=>t[7]._id;for(let e=0;e<i.length;e+=1){let n=st(t,i,e),c=o(n);r.set(c,s[e]=ut(c,n))}return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=Object(c.B)()},m(t,r){for(let e=0;e<s.length;e+=1)s[e].m(t,r);Object(c.J)(t,e,r),n=!0},p(t,n){if(1&n){const i=t[0].phrases;Object(c.G)(),s=Object(c.lb)(s,n,o,1,t,i,r,e.parentNode,c.T,ut,e,st),Object(c.m)()}},i(t){if(!n){for(let t=0;t<i.length;t+=1)Object(c.jb)(s[t]);n=!0}},o(t){for(let t=0;t<s.length;t+=1)Object(c.kb)(s[t]);n=!1},d(t){for(let e=0;e<s.length;e+=1)s[e].d(t);t&&Object(c.z)(e)}}}function ot(t){let e,n,s,r,i,o,l=t[7].text+"",a=t[7].html&&at(t);return{c(){e=Object(c.A)("span"),a&&a.c(),n=Object(c.db)(),s=Object(c.hb)(l),r=Object(c.db)(),Object(c.i)(e,"style",i=t[7].inline),Object(c.i)(e,"data-phrase-id",o=t[7]._id)},m(t,i){Object(c.J)(t,e,i),a&&a.m(e,null),Object(c.g)(e,n),Object(c.g)(e,s),Object(c.g)(e,r)},p(t,r){t[7].html?a?a.p(t,r):(a=at(t),a.c(),a.m(e,n)):a&&(a.d(1),a=null),1&r&&l!==(l=t[7].text+"")&&Object(c.ab)(s,l),1&r&&i!==(i=t[7].inline)&&Object(c.i)(e,"style",i),1&r&&o!==(o=t[7]._id)&&Object(c.i)(e,"data-phrase-id",o)},i:c.O,o:c.O,d(t){t&&Object(c.z)(e),a&&a.d()}}}function lt(t){let e,n,s,r,i,l,a,b,u,d=t[7].text+"",f=t[7].html&&bt(t);return{c(){e=Object(c.A)("span"),f&&f.c(),n=Object(c.db)(),s=Object(c.hb)(d),r=Object(c.db)(),Object(c.i)(e,"style",i=t[7].inline),Object(c.i)(e,"data-phrase-id",l=t[7]._id)},m(t,i){Object(c.J)(t,e,i),f&&f.m(e,null),Object(c.g)(e,n),Object(c.g)(e,s),Object(c.g)(e,r),u=!0},p(r,o){(t=r)[7].html?f?f.p(t,o):(f=bt(t),f.c(),f.m(e,n)):f&&(f.d(1),f=null),(!u||1&o)&&d!==(d=t[7].text+"")&&Object(c.ab)(s,d),(!u||1&o&&i!==(i=t[7].inline))&&Object(c.i)(e,"style",i),(!u||1&o&&l!==(l=t[7]._id))&&Object(c.i)(e,"data-phrase-id",l)},i(n){u||(Object(c.e)(()=>{b&&b.end(1),a||(a=Object(c.t)(e,o.a,ft(t[7].fadeIn))),a.start()}),u=!0)},o(n){a&&a.invalidate(),b=Object(c.u)(e,o.a,ft(t[7].fadeOut)),u=!1},d(t){t&&Object(c.z)(e),f&&f.d(),t&&b&&b.end()}}}function at(t){let e,n,s=t[7].html+"";return{c(){n=Object(c.B)(),e=new c.a(n)},m(t,r){e.m(s,t,r),Object(c.J)(t,n,r)},p(t,n){1&n&&s!==(s=t[7].html+"")&&e.p(s)},d(t){t&&Object(c.z)(n),t&&e.d()}}}function bt(t){let e,n,s=t[7].html+"";return{c(){n=Object(c.B)(),e=new c.a(n)},m(t,r){e.m(s,t,r),Object(c.J)(t,n,r)},p(t,n){1&n&&s!==(s=t[7].html+"")&&e.p(s)},d(t){t&&Object(c.z)(n),t&&e.d()}}}function ut(t,e){let n,s,r,i,o;const l=[lt,ot],a=[];function b(t,e){return t[7].fadeIn||t[7].fadeOut?0:1}return s=b(e),r=a[s]=l[s](e),{key:t,first:null,c(){n=Object(c.B)(),r.c(),i=Object(c.B)(),this.first=n},m(t,e){Object(c.J)(t,n,e),a[s].m(t,e),Object(c.J)(t,i,e),o=!0},p(t,e){let n=s;s=b(t),s===n?a[s].p(t,e):(Object(c.G)(),Object(c.kb)(a[n],1,1,()=>{a[n]=null}),Object(c.m)(),r=a[s],r||(r=a[s]=l[s](t),r.c()),Object(c.jb)(r,1),r.m(i.parentNode,i))},i(t){o||(Object(c.jb)(r),o=!0)},o(t){Object(c.kb)(r),o=!1},d(t){t&&Object(c.z)(n),a[s].d(t),t&&Object(c.z)(i)}}}function dt(t){let e,n,s,r,i,o,l,a,b;const u=[it,rt],d=[];function f(t,e){return t[0].phrases?0:1}return n=f(t),s=d[n]=u[n](t),{c(){e=Object(c.A)("p"),s.c(),Object(c.i)(e,"style",r=t[2](t[0])),Object(c.i)(e,"data-sub-style",i=t[0].style),Object(c.i)(e,"data-sub-id",o=t[0]._id),Object(c.i)(e,"title","click to search this phrase on Jisho.org"),Object(c.i)(e,"class","svelte-y2gmuc"),Object(c.ib)(e,"has-movement",!!t[0].movement)},m(s,r){Object(c.J)(s,e,r),d[n].m(e,null),l=!0,a||(b=Object(c.L)(e,"click",t[4]),a=!0)},p(t,[a]){let b=n;n=f(t),n===b?d[n].p(t,a):(Object(c.G)(),Object(c.kb)(d[b],1,1,()=>{d[b]=null}),Object(c.m)(),s=d[n],s||(s=d[n]=u[n](t),s.c()),Object(c.jb)(s,1),s.m(e,null)),(!l||1&a&&r!==(r=t[2](t[0])))&&Object(c.i)(e,"style",r),(!l||1&a&&i!==(i=t[0].style))&&Object(c.i)(e,"data-sub-style",i),(!l||1&a&&o!==(o=t[0]._id))&&Object(c.i)(e,"data-sub-id",o),1&a&&Object(c.ib)(e,"has-movement",!!t[0].movement)},i(t){l||(Object(c.jb)(s),l=!0)},o(t){Object(c.kb)(s),l=!1},d(t){t&&Object(c.z)(e),d[n].d(),a=!1,b()}}}function ft(t){return"number"!=typeof t&&(t=0),{delay:0,duration:t}}function jt(t,e,n){let r;Object(c.n)(t,i.d,t=>n(5,r=t));const o=Object(s.a)();let{sub:l}=e,{styles:a}=e;function b(t){o("define-pauser"),window.open("https://jisho.org/search/"+encodeURIComponent(t.trim()))}return t.$$set=t=>{"sub"in t&&n(0,l=t.sub),"styles"in t&&n(3,a=t.styles)},[l,b,function(t){let e=["color: "+r];const n=a[t.style];if(e.push(n.inline),e=e.concat([t.inline||""]),t.movement){const n=t.movement.timings,c=t.movement.timings.length>0,s=c?n[1]-n[0]:t.end-t.start,r=c?n[0]:0;e=e.concat([`--move-duration: ${s}ms`,`--move-delay: ${r}ms`,"--move-from-top: "+t.movement.y1,"--move-from-left: "+t.movement.x1,"--move-to-top: "+t.movement.y2,"--move-to-left: "+t.movement.x2])}return Object(ct.a)(e)},a,()=>b(l.text)]}class Ot extends c.b{constructor(t){var e;super(),document.getElementById("svelte-y2gmuc-style")||((e=Object(c.A)("style")).id="svelte-y2gmuc-style",e.textContent='p.svelte-y2gmuc{cursor:pointer;color:white;margin:0;padding:0;white-space:pre-wrap;font-family:"Source Han Sans", "源ノ角ゴシック", "Hiragino Sans", "HiraKakuProN-W3", "Hiragino Kaku Gothic ProN W3", "Hiragino Kaku Gothic ProN", "ヒラギノ角ゴ ProN W3", "Noto Sans", "Noto Sans CJK JP", "メイリオ", Meiryo, "游ゴシック", YuGothic, "ＭＳ Ｐゴシック", "MS PGothic", "ＭＳ ゴシック", "MS Gothic", sans-serif}p.svelte-y2gmuc:hover{color:#0aff8c !important}@keyframes svelte-y2gmuc-movement{from{top:var(--move-from-top);left:var(--move-from-left)}to{top:var(--move-to-top);left:var(--move-to-left)}}.has-movement.svelte-y2gmuc{position:fixed;animation:svelte-y2gmuc-movement var(--move-duration) linear forwards;animation-delay:var(--move-delay)}',Object(c.g)(document.head,e)),Object(c.I)(this,t,jt,dt,c.X,{sub:0,styles:3})}}var pt=Ot;function ht(t,e,n){const c=t.slice();return c[15]=e[n],c}function gt(t,e,n){const c=t.slice();return c[12]=e[n],c}function mt(t,e,n){const c=t.slice();return c[15]=e[n],c}function vt(t,e,n){const c=t.slice();return c[9]=e[n],c}function xt(t,e){let n,s,r;return s=new pt({props:{sub:e[15],styles:e[0]}}),s.$on("define-pauser",e[5]),{key:t,first:null,c(){n=Object(c.B)(),Object(c.s)(s.$$.fragment),this.first=n},m(t,e){Object(c.J)(t,n,e),Object(c.N)(s,t,e),r=!0},p(t,e){const n={};2&e&&(n.sub=t[15]),1&e&&(n.styles=t[0]),s.$set(n)},i(t){r||(Object(c.jb)(s.$$.fragment,t),r=!0)},o(t){Object(c.kb)(s.$$.fragment,t),r=!1},d(t){t&&Object(c.z)(n),Object(c.x)(s,t)}}}function yt(t){let e,n,s,r=[],i=new Map,o=t[9]["an"+t[12]];const l=t=>t[15]._id;for(let e=0;e<o.length;e+=1){let n=ht(t,o,e),c=l(n);i.set(c,r[e]=kt(c,n))}return{c(){e=Object(c.A)("div");for(let t=0;t<r.length;t+=1)r[t].c();Object(c.i)(e,"class",n="an an"+t[12]+" svelte-1693w3q")},m(t,n){Object(c.J)(t,e,n);for(let t=0;t<r.length;t+=1)r[t].m(e,null);s=!0},p(t,n){if(7&n){const s=t[9]["an"+t[12]];Object(c.G)(),r=Object(c.lb)(r,n,l,1,t,s,i,e,c.T,kt,null,ht),Object(c.m)()}},i(t){if(!s){for(let t=0;t<o.length;t+=1)Object(c.jb)(r[t]);s=!0}},o(t){for(let t=0;t<r.length;t+=1)Object(c.kb)(r[t]);s=!1},d(t){t&&Object(c.z)(e);for(let t=0;t<r.length;t+=1)r[t].d()}}}function kt(t,e){let n,s,r;return s=new pt({props:{sub:e[15],styles:e[0]}}),s.$on("define-pauser",e[6]),{key:t,first:null,c(){n=Object(c.B)(),Object(c.s)(s.$$.fragment),this.first=n},m(t,e){Object(c.J)(t,n,e),Object(c.N)(s,t,e),r=!0},p(t,e){const n={};2&e&&(n.sub=t[15]),1&e&&(n.styles=t[0]),s.$set(n)},i(t){r||(Object(c.jb)(s.$$.fragment,t),r=!0)},o(t){Object(c.kb)(s.$$.fragment,t),r=!1},d(t){t&&Object(c.z)(n),Object(c.x)(s,t)}}}function wt(t,e){let n,s,r,i=e[9]["an"+e[12]].length&&yt(e);return{key:t,first:null,c(){n=Object(c.B)(),i&&i.c(),s=Object(c.B)(),this.first=n},m(t,e){Object(c.J)(t,n,e),i&&i.m(t,e),Object(c.J)(t,s,e),r=!0},p(t,e){t[9]["an"+t[12]].length?i?(i.p(t,e),2&e&&Object(c.jb)(i,1)):(i=yt(t),i.c(),Object(c.jb)(i,1),i.m(s.parentNode,s)):i&&(Object(c.G)(),Object(c.kb)(i,1,1,()=>{i=null}),Object(c.m)())},i(t){r||(Object(c.jb)(i),r=!0)},o(t){Object(c.kb)(i),r=!1},d(t){t&&Object(c.z)(n),i&&i.d(t),t&&Object(c.z)(s)}}}function $t(t,e){let n,s,r,i,o,l=[],a=new Map,b=[],u=new Map,d=e[9].positioned;const f=t=>t[15]._id;for(let t=0;t<d.length;t+=1){let n=mt(e,d,t),c=f(n);a.set(c,l[t]=xt(c,n))}let j=e[2];const O=t=>t[12];for(let t=0;t<j.length;t+=1){let n=gt(e,j,t),c=O(n);u.set(c,b[t]=wt(c,n))}return{key:t,first:null,c(){n=Object(c.A)("div");for(let t=0;t<l.length;t+=1)l[t].c();s=Object(c.db)();for(let t=0;t<b.length;t+=1)b[t].c();r=Object(c.db)(),Object(c.i)(n,"data-ass-layer",i=e[9].level),Object(c.cb)(n,"position","absolute"),Object(c.cb)(n,"z-index",e[9].level),this.first=n},m(t,e){Object(c.J)(t,n,e);for(let t=0;t<l.length;t+=1)l[t].m(n,null);Object(c.g)(n,s);for(let t=0;t<b.length;t+=1)b[t].m(n,null);Object(c.g)(n,r),o=!0},p(t,e){if(3&e){const r=t[9].positioned;Object(c.G)(),l=Object(c.lb)(l,e,f,1,t,r,a,n,c.T,xt,s,mt),Object(c.m)()}if(7&e){const s=t[2];Object(c.G)(),b=Object(c.lb)(b,e,O,1,t,s,u,n,c.T,wt,r,gt),Object(c.m)()}(!o||2&e&&i!==(i=t[9].level))&&Object(c.i)(n,"data-ass-layer",i),(!o||2&e)&&Object(c.cb)(n,"z-index",t[9].level)},i(t){if(!o){for(let t=0;t<d.length;t+=1)Object(c.jb)(l[t]);for(let t=0;t<j.length;t+=1)Object(c.jb)(b[t]);o=!0}},o(t){for(let t=0;t<l.length;t+=1)Object(c.kb)(l[t]);for(let t=0;t<b.length;t+=1)Object(c.kb)(b[t]);o=!1},d(t){t&&Object(c.z)(n);for(let t=0;t<l.length;t+=1)l[t].d();for(let t=0;t<b.length;t+=1)b[t].d()}}}function At(t){let e,n,s=[],r=new Map,i=t[1];const o=t=>t[9].level;for(let e=0;e<i.length;e+=1){let n=vt(t,i,e),c=o(n);r.set(c,s[e]=$t(c,n))}return{c(){e=Object(c.A)("div");for(let t=0;t<s.length;t+=1)s[t].c();Object(c.i)(e,"class","subtitles")},m(t,r){Object(c.J)(t,e,r);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,[n]){if(7&n){const i=t[1];Object(c.G)(),s=Object(c.lb)(s,n,o,1,t,i,r,e,c.T,$t,null,vt),Object(c.m)()}},i(t){if(!n){for(let t=0;t<i.length;t+=1)Object(c.jb)(s[t]);n=!0}},o(t){for(let t=0;t<s.length;t+=1)Object(c.kb)(s[t]);n=!1},d(t){t&&Object(c.z)(e);for(let t=0;t<s.length;t+=1)s[t].d()}}}function St(t,e,n){let s,o;Object(c.n)(t,i.a,t=>n(7,s=t));let{subtitles:l}=e,{styles:a={}}=e;const b={1:7,2:8,3:9,4:4,5:5,6:6,7:1,8:2,9:3},u=Object(r.a)(l,t=>{const e={};for(const n of t){const t="positioned"===n.mountPoint?n.mountPoint:"an"+(s?b[n.mountPoint]:n.mountPoint);e[n.layer]||(e[n.layer]={level:n.layer,positioned:[],an1:[],an2:[],an3:[],an4:[],an5:[],an6:[],an7:[],an8:[],an9:[]}),e[n.layer][t].push(n)}return Object.values(e)});return Object(c.n)(t,u,t=>n(1,o=t)),t.$$set=t=>{"subtitles"in t&&n(4,l=t.subtitles),"styles"in t&&n(0,a=t.styles)},[a,o,[1,2,3,4,5,6,7,8,9],u,l,function(e){Object(c.l)(t,e)},function(e){Object(c.l)(t,e)}]}class Ct extends c.b{constructor(t){var e;super(),document.getElementById("svelte-1693w3q-style")||((e=Object(c.A)("style")).id="svelte-1693w3q-style",e.textContent=".an.svelte-1693w3q{position:fixed;width:100%;max-width:100vw;display:flex;flex-direction:column;padding:0.8rem}.an1.svelte-1693w3q{top:100vh;left:0;transform:translate(0, -100%)}.an2.svelte-1693w3q{top:100vh;left:50vw;transform:translate(-50%, -100%)}.an3.svelte-1693w3q{top:100vh;left:100vw;transform:translate(-100%, -100%)}.an4.svelte-1693w3q{top:50vh;left:0;transform:translate(0, -50%)}.an5.svelte-1693w3q{top:50vh;left:50vw;transform:translate(-50%, -50%)}.an6.svelte-1693w3q{top:50vh;left:100vw;transform:translate(-100%, -50%)}.an7.svelte-1693w3q{top:0;left:0;transform:translate(0, 0)}.an8.svelte-1693w3q{top:0;left:50vw;transform:translate(-50%, 0)}.an9.svelte-1693w3q{top:0;left:100vw;transform:translate(-100%, 0)}.an1.svelte-1693w3q,.an4.svelte-1693w3q,.an7.svelte-1693w3q{text-align:left}.an2.svelte-1693w3q,.an5.svelte-1693w3q,.an8.svelte-1693w3q{text-align:center}.an3.svelte-1693w3q,.an6.svelte-1693w3q,.an9.svelte-1693w3q{text-align:right}.an1.svelte-1693w3q,.an2.svelte-1693w3q,.an3.svelte-1693w3q{flex-direction:column-reverse}",Object(c.g)(document.head,e)),Object(c.I)(this,t,St,At,c.X,{subtitles:4,styles:0})}}var zt=Ct;class _t{constructor(){this.video=null,this.reasons=[]}setVideo(t){this.reasons=[],this.video=t}addPauser(t){this.reasons.includes("user-paused")&&!this.video.paused&&this.reasons.splice(this.reasons.indexOf("user-paused")),0===this.reasons.length&&this.video.paused&&this.reasons.push("user-paused"),this.reasons.includes(t)||this.reasons.push(t),this._checkPause()}removePauser(t){const e=this.reasons.indexOf(t);-1!==e&&(this.reasons.splice(e,1),this._checkPause())}_checkPause(){this.reasons.length?this.video.pause():this.video.play()}}var Jt=n(32),Nt=n(14);function Pt(t,e,n){const c=t.slice();return c[6]=e[n],c}function Lt(t){let e,n,s,r,i,o,l,a=t[6].title+"",b=t[6].language+"";function u(...e){return t[3](t[6],...e)}return{c(){e=Object(c.A)("button"),n=Object(c.hb)(a),s=Object(c.hb)(" ("),r=Object(c.hb)(b),i=Object(c.hb)(")\n\t\t"),Object(c.i)(e,"class","secondary svelte-1n5tabm")},m(t,a){Object(c.J)(t,e,a),Object(c.g)(e,n),Object(c.g)(e,s),Object(c.g)(e,r),Object(c.g)(e,i),o||(l=Object(c.L)(e,"click",u),o=!0)},p(e,n){t=e},d(t){t&&Object(c.z)(e),o=!1,l()}}}function Mt(t){let e,n,s,r,i,o,l,a,b,u=window.jimakuProvidedSubtitles||[],d=[];for(let e=0;e<u.length;e+=1)d[e]=Lt(Pt(t,u,e));return{c(){e=Object(c.A)("div"),n=Object(c.A)("button"),n.textContent="⨯ Skip Subtitling For This Episode",s=Object(c.db)(),r=Object(c.A)("label"),r.textContent="≡ Select a subtitle file to begin",i=Object(c.db)(),o=Object(c.A)("input"),l=Object(c.db)();for(let t=0;t<d.length;t+=1)d[t].c();Object(c.i)(n,"class","small-button secondary svelte-1n5tabm"),Object(c.i)(r,"for","srt-upload"),Object(c.i)(r,"class","svelte-1n5tabm"),Object(c.i)(o,"type","file"),Object(c.i)(o,"id","srt-upload"),Object(c.i)(o,"accept",".srt,.ass,.ssa,.vtt"),Object(c.i)(o,"class","svelte-1n5tabm"),Object(c.i)(e,"class","column svelte-1n5tabm")},m(u,f){Object(c.J)(u,e,f),Object(c.g)(e,n),Object(c.g)(e,s),Object(c.g)(e,r),Object(c.g)(e,i),Object(c.g)(e,o),Object(c.g)(e,l);for(let t=0;t<d.length;t+=1)d[t].m(e,null);a||(b=[Object(c.L)(n,"click",t[2]),Object(c.L)(o,"change",t[0])],a=!0)},p(t,[n]){if(2&n){let c;for(u=window.jimakuProvidedSubtitles||[],c=0;c<u.length;c+=1){const s=Pt(t,u,c);d[c]?d[c].p(s,n):(d[c]=Lt(s),d[c].c(),d[c].m(e,null))}for(;c<d.length;c+=1)d[c].d(1);d.length=u.length}},i:c.O,o:c.O,d(t){t&&Object(c.z)(e),Object(c.y)(d,t),a=!1,Object(c.W)(b)}}}function Et(t){const e=Object(s.a)();function n(t){c(t.format,t.content,t.title,!0)}function c(t,n,c,s=!1){const r={ass:Jt.ASS,ssa:Jt.ASS,srt:Nt.a,vtt:Nt.a};e("subtitles-loaded",{skipAlignment:s,subtitles:new r[t](n,c)})}return[function(t){const e=t.target.files[0],n=new FileReader;n.onload=t=>{const[n,s]=e.name.match(/\.(\w{3})$/);c(s,t.target.result,e.name)},n.readAsText(e)},n,function(){e("cancel")},t=>n(t)]}class Tt extends c.b{constructor(t){var e;super(),document.getElementById("svelte-1n5tabm-style")||((e=Object(c.A)("style")).id="svelte-1n5tabm-style",e.textContent=".column.svelte-1n5tabm.svelte-1n5tabm{display:flex;flex-direction:column}.column.svelte-1n5tabm>.svelte-1n5tabm{align-self:center;margin:0.5rem}label.svelte-1n5tabm.svelte-1n5tabm{background:#fd0;border:none;cursor:pointer;padding:10px;line-height:1;font-weight:bold;color:black;text-transform:uppercase;display:inline-block;font-size:1.2rem}label.svelte-1n5tabm.svelte-1n5tabm:hover{background:#ffea6d}input.svelte-1n5tabm.svelte-1n5tabm{display:none}",Object(c.g)(document.head,e)),Object(c.I)(this,t,Et,Mt,c.X,{})}}var It=Tt;const{document:Ht}=c.F;function qt(t,e,n){const c=t.slice();return c[29]=e[n],c}function Bt(t,e,n){const c=t.slice();return c[26]=e[n],c}function Gt(t){let e;return{c(){e=Object(c.hb)("← Back")},m(t,n){Object(c.J)(t,e,n)},d(t){t&&Object(c.z)(e)}}}function Rt(t){let e;return{c(){e=Object(c.hb)("↺ Reselect Subtitles")},m(t,n){Object(c.J)(t,e,n)},d(t){t&&Object(c.z)(e)}}}function Ft(t){let e,n,s,r,i,o,l,a,b,u,d,f,j;return{c(){e=Object(c.A)("div"),n=Object(c.A)("form"),s=Object(c.A)("label"),s.textContent="Offset subtitle display times (in seconds):",r=Object(c.db)(),i=Object(c.A)("div"),o=Object(c.A)("input"),a=Object(c.db)(),b=Object(c.A)("button"),b.textContent="Use this",u=Object(c.db)(),d=Object(c.A)("p"),d.textContent="Positive numbers will delay subtitles.\n\t\t\t\t\tNegative numbers will show the subtitles earlier.",Object(c.i)(s,"for","manual-alignment"),Object(c.i)(s,"class","svelte-xgf48k"),Object(c.i)(o,"type","text"),Object(c.i)(o,"id","manual-alignment"),Object(c.i)(o,"autocomplete","off"),Object(c.i)(o,"class","svelte-xgf48k"),Object(c.i)(b,"class","svelte-xgf48k"),Object(c.i)(i,"class","row svelte-xgf48k"),Object(c.i)(n,"class","column svelte-xgf48k"),Object(c.i)(d,"class","alignment-sign-hint svelte-xgf48k"),Object(c.i)(e,"class","column svelte-xgf48k")},m(O,p){Object(c.J)(O,e,p),Object(c.g)(e,n),Object(c.g)(n,s),Object(c.g)(n,r),Object(c.g)(n,i),Object(c.g)(i,o),Object(c.bb)(o,t[1]),Object(c.g)(i,a),Object(c.g)(i,b),Object(c.g)(e,u),Object(c.g)(e,d),f||(j=[Object(c.L)(o,"input",t[23]),Object(c.L)(o,"keydown",t[10]),Object(c.c)(l=ne.call(null,o)),Object(c.L)(n,"submit",Object(c.U)(t[11]))],f=!0)},p(t,e){2&e[0]&&o.value!==t[1]&&Object(c.bb)(o,t[1])},i:c.O,o:c.O,d(t){t&&Object(c.z)(e),f=!1,Object(c.W)(j)}}}function Wt(t){let e,n,s,r,i,o,l,a,b,u,d,f,j,O,p,h=0===t[0].length&&Vt(t),g=t[0],m=[];for(let e=0;e<g.length;e+=1)m[e]=Ut(Bt(t,g,e));return{c(){e=Object(c.A)("label"),n=Object(c.hb)("Can't find a line? Search all subtitles:\n\t\t\t\t"),s=Object(c.A)("br"),r=Object(c.db)(),i=Object(c.A)("input"),o=Object(c.db)(),l=Object(c.A)("fieldset"),a=Object(c.A)("legend"),a.textContent="Click a subtitle as soon as you hear it said",b=Object(c.db)(),u=Object(c.A)("div"),h&&h.c(),d=Object(c.db)();for(let t=0;t<m.length;t+=1)m[t].c();f=Object(c.db)(),j=Object(c.A)("button"),j.textContent="Or manually enter an offset...",Object(c.i)(i,"type","text"),Object(c.i)(i,"placeholder","type something you heard"),Object(c.i)(i,"class","svelte-xgf48k"),Object(c.i)(e,"id","subtitle-search"),Object(c.i)(e,"class","svelte-xgf48k"),Object(c.i)(a,"class","svelte-xgf48k"),Object(c.i)(u,"id","subtitle-options"),Object(c.i)(u,"class","column svelte-xgf48k"),Object(c.i)(l,"class","svelte-xgf48k"),Object(c.i)(j,"class","secondary svelte-xgf48k")},m(g,v){Object(c.J)(g,e,v),Object(c.g)(e,n),Object(c.g)(e,s),Object(c.g)(e,r),Object(c.g)(e,i),Object(c.bb)(i,t[3]),Object(c.J)(g,o,v),Object(c.J)(g,l,v),Object(c.g)(l,a),Object(c.g)(l,b),Object(c.g)(l,u),h&&h.m(u,null),Object(c.g)(u,d);for(let t=0;t<m.length;t+=1)m[t].m(u,null);Object(c.J)(g,f,v),Object(c.J)(g,j,v),O||(p=[Object(c.L)(i,"input",t[19]),Object(c.L)(j,"click",t[22])],O=!0)},p(t,e){if(8&e[0]&&i.value!==t[3]&&Object(c.bb)(i,t[3]),0===t[0].length?h?h.p(t,e):(h=Vt(t),h.c(),h.m(u,d)):h&&(h.d(1),h=null),8193&e[0]){let n;for(g=t[0],n=0;n<g.length;n+=1){const c=Bt(t,g,n);m[n]?m[n].p(c,e):(m[n]=Ut(c),m[n].c(),m[n].m(u,null))}for(;n<m.length;n+=1)m[n].d(1);m.length=g.length}},i:c.O,o:c.O,d(t){t&&Object(c.z)(e),t&&Object(c.z)(o),t&&Object(c.z)(l),h&&h.d(),Object(c.y)(m,t),t&&Object(c.z)(f),t&&Object(c.z)(j),O=!1,Object(c.W)(p)}}}function Dt(t){let e,n,s,r,i,o,l;function a(t,e){return t[4]?Qt:Zt}let b=a(t),u=b(t),d=t[6].length&&te(t);return{c(){u.c(),e=Object(c.db)(),n=Object(c.A)("button"),n.textContent="Choose a different alignment...",s=Object(c.db)(),d&&d.c(),r=Object(c.B)(),Object(c.i)(n,"class","secondary svelte-xgf48k")},m(a,b){u.m(a,b),Object(c.J)(a,e,b),Object(c.J)(a,n,b),Object(c.J)(a,s,b),d&&d.m(a,b),Object(c.J)(a,r,b),i=!0,o||(l=Object(c.L)(n,"click",t[18]),o=!0)},p(t,n){b===(b=a(t))&&u?u.p(t,n):(u.d(1),u=b(t),u&&(u.c(),u.m(e.parentNode,e))),t[6].length?d?(d.p(t,n),64&n[0]&&Object(c.jb)(d,1)):(d=te(t),d.c(),Object(c.jb)(d,1),d.m(r.parentNode,r)):d&&(Object(c.G)(),Object(c.kb)(d,1,1,()=>{d=null}),Object(c.m)())},i(t){i||(Object(c.jb)(d),i=!0)},o(t){Object(c.kb)(d),i=!1},d(t){u.d(t),t&&Object(c.z)(e),t&&Object(c.z)(n),t&&Object(c.z)(s),d&&d.d(t),t&&Object(c.z)(r),o=!1,l()}}}function Vt(t){let e,n,s,r;return{c(){e=Object(c.A)("p"),n=Object(c.hb)('No subtitles matching "'),s=Object(c.hb)(t[3]),r=Object(c.hb)('".'),Object(c.i)(e,"class","svelte-xgf48k")},m(t,i){Object(c.J)(t,e,i),Object(c.g)(e,n),Object(c.g)(e,s),Object(c.g)(e,r)},p(t,e){8&e[0]&&Object(c.ab)(s,t[3])},d(t){t&&Object(c.z)(e)}}}function Kt(t){let e,n,s,r,i,o,l,a,b,u=t[26].offset+"",d=t[26].text.trim()+"";function f(...e){return t[21](t[26],...e)}return{c(){e=Object(c.A)("button"),n=Object(c.hb)("("),s=Object(c.hb)(u),r=Object(c.hb)(")"),i=Object(c.A)("br"),o=Object(c.hb)(d),l=Object(c.db)(),Object(c.i)(e,"class","svelte-xgf48k")},m(t,u){Object(c.J)(t,e,u),Object(c.g)(e,n),Object(c.g)(e,s),Object(c.g)(e,r),Object(c.g)(e,i),Object(c.g)(e,o),Object(c.g)(e,l),a||(b=Object(c.L)(e,"click",f),a=!0)},p(e,n){t=e,1&n[0]&&u!==(u=t[26].offset+"")&&Object(c.ab)(s,u),1&n[0]&&d!==(d=t[26].text.trim()+"")&&Object(c.ab)(o,d)},d(t){t&&Object(c.z)(e),a=!1,b()}}}function Xt(t){let e,n,s,r,i,o,l,a=t[26].sub.text.trim()+"",b=t[26].subsequent,u=[];for(let e=0;e<b.length;e+=1)u[e]=Yt(qt(t,b,e));return{c(){e=Object(c.A)("div"),n=Object(c.A)("fieldset"),s=Object(c.A)("legend"),r=Object(c.hb)(a),i=Object(c.db)(),o=Object(c.A)("div");for(let t=0;t<u.length;t+=1)u[t].c();l=Object(c.db)(),Object(c.i)(s,"class","svelte-xgf48k"),Object(c.i)(o,"class","column svelte-xgf48k"),Object(c.i)(n,"class","svelte-xgf48k"),Object(c.i)(e,"class","search-match svelte-xgf48k")},m(t,a){Object(c.J)(t,e,a),Object(c.g)(e,n),Object(c.g)(n,s),Object(c.g)(s,r),Object(c.g)(n,i),Object(c.g)(n,o);for(let t=0;t<u.length;t+=1)u[t].m(o,null);Object(c.g)(e,l)},p(t,e){if(1&e[0]&&a!==(a=t[26].sub.text.trim()+"")&&Object(c.ab)(r,a),8193&e[0]){let n;for(b=t[26].subsequent,n=0;n<b.length;n+=1){const c=qt(t,b,n);u[n]?u[n].p(c,e):(u[n]=Yt(c),u[n].c(),u[n].m(o,null))}for(;n<u.length;n+=1)u[n].d(1);u.length=b.length}},d(t){t&&Object(c.z)(e),Object(c.y)(u,t)}}}function Yt(t){let e,n,s,r,i,o,l,a,b,u=t[29].offset+"",d=t[29].text.trim()+"";function f(...e){return t[20](t[29],...e)}return{c(){e=Object(c.A)("button"),n=Object(c.hb)("("),s=Object(c.hb)(u),r=Object(c.hb)(")"),i=Object(c.A)("br"),o=Object(c.hb)(d),l=Object(c.db)(),Object(c.i)(e,"class","svelte-xgf48k")},m(t,u){Object(c.J)(t,e,u),Object(c.g)(e,n),Object(c.g)(e,s),Object(c.g)(e,r),Object(c.g)(e,i),Object(c.g)(e,o),Object(c.g)(e,l),a||(b=Object(c.L)(e,"click",f),a=!0)},p(e,n){t=e,1&n[0]&&u!==(u=t[29].offset+"")&&Object(c.ab)(s,u),1&n[0]&&d!==(d=t[29].text.trim()+"")&&Object(c.ab)(o,d)},d(t){t&&Object(c.z)(e),a=!1,b()}}}function Ut(t){let e;function n(t,e){return"search-match"===t[26].type?Xt:Kt}let s=n(t),r=s(t);return{c(){r.c(),e=Object(c.B)()},m(t,n){r.m(t,n),Object(c.J)(t,e,n)},p(t,c){s===(s=n(t))&&r?r.p(t,c):(r.d(1),r=s(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&Object(c.z)(e)}}}function Zt(t){let e,n,s,r,i;return{c(){e=Object(c.A)("p"),e.textContent="You haven't set an alignment for this show before",n=Object(c.db)(),s=Object(c.A)("button"),s.textContent="Assume subtitles are properly timed",Object(c.i)(e,"class","svelte-xgf48k"),Object(c.i)(s,"class","svelte-xgf48k")},m(o,l){Object(c.J)(o,e,l),Object(c.J)(o,n,l),Object(c.J)(o,s,l),r||(i=Object(c.L)(s,"click",t[17]),r=!0)},p:c.O,d(t){t&&Object(c.z)(e),t&&Object(c.z)(n),t&&Object(c.z)(s),r=!1,i()}}}function Qt(t){let e,n,s,r,i,o,l,a,b,u=t[7]&&function(t){let e,n;return{c(){e=Object(c.hb)("for "),n=Object(c.A)("span"),n.textContent=""+t[7],Object(c.i)(n,"class","show-name svelte-xgf48k")},m(t,s){Object(c.J)(t,e,s),Object(c.J)(t,n,s)},p:c.O,d(t){t&&Object(c.z)(e),t&&Object(c.z)(n)}}}(t);return{c(){e=Object(c.A)("button"),n=Object(c.hb)("Use the last alignment\n\t\t\t\t\t\n\t\t\t\t\t"),u&&u.c(),s=Object(c.db)(),r=Object(c.A)("br"),i=Object(c.hb)("\n\t\t\t\t\t("),o=Object(c.hb)(t[5]),l=Object(c.hb)(")"),Object(c.i)(e,"class","svelte-xgf48k")},m(d,f){Object(c.J)(d,e,f),Object(c.g)(e,n),u&&u.m(e,null),Object(c.g)(e,s),Object(c.g)(e,r),Object(c.g)(e,i),Object(c.g)(e,o),Object(c.g)(e,l),a||(b=Object(c.L)(e,"click",t[12]),a=!0)},p(t,e){t[7]&&u.p(t,e),32&e[0]&&Object(c.ab)(o,t[5])},d(t){t&&Object(c.z)(e),u&&u.d(),a=!1,b()}}}function te(t){let e,n,s,r;return s=new B({}),s.$on("aligned",t[15]),{c(){e=Object(c.A)("h2"),e.textContent="Other Recently Used Alignments",n=Object(c.db)(),Object(c.s)(s.$$.fragment),Object(c.i)(e,"class","svelte-xgf48k")},m(t,i){Object(c.J)(t,e,i),Object(c.J)(t,n,i),Object(c.N)(s,t,i),r=!0},p:c.O,i(t){r||(Object(c.jb)(s.$$.fragment,t),r=!0)},o(t){Object(c.kb)(s.$$.fragment,t),r=!1},d(t){t&&Object(c.z)(e),t&&Object(c.z)(n),Object(c.x)(s,t)}}}function ee(t){let e,n,s,r,i,o,l,a,b,u,d;function f(t,e){return t[2]===t[8].entry?Rt:Gt}let j=f(t),O=j(t);const p=[Dt,Wt,Ft],h=[];function g(t,e){return t[2]===t[8].entry?0:t[2]===t[8].automatic?1:t[2]===t[8].manual?2:-1}return~(l=g(t))&&(a=h[l]=p[l](t)),{c(){e=Object(c.A)("div"),n=Object(c.A)("div"),s=Object(c.A)("button"),O.c(),r=Object(c.db)(),i=Object(c.A)("h1"),i.textContent="Alignment Adjustment",o=Object(c.db)(),a&&a.c(),Object(c.i)(s,"class","small-button secondary svelte-xgf48k"),Object(c.i)(i,"class","svelte-xgf48k"),Object(c.i)(n,"class","alignment-panel svelte-xgf48k"),Object(c.i)(e,"class","column svelte-xgf48k")},m(a,f){Object(c.J)(a,e,f),Object(c.g)(e,n),Object(c.g)(n,s),O.m(s,null),Object(c.g)(n,r),Object(c.g)(n,i),Object(c.g)(n,o),~l&&h[l].m(n,null),b=!0,u||(d=Object(c.L)(s,"click",t[9]),u=!0)},p(t,e){j!==(j=f(t))&&(O.d(1),O=j(t),O&&(O.c(),O.m(s,null)));let r=l;l=g(t),l===r?~l&&h[l].p(t,e):(a&&(Object(c.G)(),Object(c.kb)(h[r],1,1,()=>{h[r]=null}),Object(c.m)()),~l?(a=h[l],a||(a=h[l]=p[l](t),a.c()),Object(c.jb)(a,1),a.m(n,null)):a=null)},i(t){b||(Object(c.jb)(a),b=!0)},o(t){Object(c.kb)(a),b=!1},d(t){t&&Object(c.z)(e),O.d(),~l&&h[l].d(),u=!1,d()}}}function ne(t){t.focus(),t.select()}function ce(t,e,n){let i,o,l;Object(c.n)(t,p,t=>n(4,i=t)),Object(c.n)(t,$,t=>n(5,o=t)),Object(c.n)(t,g,t=>n(6,l=t));let{subtitles:a}=e;const b=Object(s.a)(),u=Object(r.b)(m),d={entry:"entry",manual:"manual",automatic:"automatic"};let f=a.getAlignmentCandidates(),j=Object(r.b)(k),h=f[0],x=d.entry,y="";function w(){const t=parseFloat(j);isNaN(t)?alert("Please enter a valid number!"):S(1e3*t)}function A(t){h=t,S()}function S(t){const e=document.querySelector("video"),n="number"==typeof t?t:1e3*e.currentTime-h.start-400;O.set(n),v(n),C()}function C(){b("done")}return t.$$set=t=>{"subtitles"in t&&n(16,a=t.subtitles)},t.$$.update=()=>{65544&t.$$.dirty[0]&&n(0,f=a.getAlignmentCandidates(y))},[f,j,x,y,i,o,l,u,d,function(){x!==d.entry?n(2,x=x===d.automatic?d.entry:d.automatic):b("reselect")},function(t){t.stopPropagation(),"Enter"===t.key&&w()},w,function(){S(Object(r.b)(O))},A,S,C,a,()=>S(0),()=>n(2,x=d.automatic),function(){y=this.value,n(3,y)},t=>A(t),t=>A(t),()=>n(2,x=d.manual),function(){j=this.value,n(1,j)}]}class se extends c.b{constructor(t){var e;super(),Ht.getElementById("svelte-xgf48k-style")||((e=Object(c.A)("style")).id="svelte-xgf48k-style",e.textContent=".column.svelte-xgf48k.svelte-xgf48k{display:flex;flex-direction:column;text-align:center}button.svelte-xgf48k.svelte-xgf48k{margin:0.5rem;align-self:center;max-width:20rem}.row.svelte-xgf48k.svelte-xgf48k{display:flex;flex-direction:row;justify-content:center;align-content:center}.row.svelte-xgf48k button.svelte-xgf48k{max-width:15rem}.show-name.svelte-xgf48k.svelte-xgf48k{font-style:italic}.alignment-panel.svelte-xgf48k.svelte-xgf48k{background:rgba(27, 26, 38, 0.9);align-self:center;padding:0.5rem;display:flex;flex-direction:column;border-radius:4px;justify-content:center;max-height:80vh;left:50vw;transform:translateX(-50%);position:absolute}fieldset.svelte-xgf48k.svelte-xgf48k{overflow:auto}.alignment-panel.svelte-xgf48k>.svelte-xgf48k:not(select):not(button){color:white}h1.svelte-xgf48k.svelte-xgf48k{margin:0}h1.svelte-xgf48k.svelte-xgf48k{font-size:1.3rem;border-bottom:2px solid #f47521}h2.svelte-xgf48k.svelte-xgf48k{font-size:0.9rem}p.svelte-xgf48k.svelte-xgf48k,label.svelte-xgf48k.svelte-xgf48k{max-width:14rem}.alignment-sign-hint.svelte-xgf48k.svelte-xgf48k{font-size:0.8rem}#manual-alignment.svelte-xgf48k.svelte-xgf48k{width:5rem;align-self:center}@media(max-width: 700px){button.svelte-xgf48k.svelte-xgf48k,input.svelte-xgf48k.svelte-xgf48k,label.svelte-xgf48k.svelte-xgf48k,legend.svelte-xgf48k.svelte-xgf48k,p.svelte-xgf48k.svelte-xgf48k{font-size:0.7rem !important;margin:0.2rem}.alignment-sign-hint.svelte-xgf48k.svelte-xgf48k{font-size:0.6rem}button.svelte-xgf48k.svelte-xgf48k{padding:4px}h1.svelte-xgf48k.svelte-xgf48k{font-size:1rem}h2.svelte-xgf48k.svelte-xgf48k{font-size:0.9rem}#subtitle-options.svelte-xgf48k.svelte-xgf48k{max-height:30vh}}h2.svelte-xgf48k.svelte-xgf48k{margin:0}p.svelte-xgf48k.svelte-xgf48k{align-self:center}.search-match.svelte-xgf48k.svelte-xgf48k:not(:last-child){margin-bottom:1rem}.search-match.svelte-xgf48k legend.svelte-xgf48k{white-space:pre;margin:0 auto}#subtitle-search.svelte-xgf48k.svelte-xgf48k{align-self:center;max-width:100%}",Object(c.g)(Ht.head,e)),Object(c.I)(this,t,ce,ee,c.X,{subtitles:16},[-1,-1])}}var re=se;function ie(t){let e,n;return{c:c.O,m(s,r){e||(n=Object(c.L)(window,"keydown",t[0]),e=!0)},p:c.O,i:c.O,o:c.O,d(t){e=!1,n()}}}function oe(t){return[function(t){const e=t.key.toLowerCase();"h"===e?i.c.update(t=>!t):"i"===e&&i.a.update(t=>!t)}]}class le extends c.b{constructor(t){super(),Object(c.I)(this,t,oe,ie,c.X,{})}}var ae=le;const{document:be}=c.F;function ue(t){let e,n;return e=new et({props:{mode:"cancelled"}}),e.$on("restart",t[5]),{c(){Object(c.s)(e.$$.fragment)},m(t,s){Object(c.N)(e,t,s),n=!0},p:c.O,i(t){n||(Object(c.jb)(e.$$.fragment,t),n=!0)},o(t){Object(c.kb)(e.$$.fragment,t),n=!1},d(t){Object(c.x)(e,t)}}}function de(t){let e,n,s,r=t[4]&&Oe(t);return n=new et({props:{recentSubs:t[2],subtitles:t[1]}}),n.$on("restart",t[5]),n.$on("tray-pauser",t[8]),n.$on("define-pauser",t[9]),n.$on("realign",t[12]),{c(){r&&r.c(),e=Object(c.db)(),Object(c.s)(n.$$.fragment)},m(t,i){r&&r.m(t,i),Object(c.J)(t,e,i),Object(c.N)(n,t,i),s=!0},p(t,s){t[4]?r?(r.p(t,s),16&s&&Object(c.jb)(r,1)):(r=Oe(t),r.c(),Object(c.jb)(r,1),r.m(e.parentNode,e)):r&&(Object(c.G)(),Object(c.kb)(r,1,1,()=>{r=null}),Object(c.m)());const i={};4&s&&(i.recentSubs=t[2]),2&s&&(i.subtitles=t[1]),n.$set(i)},i(t){s||(Object(c.jb)(r),Object(c.jb)(n.$$.fragment,t),s=!0)},o(t){Object(c.kb)(r),Object(c.kb)(n.$$.fragment,t),s=!1},d(t){r&&r.d(t),t&&Object(c.z)(e),Object(c.x)(n,t)}}}function fe(t){let e,n;return e=new re({props:{subtitles:t[1]}}),e.$on("done",t[6]),e.$on("reselect",t[11]),{c(){Object(c.s)(e.$$.fragment)},m(t,s){Object(c.N)(e,t,s),n=!0},p(t,n){const c={};2&n&&(c.subtitles=t[1]),e.$set(c)},i(t){n||(Object(c.jb)(e.$$.fragment,t),n=!0)},o(t){Object(c.kb)(e.$$.fragment,t),n=!1},d(t){Object(c.x)(e,t)}}}function je(t){let e,n;return e=new It({}),e.$on("subtitles-loaded",t[7]),e.$on("cancel",t[10]),{c(){Object(c.s)(e.$$.fragment)},m(t,s){Object(c.N)(e,t,s),n=!0},p:c.O,i(t){n||(Object(c.jb)(e.$$.fragment,t),n=!0)},o(t){Object(c.kb)(e.$$.fragment,t),n=!1},d(t){Object(c.x)(e,t)}}}function Oe(t){let e,n,s,r;const i=[he,pe],o=[];function l(t,e){return"subrip"===t[1].format?0:"ass"===t[1].format?1:-1}return~(e=l(t))&&(n=o[e]=i[e](t)),{c(){n&&n.c(),s=Object(c.B)()},m(t,n){~e&&o[e].m(t,n),Object(c.J)(t,s,n),r=!0},p(t,r){let a=e;e=l(t),e===a?~e&&o[e].p(t,r):(n&&(Object(c.G)(),Object(c.kb)(o[a],1,1,()=>{o[a]=null}),Object(c.m)()),~e?(n=o[e],n||(n=o[e]=i[e](t),n.c()),Object(c.jb)(n,1),n.m(s.parentNode,s)):n=null)},i(t){r||(Object(c.jb)(n),r=!0)},o(t){Object(c.kb)(n),r=!1},d(t){~e&&o[e].d(t),t&&Object(c.z)(s)}}}function pe(t){let e,n;return e=new zt({props:{format:t[1].format,styles:t[1].styles,subtitles:t[3]}}),e.$on("define-pauser",t[9]),{c(){Object(c.s)(e.$$.fragment)},m(t,s){Object(c.N)(e,t,s),n=!0},p(t,n){const c={};2&n&&(c.format=t[1].format),2&n&&(c.styles=t[1].styles),8&n&&(c.subtitles=t[3]),e.$set(c)},i(t){n||(Object(c.jb)(e.$$.fragment,t),n=!0)},o(t){Object(c.kb)(e.$$.fragment,t),n=!1},d(t){Object(c.x)(e,t)}}}function he(t){let e,n;return e=new nt.a({props:{format:t[1].format,subtitles:t[3]}}),e.$on("define-pauser",t[9]),{c(){Object(c.s)(e.$$.fragment)},m(t,s){Object(c.N)(e,t,s),n=!0},p(t,n){const c={};2&n&&(c.format=t[1].format),8&n&&(c.subtitles=t[3]),e.$set(c)},i(t){n||(Object(c.jb)(e.$$.fragment,t),n=!0)},o(t){Object(c.kb)(e.$$.fragment,t),n=!1},d(t){Object(c.x)(e,t)}}}function ge(t){let e,n,s,r,i,o;const l=[je,fe,de,ue],a=[];function b(t,e){return"prompt"===t[0]?0:"align"===t[0]?1:"play"===t[0]?2:"cancelled"===t[0]?3:-1}return~(n=b(t))&&(s=a[n]=l[n](t)),i=new ae({}),{c(){e=Object(c.A)("div"),s&&s.c(),r=Object(c.db)(),Object(c.s)(i.$$.fragment),Object(c.i)(e,"class","subtitles-app svelte-1hlx3v6")},m(t,s){Object(c.J)(t,e,s),~n&&a[n].m(e,null),Object(c.J)(t,r,s),Object(c.N)(i,t,s),o=!0},p(t,[r]){let i=n;n=b(t),n===i?~n&&a[n].p(t,r):(s&&(Object(c.G)(),Object(c.kb)(a[i],1,1,()=>{a[i]=null}),Object(c.m)()),~n?(s=a[n],s||(s=a[n]=l[n](t),s.c()),Object(c.jb)(s,1),s.m(e,null)):s=null)},i(t){o||(Object(c.jb)(s),Object(c.jb)(i.$$.fragment,t),o=!0)},o(t){Object(c.kb)(s),Object(c.kb)(i.$$.fragment,t),o=!1},d(t){t&&Object(c.z)(e),~n&&a[n].d(),t&&Object(c.z)(r),Object(c.x)(i,t)}}}function me(t,e,n){let r;Object(c.n)(t,i.c,t=>n(4,r=t));const o=new _t;let l,a,b="prompt",u=[],d=null,f=null,j=-1,p=[];function h(){n(0,b="prompt"),n(1,d=null),u=[]}function g(){f=document.querySelector("video"),o.setVideo(f),n(2,p=[]),n(0,b="play"),a&&a(),J=d,n(3,l=P(O)),a=l.subscribe(t=>{!function(t){let e=t[t.length-1],c=p[p.length-1];!e||c&&e.text===c.text||n(2,p=[...p,e]);p.length>10&&n(2,p=p.slice(p.length-10))}(t)})}O.subscribe(t=>j=t),Object(s.c)(()=>{document.addEventListener("visibilitychange",()=>{document.hidden||o.removePauser("define")});let t="",e="";setInterval(()=>{const n=document.querySelector("video").getAttribute("src");n&&n!==t&&(t=n,h());const c=document.querySelector(".video-title"),s=c?c.textContent:"";s!==e&&(e=s,m.set(s))},50)});return[b,d,p,l,r,h,g,function(t){n(1,d=t.detail.subtitles),0===d.subs.length?(console.log("subtitles object failed to parse: ",d),alert("No subtitles were able to be parsed from the selected subtitle file, verify nothing is wrong with the file. If it appears normal please submit a bug report with the episode and the subtitles file you used to the issue tracker (a link can be found in the tray on the right side of the video player)!"),n(0,b="cancelled")):t.detail.skipAlignment?(O.set(0),g()):n(0,b="align")},function(t){t.detail?o.addPauser("tray"):o.removePauser("tray")},function(){o.addPauser("define")},()=>n(0,b="cancelled"),()=>n(0,b="prompt"),()=>n(0,b="align")]}class ve extends c.b{constructor(t){var e;super(),be.getElementById("svelte-1hlx3v6-style")||((e=Object(c.A)("style")).id="svelte-1hlx3v6-style",e.textContent='.subtitles-app.svelte-1hlx3v6{position:relative;font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;text-align:center}.subtitles-app.svelte-1hlx3v6>*{z-index:1000000000}.subtitles-app.svelte-1hlx3v6 button,.subtitles-app.svelte-1hlx3v6 .button{background:#fd0;border:none;padding:0.4rem;line-height:1;font-weight:bold;color:black;text-transform:uppercase;font-size:0.9rem;margin-bottom:0.2rem}.subtitles-app.svelte-1hlx3v6 .small-button{font-size:0.6rem;padding:0.2rem}.subtitles-app.svelte-1hlx3v6 button:disabled,.subtitles-app.svelte-1hlx3v6 .button:disabled{background:#2a3450}.subtitles-app.svelte-1hlx3v6 button.secondary,.subtitles-app.svelte-1hlx3v6 .button.secondary{background:#11121863;border:1px solid #fd0;color:#fd0}.subtitles-app.svelte-1hlx3v6 button:not(:disabled):hover,.subtitles-app.svelte-1hlx3v6 .button:not(:disabled):hover{background:#ffea6d;cursor:pointer;color:black}.subtitles-app.svelte-1hlx3v6 input[type=text],.subtitles-app.svelte-1hlx3v6 input:not([type]){color:white;background:#0b0b26;border:1px solid #364962;padding:0.2rem}.subtitles-app.svelte-1hlx3v6 input[type=text]:focus,.subtitles-app.svelte-1hlx3v6 input:not([type]):focus{border-color:#fd0}.subtitles-app.svelte-1hlx3v6 .sr{position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden}',Object(c.g)(be.head,e)),Object(c.I)(this,t,me,ge,c.X,{})}}var xe=ve;const ye=document.createElement("div");location.host.includes("crunchyroll")?document.getElementById("vilosRoot").appendChild(ye):document.body.appendChild(ye),ye.id="sheodox-jimaku-player",ye.style.position="fixed",ye.style.width="100%";new xe({target:ye})}]);
