// ==UserScript==
// @name         字幕プレーヤー
// @namespace    https://github.com/sheodox
// @version      0.1.43
// @description  Study Japanese by using Japanese subtitles on VRV!
// @author       sheodox
// @match        https://static.vrv.co/vilos/player.html*
// @match        https://static.crunchyroll.com/vilos-v2/web/vilos/player.html*
// @grant        GM_getValue
// @grant        GM_setValue
// ==/UserScript==

!function(t){var e={};function n(c){if(e[c])return e[c].exports;var s=e[c]={i:c,l:!1,exports:{}};return t[c].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,c){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:c})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var c=Object.create(null);if(n.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(c,s,function(e){return t[e]}.bind(null,s));return c},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=17)}([function(t,e,n){"use strict";function c(){}n.d(e,"a",(function(){return It})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return ft})),n.d(e,"d",(function(){return Q})),n.d(e,"e",(function(){return S})),n.d(e,"f",(function(){return r})),n.d(e,"g",(function(){return R})),n.d(e,"h",(function(){return lt})),n.d(e,"i",(function(){return rt})),n.d(e,"j",(function(){return kt})),n.d(e,"k",(function(){return j})),n.d(e,"l",(function(){return m})),n.d(e,"m",(function(){return st})),n.d(e,"n",(function(){return X})),n.d(e,"o",(function(){return Ht})),n.d(e,"p",(function(){return Kt})),n.d(e,"q",(function(){return Ft})),n.d(e,"r",(function(){return Wt})),n.d(e,"s",(function(){return p})),n.d(e,"t",(function(){return Rt})),n.d(e,"u",(function(){return W})),n.d(e,"v",(function(){return F})),n.d(e,"w",(function(){return H})),n.d(e,"x",(function(){return T})),n.d(e,"y",(function(){return Et})),n.d(e,"z",(function(){return Z})),n.d(e,"A",(function(){return f})),n.d(e,"B",(function(){return _t})),n.d(e,"C",(function(){return wt})),n.d(e,"D",(function(){return s})),n.d(e,"E",(function(){return Mt})),n.d(e,"F",(function(){return C})),n.d(e,"G",(function(){return b})),n.d(e,"H",(function(){return P})),n.d(e,"I",(function(){return $})),n.d(e,"J",(function(){return Nt})),n.d(e,"K",(function(){return c})),n.d(e,"L",(function(){return v})),n.d(e,"M",(function(){return ct})),n.d(e,"N",(function(){return nt})),n.d(e,"O",(function(){return At})),n.d(e,"P",(function(){return K})),n.d(e,"Q",(function(){return y})),n.d(e,"R",(function(){return i})),n.d(e,"S",(function(){return a})),n.d(e,"T",(function(){return z})),n.d(e,"U",(function(){return B})),n.d(e,"V",(function(){return G})),n.d(e,"W",(function(){return E})),n.d(e,"X",(function(){return N})),n.d(e,"Y",(function(){return d})),n.d(e,"Z",(function(){return _})),n.d(e,"ab",(function(){return A})),n.d(e,"bb",(function(){return I})),n.d(e,"cb",(function(){return V})),n.d(e,"db",(function(){return $t})),n.d(e,"eb",(function(){return St})),n.d(e,"fb",(function(){return Tt})),n.d(e,"gb",(function(){return g})),n.d(e,"hb",(function(){return M}));const s=t=>t;function r(t,e){for(const n in e)t[n]=e[n];return t}function o(t){return t()}function l(){return Object.create(null)}function i(t){t.forEach(o)}function b(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function u(t){return 0===Object.keys(t).length}function d(t,...e){if(null==t)return c;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function f(t){let e;return d(t,t=>e=t)(),e}function j(t,e,n){t.$$.on_destroy.push(d(e,n))}function p(t,e,n,c){if(t){const s=O(t,e,n,c);return t[0](s)}}function O(t,e,n,c){return t[1]&&c?r(n.ctx.slice(),t[1](c(e))):n.ctx}function g(t,e,n,c,s,r,o){const l=function(t,e,n,c){if(t[2]&&c){const s=t[2](c(n));if(void 0===e.dirty)return s;if("object"==typeof s){const t=[],n=Math.max(e.dirty.length,s.length);for(let c=0;c<n;c+=1)t[c]=e.dirty[c]|s[c];return t}return e.dirty|s}return e.dirty}(e,c,s,r);if(l){const s=O(e,n,c,o);t.p(s,l)}}function m(t){const e={};for(const n in t)e[n]=!0;return e}function h(t){return t&&b(t.destroy)?t.destroy:c}const x="undefined"!=typeof window;let v=x?()=>window.performance.now():()=>Date.now(),y=x?t=>requestAnimationFrame(t):c;const w=new Set;function k(t){w.forEach(e=>{e.c(t)||(w.delete(e),e.f())}),0!==w.size&&y(k)}function $(t){let e;return 0===w.size&&y(k),{promise:new Promise(n=>{w.add(e={c:t,f:n})}),abort(){w.delete(e)}}}function S(t,e){t.appendChild(e)}function C(t,e,n){t.insertBefore(e,n||null)}function F(t){t.parentNode.removeChild(t)}function W(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function H(t){return document.createElement(t)}function _(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function A(t){return document.createTextNode(t)}function E(){return A(" ")}function T(){return A("")}function P(t,e,n,c){return t.addEventListener(e,n,c),()=>t.removeEventListener(e,n,c)}function K(t){return function(e){return e.preventDefault(),t.call(this,e)}}function N(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function R(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function M(t,e,n){t.setAttributeNS("http://www.w3.org/1999/xlink",e,n)}function I(t){return""===t?null:+t}function z(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function B(t,e){t.value=null==e?"":e}function G(t,e,n,c){t.style.setProperty(e,n,c?"important":"")}function V(t,e,n){t.classList[n?"add":"remove"](e)}function q(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}const J=new Set;let L,D=0;function U(t,e,n,c,s,r,o,l=0){const i=16.666/c;let b="{\n";for(let t=0;t<=1;t+=i){const c=e+(n-e)*r(t);b+=100*t+`%{${o(c,1-c)}}\n`}const a=b+`100% {${o(n,1-n)}}\n}`,u=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(a)}_${l}`,d=t.ownerDocument;J.add(d);const f=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(H("style")).sheet),j=d.__svelte_rules||(d.__svelte_rules={});j[u]||(j[u]=!0,f.insertRule(`@keyframes ${u} ${a}`,f.cssRules.length));const p=t.style.animation||"";return t.style.animation=`${p?`${p}, `:""}${u} ${c}ms linear ${s}ms 1 both`,D+=1,u}function Y(t,e){const n=(t.style.animation||"").split(", "),c=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),s=n.length-c.length;s&&(t.style.animation=c.join(", "),D-=s,D||y(()=>{D||(J.forEach(t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}}),J.clear())}))}function X(t,e,n,r){if(!e)return c;const o=t.getBoundingClientRect();if(e.left===o.left&&e.right===o.right&&e.top===o.top&&e.bottom===o.bottom)return c;const{delay:l=0,duration:i=300,easing:b=s,start:a=v()+l,end:u=a+i,tick:d=c,css:f}=n(t,{from:e,to:o},r);let j,p=!0,O=!1;function g(){f&&Y(t,j),p=!1}return $(t=>{if(!O&&t>=a&&(O=!0),O&&t>=u&&(d(1,0),g()),!p)return!1;if(O){const e=0+1*b((t-a)/i);d(e,1-e)}return!0}),f&&(j=U(t,0,1,i,l,b,f)),l||(O=!0),d(0,1),g}function Z(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:n,height:c}=e,s=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=c,Q(t,s)}}function Q(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const c=getComputedStyle(t),s="none"===c.transform?"":c.transform;t.style.transform=`${s} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}function tt(t){L=t}function et(){if(!L)throw new Error("Function called outside component initialization");return L}function nt(t){et().$$.on_mount.push(t)}function ct(t){et().$$.on_destroy.push(t)}function st(){const t=et();return(e,n)=>{const c=t.$$.callbacks[e];if(c){const s=q(e,n);c.slice().forEach(e=>{e.call(t,s)})}}}function rt(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(t=>t(e))}const ot=[],lt=[],it=[],bt=[],at=Promise.resolve();let ut=!1;function dt(){ut||(ut=!0,at.then(Ot))}function ft(t){it.push(t)}let jt=!1;const pt=new Set;function Ot(){if(!jt){jt=!0;do{for(let t=0;t<ot.length;t+=1){const e=ot[t];tt(e),gt(e.$$)}for(tt(null),ot.length=0;lt.length;)lt.pop()();for(let t=0;t<it.length;t+=1){const e=it[t];pt.has(e)||(pt.add(e),e())}it.length=0}while(ot.length);for(;bt.length;)bt.pop()();ut=!1,jt=!1,pt.clear()}}function gt(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ft)}}let mt;function ht(){return mt||(mt=Promise.resolve(),mt.then(()=>{mt=null})),mt}function xt(t,e,n){t.dispatchEvent(q(`${e?"intro":"outro"}${n}`))}const vt=new Set;let yt;function wt(){yt={r:0,c:[],p:yt}}function kt(){yt.r||i(yt.c),yt=yt.p}function $t(t,e){t&&t.i&&(vt.delete(t),t.i(e))}function St(t,e,n,c){if(t&&t.o){if(vt.has(t))return;vt.add(t),yt.c.push(()=>{vt.delete(t),c&&(n&&t.d(1),c())}),t.o(e)}}const Ct={duration:0};function Ft(t,e,n){let r,o,l=e(t,n),i=!1,a=0;function u(){r&&Y(t,r)}function d(){const{delay:e=0,duration:n=300,easing:b=s,tick:d=c,css:f}=l||Ct;f&&(r=U(t,0,1,n,e,b,f,a++)),d(0,1);const j=v()+e,p=j+n;o&&o.abort(),i=!0,ft(()=>xt(t,!0,"start")),o=$(e=>{if(i){if(e>=p)return d(1,0),xt(t,!0,"end"),u(),i=!1;if(e>=j){const t=b((e-j)/n);d(t,1-t)}}return i})}let f=!1;return{start(){f||(Y(t),b(l)?(l=l(),ht().then(d)):d())},invalidate(){f=!1},end(){i&&(u(),i=!1)}}}function Wt(t,e,n){let r,o=e(t,n),l=!0;const a=yt;function u(){const{delay:e=0,duration:n=300,easing:b=s,tick:u=c,css:d}=o||Ct;d&&(r=U(t,1,0,n,e,b,d));const f=v()+e,j=f+n;ft(()=>xt(t,!1,"start")),$(e=>{if(l){if(e>=j)return u(0,1),xt(t,!1,"end"),--a.r||i(a.c),!1;if(e>=f){const t=b((e-f)/n);u(1-t,t)}}return l})}return a.r+=1,b(o)?ht().then(()=>{o=o(),u()}):u(),{end(e){e&&o.tick&&o.tick(1,0),l&&(r&&Y(t,r),l=!1)}}}function Ht(t,e,n,r){let o=e(t,n),l=r?0:1,a=null,u=null,d=null;function f(){d&&Y(t,d)}function j(t,e){const n=t.b-l;return e*=Math.abs(n),{a:l,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function p(e){const{delay:n=0,duration:r=300,easing:b=s,tick:p=c,css:O}=o||Ct,g={start:v()+n,b:e};e||(g.group=yt,yt.r+=1),a||u?u=g:(O&&(f(),d=U(t,l,e,r,n,b,O)),e&&p(0,1),a=j(g,r),ft(()=>xt(t,e,"start")),$(e=>{if(u&&e>u.start&&(a=j(u,r),u=null,xt(t,a.b,"start"),O&&(f(),d=U(t,l,a.b,a.duration,0,b,o.css))),a)if(e>=a.end)p(l=a.b,1-l),xt(t,a.b,"end"),u||(a.b?f():--a.group.r||i(a.group.c)),a=null;else if(e>=a.start){const t=e-a.start;l=a.a+a.d*b(t/a.duration),p(l,1-l)}return!(!a&&!u)}))}return{run(t){b(o)?ht().then(()=>{o=o(),p(t)}):p(t)},end(){f(),a=u=null}}}const _t="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function At(t,e){St(t,1,1,()=>{e.delete(t.key)})}function Et(t,e){t.f(),At(t,e)}function Tt(t,e,n,c,s,r,o,l,i,b,a,u){let d=t.length,f=r.length,j=d;const p={};for(;j--;)p[t[j].key]=j;const O=[],g=new Map,m=new Map;for(j=f;j--;){const t=u(s,r,j),l=n(t);let i=o.get(l);i?c&&i.p(t,e):(i=b(l,t),i.c()),g.set(l,O[j]=i),l in p&&m.set(l,Math.abs(j-p[l]))}const h=new Set,x=new Set;function v(t){$t(t,1),t.m(l,a),o.set(t.key,t),a=t.first,f--}for(;d&&f;){const e=O[f-1],n=t[d-1],c=e.key,s=n.key;e===n?(a=e.first,d--,f--):g.has(s)?!o.has(c)||h.has(c)?v(e):x.has(s)?d--:m.get(c)>m.get(s)?(x.add(c),v(e)):(h.add(s),d--):(i(n,o),d--)}for(;d--;){const e=t[d];g.has(e.key)||i(e,o)}for(;f;)v(O[f-1]);return O}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let Pt;function Kt(t){t&&t.c()}function Nt(t,e,n){const{fragment:c,on_mount:s,on_destroy:r,after_update:l}=t.$$;c&&c.m(e,n),ft(()=>{const e=s.map(o).filter(b);r?r.push(...e):i(e),t.$$.on_mount=[]}),l.forEach(ft)}function Rt(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Mt(t,e,n,s,r,o,b=[-1]){const a=L;tt(t);const u=e.props||{},d=t.$$={fragment:null,ctx:null,props:o,update:c,not_equal:r,bound:l(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:l(),dirty:b,skip_bound:!1};let f=!1;if(d.ctx=n?n(t,u,(e,n,...c)=>{const s=c.length?c[0]:n;return d.ctx&&r(d.ctx[e],d.ctx[e]=s)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](s),f&&function(t,e){-1===t.$$.dirty[0]&&(ot.push(t),dt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(t,e)),n}):[],d.update(),f=!0,i(d.before_update),d.fragment=!!s&&s(d.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);d.fragment&&d.fragment.l(t),t.forEach(F)}else d.fragment&&d.fragment.c();e.intro&&$t(t.$$.fragment),Nt(t,e.target,e.anchor),Ot()}tt(a)}"function"==typeof HTMLElement&&(Pt=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}$destroy(){Rt(this,1),this.$destroy=c}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!u(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class It{$destroy(){Rt(this,1),this.$destroy=c}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!u(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}},function(t,e,n){"use strict";var c=n(0);n.d(e,"a",(function(){return c.m})),n.d(e,"b",(function(){return c.M})),n.d(e,"c",(function(){return c.N}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return r}));var c=n(0);function s(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1}function r(t){const e=t-1;return e*e*e+1}n.d(e,"c",(function(){return c.D}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return r}));var c=n(2);n(0);function s(t,{delay:e=0,duration:n=400,easing:s=c.c}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:s,css:t=>`opacity: ${t*r}`}}function r(t,{delay:e=0,duration:n=400,easing:s=c.b,x:r=0,y:o=0,opacity:l=0}){const i=getComputedStyle(t),b=+i.opacity,a="none"===i.transform?"":i.transform,u=b*(1-l);return{delay:e,duration:n,easing:s,css:(t,e)=>`\n\t\t\ttransform: ${a} translate(${(1-t)*r}px, ${(1-t)*o}px);\n\t\t\topacity: ${b-u*e}`}}},,,,,,,,,,,function(t,e){const n=t=>Object.assign({},t);t.exports=class{constructor(t,e){this.format=t,this.fileName=e,this.subs=[]}getSubs(t){return this.subs.filter(e=>e.start<=t&&e.end>=t)}timeToMs(t){const[e,n,c]=t.split(":");return 36e5*+e+6e4*+n+1e3*parseFloat(c)}prettyTimeDifference(t,e){return`+${parseFloat(((e-t)/1e3).toFixed(1))} seconds`}getAlignmentCandidates(t){let e=this.subs;return e.sort((t,e)=>t.start-e.end),t?e.reduce((c,s,r)=>{if(s.text.includes(t)){const t=r+1,o=e.slice(t,t+3).map(n).map(t=>(t.offset=this.prettyTimeDifference(s.start,t.start),t));c.push({type:"search-match",sub:s,subsequent:o})}return c},[]).slice(0,5):e.slice(0,20).map(n).map(t=>(t.offset=this.prettyTimeDifference(e[0].start,t.start),t))}}},function(t,e,n){const c=n(14),s=t=>(t.charAt(0).toLowerCase()+t.substring(1)).replace(" ",""),r=t=>{if(t){t=(t=t.replace(/[&H]/g,"")).padStart(8,"0");const[e,n,c,s,r]=t.match(/([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})/i),o=t=>parseInt(t,16);return`rgba(${o(r)}, ${o(s)}, ${o(c)}, ${255-o(n)})`}},o=(t,e,n="transparent",c=0,s=0)=>{const r=t||n;c*=2,s=`${s}px`;const o=[];for(let t=-1*(e=2*(void 0===e?1:e));t<=e;t++)for(let n=-1*e;n<=e;n++)o.push(`${t}px ${n}px ${s} ${r}`);return`text-shadow: ${o.join(", ")}, ${c}px ${c}px ${s} ${n}`},l=t=>`font-family: "${t}", "Source Han Sans", "源ノ角ゴシック", "Hiragino Sans", "HiraKakuProN-W3", "Hiragino Kaku Gothic ProN W3", "Hiragino Kaku Gothic ProN", "ヒラギノ角ゴ ProN W3", "Noto Sans", "Noto Sans CJK JP", "メイリオ", Meiryo, "游ゴシック", YuGothic, "ＭＳ Ｐゴシック", "MS PGothic", "ＭＳ ゴシック", "MS Gothic", sans-serif`,i=(t,e="0vw",n="0vw",c="0vh")=>{const s={1:`top: calc(100vh - ${c}); left: ${e}; transform: translate(0, -100%)`,2:`top: calc(100vh - ${c}); left: 50vw; transform: translate(-50%, -100%)`,3:`top: calc(100vh - ${c}); left: calc(100vw - ${n}); transform: translate(-100%, -100%)`,4:`top: 50vh; left: ${e}; transform: translate(0, -50%)`,5:"top: 50vh; left: 50vw; transform: translate(-50%, -50%)",6:`top: 50vh; left: calc(100vw - ${n}); transform: translate(-100%, -50%)`,7:`top: ${c}; left: ${e}`,8:`top: ${c}; left: 50vw; transform: translateX(-50%)`,9:`top: ${c}; left: calc(100vw - ${n}); transform: translateX(-100%)`},r=t=>`position:fixed;${s[t]}`;return{normal:r(t),inverted:r({1:7,2:8,3:9,4:4,5:5,6:6,7:1,8:2,9:3}[t])}};function b(t,e,n=!1){const c=new RegExp(n?`\\\\${e}\\((.*?)\\)`:`\\\\${e}([^\\\\}]*)`),s=t.match(c);if(s)return{overrides:t.replace(s[0],""),params:n?s[1].split(","):s[1]}}t.exports=class extends c{constructor(t,e){super("ass",e),t=t.replace(/\r\n/g,"\n");try{this.blocks=this.parseBlocks(t),this.subs=this.parseBlock(this.blocks.subs),this.parseInfo(this.blocks.info),this.parseSubTimings(),this.parseStyles(this.parseBlock(this.blocks.styles)),this.parseSubOverrideTags()}catch(t){console.error("ASS PARSE ERROR",t),this.subs=[]}}serialize(){return JSON.stringify({info:this.info,styles:this.styles,subs:this.subs},null,4)}debugInfo(){return[{title:"Number of styles",detail:Object.keys(this.styles).length},{title:"Number of subtitles",detail:this.subs.length}]}parseInfo(){this.info={},this.blocks.info.split("\n").forEach(t=>{const[e,n]=t.split(": ");this.info[s(e)]=n})}scaleHeight(t){return`${t/+this.info.playResY*100}vh`}scaleWidth(t){return`${t/+this.info.playResX*100}vw`}parseBlocks(t){const e=t.split(/\n(?=\[)/),n=t=>e.find(e=>{e=e.trim();const[n,c]=e.match(/^\[(.*?)]/);return c===t}).replace(/.*\n/,"").trim();return{info:n("Script Info"),styles:n("V4+ Styles"),subs:n("Events")}}parseBlock(t){const[e,...n]=t.split("\n"),c=(t,e=1/0)=>{let[n,c,s]=t.match(/(\w*): (.*)/);return s=s.split(","),s.length>e&&(s[e-1]=s.slice(e-1).join(","),s.splice(e,1/0)),{type:c,attributes:s}},r=c(e);return n.reduce((t,e)=>{if(!e||";"===e.charAt(0)||0===e.indexOf("Comment: "))return t;const n=c(e,r.attributes.length),o={dataType:n.type.toLowerCase()};return r.attributes.forEach((t,e)=>{t=t.trim();const c=s(t);o[c]=n.attributes[e]}),o.style="*Default"===o.style?"Default":o.style,t.push(o),t},[])}parseSubTimings(){this.subs.forEach(t=>{t.start=this.timeToMs(t.start),t.end=this.timeToMs(t.end)})}parseStyles(t){const e={};t.forEach(t=>{for(const e of Object.keys(t).filter(t=>/colour/i.test(t)))t[e]=r(t[e]);t.name="*Default"===t.name?"Default":t.name;const n=[],{primaryColour:c,secondaryColour:s,outlineColour:b,backColour:a,borderStyle:u,outline:d,shadow:f,fontname:j,fontsize:p,bold:O,italic:g,underline:m,strikeOut:h,alignment:x,marginL:v,marginR:y,marginV:w}=t;c&&n.push(`color: ${c}`),j&&n.push(l(j)),"1"===u?n.push(o(b,d,a,f)):"3"===u&&n.push(`background-color: ${a}`),"-1"===O&&n.push("font-weight: bold"),"-1"===g&&n.push("font-style: italic"),"-1"!==m&&"-1"!==h||n.push(`text-decoration: ${"-1"===m?"underline":""} ${"-1"===h?"line-through":""}`),n.push(this.genScaledFont(p)),e[t.name]={inline:n.join(";"),verticalAlignment:i(x,this.scaleWidth(v),this.scaleWidth(y),this.scaleHeight(w)),raw:t}}),this.styles=e}genScaledFont(t){return`font-size: ${this.scaleHeight(.75*t)}`}parseSubOverrideTags(){this.subs.forEach(t=>{if(t.rawText=t.text,t.text=t.text.replace(/\\N/g,"\n").replace(/\\h/g," "),!/{.+?}/.test(t.text))return;t.phrases=[];const e=t=>t.replace(/{.*?}/g,""),n=function*(t){const e=/({.*?}[^{]*)/g;let n;const c=t.indexOf("{");for(c>0&&(yield t.substring(0,c));null!==(n=e.exec(t));)yield n[1]}(t.text);let c=[];for(const u of n){const n=[],d={text:e(u),fadeIn:0,fadeOut:0,inline:""};let f,j,p,O,g,m=u.match(/{.*?}/),h=m?m[0]:"";function s(t,e=!1,n=(()=>{})){const c=b(h,t,e);c&&(n(c.params),h=c.overrides)}function a(t,e,n){const c=t.map((t,n)=>{const c=Array.isArray(e)?e[n]:e,s=b(h,t,c);if(s)return h=s.overrides,s.params});c.some(t=>void 0!==t)&&n(...c)}if(s("fscx"),s("fscy"),s("an",!1,e=>{const n=this.styles[t.style];t.verticalAlignment=i(e,this.scaleWidth(n.raw.marginL),this.scaleWidth(n.raw.marginR),this.scaleHeight(n.raw.marginV))}),s("3c",!1,t=>{f=t}),s("4c",!1,t=>{j=t}),s("bord",!1,t=>{p=t}),s("shad",!1,t=>{O=t}),s("blur",!1,t=>{g=t}),s("be",!1,t=>{g=t}),[f,j,p,O,g].some(t=>void 0!==t)){const e=this.styles[t.style],n=(t,n)=>void 0!==t?t:e.raw[n];e&&(f=n(r(f),"outlineColour"),j=n(r(j),"backColour"),p=n(p,"outline"),O=n(O,"shadow"),c.push(o(f,p,j,O,g)))}a(["pos","an","org"],[!0,!1,!0],(t,e="5",s)=>{if(t){const[r,o]=t;n.push(`position: fixed; left: ${this.scaleWidth(r)}; top: ${this.scaleHeight(o)}`);const l={1:"50%, -150%",2:"-50%, -150%",3:"-150%, -150%",4:"50%, -50%",5:"-50%, -50%",6:"-150%, -50%",7:"50%, 50%",8:"-50%, 50%",9:"-150%, 50%"}[e];if(n.push(`transform: translate(${l})`),s){const[t,e]=s;c.push(`transform-origin: ${this.scaleWidth(t)} ${this.scaleHeight(e)}`)}}}),a(["frx","fry","frz"],!1,(t,e,s)=>{const r=[],o=(t,e,n=1)=>{if(void 0!==t)return t=parseFloat(t)*n,r.push(`rotate3d(${e.join(", ")}, ${t}deg)`)};o(t,[1,0,0]),o(s,[0,0,1],-1),o(e,[0,1,0]),r.length&&(n.push("perspective: 200px"),c.push(`display: block; transform: ${r.join(" ")}`))}),s("fad",!0,([e,n])=>{d.fadeIn=parseInt(e,10),d.fadeOut=parseInt(n,10),t.end-=n}),s("fsp",!1,t=>{c.push(`letter-spacing: ${t}px`)}),s("fs",!1,t=>{c.push(this.genScaledFont(t))});const x=[];s("u",!1,t=>{x.push("underline")}),s("s",!1,t=>{x.push("line-through")}),c.push(`text-decoration: ${x.length?x.join(" "):"none"}`),s("b",!1,t=>{c.push(`font-weight: ${t?"bold":"normal"}`)}),s("i",!1,t=>{c.push(`font-style: ${t?"italic":"normal"}`)}),s("fn",!1,t=>{c.push(l(t))}),s("1c",!1,t=>{c.push(`color: ${r(t)}`)}),s("r",!1,t=>{if(t){const e=this.styles[t];c=[e.inline]}else c=[]}),d.inline=c.join(";"),t.phrases.push(d),n.length&&(t.inline=n.join(";"))}t.text=e(t.text)})}}},,function(t,e,n){"use strict";n.r(e);var c=n(0),s=n(1);const r=[];function o(t,e){return{subscribe:l(t,e).subscribe}}function l(t,e=c.K){let n;const s=[];function o(e){if(Object(c.S)(t,e)&&(t=e,n)){const e=!r.length;for(let e=0;e<s.length;e+=1){const n=s[e];n[1](),r.push(n,t)}if(e){for(let t=0;t<r.length;t+=2)r[t][0](r[t+1]);r.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(r,l=c.K){const i=[r,l];return s.push(i),1===s.length&&(n=e(o)||c.K),r(t),()=>{const t=s.indexOf(i);-1!==t&&s.splice(t,1),0===s.length&&(n(),n=null)}}}}function i(t,e,n){const s=!Array.isArray(t),r=s?[t]:t,l=e.length<2;return o(n,t=>{let n=!1;const o=[];let i=0,b=c.K;const a=()=>{if(i)return;b();const n=e(s?o[0]:o,t);l?t(n):b=Object(c.G)(n)?n:c.K},u=r.map((t,e)=>Object(c.Y)(t,t=>{o[e]=t,i&=~(1<<e),n&&a()},()=>{i|=1<<e}));return n=!0,a(),function(){Object(c.R)(u),b()}})}const b={subtitleFallbackColor:"#FFFFFF",showSubtitlesOnVideo:!0,pauseWhenTrayOpen:!0,invertVerticalAlignment:!0},a=Object.assign({},b,GM_getValue("settings-store",{})),u={};Object.keys(b).forEach(t=>{(u[t]=l(a[t])).subscribe(e=>{a[t]=e,GM_setValue("settings-store",a)})});const d=u.subtitleFallbackColor,f=u.showSubtitlesOnVideo,j=u.pauseWhenTrayOpen,p=u.invertVerticalAlignment;var O=n(3),g=n(2);function m(t,e,n){const s=getComputedStyle(t),r="none"===s.transform?"":s.transform,o=e.from.width/t.clientWidth,l=e.from.height/t.clientHeight,i=(e.from.left-e.to.left)/o,b=(e.from.top-e.to.top)/l,a=Math.sqrt(i*i+b*b),{delay:u=0,duration:d=(t=>120*Math.sqrt(t)),easing:f=g.b}=n;return{delay:u,duration:Object(c.G)(d)?d(a):d,easing:f,css:(t,e)=>`transform: ${r} translate(${e*i}px, ${e*b}px);`}}function h(t){return"[object Date]"===Object.prototype.toString.call(t)}function x(t,e){if(t===e||t!=t)return()=>t;const n=typeof t;if(n!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const n=e.map((e,n)=>x(t[n],e));return t=>n.map(e=>e(t))}if("object"===n){if(!t||!e)throw new Error("Object cannot be null");if(h(t)&&h(e)){t=t.getTime();const n=(e=e.getTime())-t;return e=>new Date(t+e*n)}const n=Object.keys(e),c={};return n.forEach(n=>{c[n]=x(t[n],e[n])}),t=>{const e={};return n.forEach(n=>{e[n]=c[n](t)}),e}}if("number"===n){const n=e-t;return e=>t+e*n}throw new Error(`Cannot interpolate ${n} values`)}const v=()=>`last-used-alignment-${w}`,y=()=>`alignment-history-${w}`;let w="";const k=l(null),$=l(!1),S=l([]),C=i(S,t=>t.slice(1)),F=l("");F.subscribe(t=>{w=t;const e=GM_getValue(v());S.set(GM_getValue(y(),[])),k.set(e),$.set("number"==typeof e)}),k.subscribe(t=>{GM_setValue(v(),t),$.set("number"==typeof t)});const W=t=>{null!==t&&S.update((e=[])=>[H(t),...e.filter(e=>e.alignment!==t)].slice(0,5))};function H(t){return{alignment:t,signed:_(t)}}function _(t){const e=parseFloat((t/1e3).toFixed(2));return e>0?`+${e}`:e}S.subscribe(t=>{GM_setValue(y(),t)});const A=i(k,t=>parseFloat((t/1e3).toFixed(2))),E=i(k,t=>_(t)),T=i(A,t=>0===t?"no adjustment":t>0?`delayed by ${t} seconds`:`hastened by ${Math.abs(t)} seconds`);function P(t){let e,n,s,r,o,l,i,b,a,u,d,f,j,p,O,g,m,h,x,v,y,w,k,$,S,C;return{c(){e=Object(c.w)("div"),n=Object(c.w)("h1"),n.textContent="Fine Alignment",s=Object(c.W)(),r=Object(c.w)("p"),o=Object(c.ab)("Play the video and use these adjustment buttons until the subtitles show at the right time.\n\t\t"),l=Object(c.w)("br"),i=Object(c.W)(),b=Object(c.w)("strong"),a=Object(c.ab)("Subtitles are "),u=Object(c.ab)(t[0]),d=Object(c.W)(),f=Object(c.w)("p"),f.textContent="Do the subtitles show...",j=Object(c.W)(),p=Object(c.w)("button"),p.textContent="Way too late?",O=Object(c.W)(),g=Object(c.w)("button"),g.textContent="Too late?",m=Object(c.W)(),h=Object(c.w)("button"),h.textContent="Too early?",x=Object(c.W)(),v=Object(c.w)("button"),v.textContent="Way too early?",y=Object(c.W)(),w=Object(c.w)("br"),k=Object(c.W)(),$=Object(c.w)("button"),$.textContent="Done",Object(c.g)(n,"class","svelte-t5ayh1"),Object(c.g)(p,"class","secondary"),Object(c.g)(g,"class","secondary"),Object(c.g)(h,"class","secondary"),Object(c.g)(v,"class","secondary"),Object(c.g)(e,"class","fine-align svelte-t5ayh1")},m(F,W){Object(c.F)(F,e,W),Object(c.e)(e,n),Object(c.e)(e,s),Object(c.e)(e,r),Object(c.e)(r,o),Object(c.e)(r,l),Object(c.e)(r,i),Object(c.e)(r,b),Object(c.e)(b,a),Object(c.e)(b,u),Object(c.e)(e,d),Object(c.e)(e,f),Object(c.e)(e,j),Object(c.e)(e,p),Object(c.e)(e,O),Object(c.e)(e,g),Object(c.e)(e,m),Object(c.e)(e,h),Object(c.e)(e,x),Object(c.e)(e,v),Object(c.e)(e,y),Object(c.e)(e,w),Object(c.e)(e,k),Object(c.e)(e,$),S||(C=[Object(c.H)(p,"click",t[1](-1*t[2])),Object(c.H)(g,"click",t[1](-1*t[3])),Object(c.H)(h,"click",t[1](t[3])),Object(c.H)(v,"click",t[1](t[2])),Object(c.H)($,"click",t[4])],S=!0)},p(t,[e]){1&e&&Object(c.T)(u,t[0])},i:c.K,o:c.K,d(t){t&&Object(c.v)(e),S=!1,Object(c.R)(C)}}}function K(t,e,n){let r;Object(c.k)(t,T,t=>n(0,r=t));const o=Object(s.a)();return[r,t=>()=>{k.update(e=>e+t)},1e3,200,function(){W(Object(c.A)(k)),o("close")}]}class N extends c.a{constructor(t){var e;super(),document.getElementById("svelte-t5ayh1-style")||((e=Object(c.w)("style")).id="svelte-t5ayh1-style",e.textContent=".fine-align.svelte-t5ayh1{background:rgba(27, 26, 38, 0.9);padding:1rem;color:white;position:fixed;top:50vh;left:50vw;transform:translate(-50%, -50%);max-width:20rem}h1.svelte-t5ayh1{border-bottom:2px solid #f47521}",Object(c.e)(document.head,e)),Object(c.E)(this,t,K,P,c.S,{})}}var R=N;let M;const I=t=>o([],e=>{let n,c,s="number"==typeof t?t:0;"number"!=typeof t&&(c=t.subscribe(t=>{s=t}));const r=document.querySelector("video"),o=()=>{e(M.getSubs(1e3*r.currentTime-s)),n=requestAnimationFrame(o)};return o(),()=>{cancelAnimationFrame(n),c&&c()}});function z(t,e,n){const c=t.slice();return c[6]=e[n],c}function B(t){let e,n=t[1],s=[];for(let e=0;e<n.length;e+=1)s[e]=V(z(t,n,e));return{c(){e=Object(c.w)("div");for(let t=0;t<s.length;t+=1)s[t].c();Object(c.g)(e,"class","svelte-xof7a2"),Object(c.cb)(e,"with-previews",t[0])},m(t,n){Object(c.F)(t,e,n);for(let t=0;t<s.length;t+=1)s[t].m(e,null)},p(t,r){if(11&r){let c;for(n=t[1],c=0;c<n.length;c+=1){const o=z(t,n,c);s[c]?s[c].p(o,r):(s[c]=V(o),s[c].c(),s[c].m(e,null))}for(;c<s.length;c+=1)s[c].d(1);s.length=n.length}1&r&&Object(c.cb)(e,"with-previews",t[0])},d(t){t&&Object(c.v)(e),Object(c.u)(s,t)}}}function G(t){let e;return{c(){e=Object(c.w)("pre"),Object(c.g)(e,"class","subtitle-preview svelte-xof7a2")},m(t,n){Object(c.F)(t,e,n)},d(t){t&&Object(c.v)(e)}}}function V(t){let e,n,s,r,o,l,i,b=t[6].signed+"",a=t[0]&&G();function u(...e){return t[4](t[6],...e)}return{c(){e=Object(c.w)("button"),n=Object(c.ab)(b),s=Object(c.ab)("秒\n\t\t\t\t"),a&&a.c(),r=Object(c.W)(),Object(c.g)(e,"class","secondary svelte-xof7a2")},m(b,d){Object(c.F)(b,e,d),Object(c.e)(e,n),Object(c.e)(e,s),a&&a.m(e,null),Object(c.e)(e,r),l||(i=[Object(c.H)(e,"click",u),Object(c.b)(o=t[2].call(null,e,t[6].alignment))],l=!0)},p(s,l){t=s,2&l&&b!==(b=t[6].signed+"")&&Object(c.T)(n,b),t[0]?a||(a=G(),a.c(),a.m(e,r)):a&&(a.d(1),a=null),o&&Object(c.G)(o.update)&&2&l&&o.update.call(null,t[6].alignment)},d(t){t&&Object(c.v)(e),a&&a.d(),l=!1,Object(c.R)(i)}}}function q(t){let e,n=t[1].length&&B(t);return{c(){n&&n.c(),e=Object(c.x)()},m(t,s){n&&n.m(t,s),Object(c.F)(t,e,s)},p(t,[c]){t[1].length?n?n.p(t,c):(n=B(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:c.K,o:c.K,d(t){n&&n.d(t),t&&Object(c.v)(e)}}}function J(t,e,n){let r;Object(c.k)(t,C,t=>n(1,r=t));let{showPreviews:o=!1}=e;const i=Object(s.a)();function b(t){k.set(t),W(t),i("aligned")}return t.$$set=t=>{"showPreviews"in t&&n(0,o=t.showPreviews)},[o,r,function(t,e){if(!o)return;const n=l(e),c=t.querySelector(".subtitle-preview");return{update:t=>n.set(t),destroy:I(n).subscribe(t=>{const e=t.map(t=>t.text).join("\n").trim()||"\n\n";c.textContent=e.includes("\n")?e:"\n"+e})}},b,t=>b(t.alignment)]}class L extends c.a{constructor(t){var e;super(),document.getElementById("svelte-xof7a2-style")||((e=Object(c.w)("style")).id="svelte-xof7a2-style",e.textContent="button.svelte-xof7a2{margin:0.5rem;align-self:center;max-width:20rem;overflow:hidden}pre.svelte-xof7a2{margin:0;padding:0;font-size:0.7rem}.with-previews.svelte-xof7a2{display:grid;grid-gap:0.5rem;grid-template-columns:1fr 1fr}",Object(c.e)(document.head,e)),Object(c.E)(this,t,J,q,c.S,{showPreviews:0})}}var D=L;const{document:U}=c.B;function Y(t,e,n){const c=t.slice();return c[35]=e[n],c}function X(t,e,n){const c=t.slice();return c[38]=e[n],c[40]=n,c}function Z(t){let e,n,s,r,o,l,i,b,a,u,d,f,j,p,O,g,m,h,x,v,y,w,k,$,S,C,F,W,H,_,A,E,T,P,K,N,R,M,I,z,B,G,V,q,J,L,U,Z,Q,ct,st,rt,ot,lt,it,bt,at,ut,dt,ft,jt,pt,Ot,gt,mt,ht,xt,vt,yt,wt,kt,$t,St,Ct,Ft,Wt,Ht,_t,At,Et,Tt,Pt,Kt,Nt,Rt,Mt,It,zt,Bt=[],Gt=new Map,Vt=t[1].fileName+"",qt=t[0];const Jt=t=>t[38].text;for(let e=0;e<qt.length;e+=1){let n=X(t,qt,e),c=Jt(n);Gt.set(c,Bt[e]=tt(c,n))}let Lt=t[8]&&et(t);G=new D({props:{showPreviews:!0}});let Dt=t[1].debugInfo(),Ut=[];for(let e=0;e<Dt.length;e+=1)Ut[e]=nt(Y(t,Dt,e));return{c(){e=Object(c.w)("div"),n=Object(c.w)("button"),s=Object(c.ab)("Recent Subtitles"),o=Object(c.W)(),l=Object(c.w)("button"),i=Object(c.ab)("Setup"),a=Object(c.W)(),u=Object(c.w)("button"),d=Object(c.ab)("Settings"),j=Object(c.W)(),p=Object(c.w)("div"),O=Object(c.w)("h2"),O.textContent="Recent Subtitles",g=Object(c.W)(),m=Object(c.w)("ul");for(let t=0;t<Bt.length;t+=1)Bt[t].c();h=Object(c.W)(),x=Object(c.w)("div"),v=Object(c.w)("h2"),v.textContent="Start Over",y=Object(c.W)(),w=Object(c.w)("div"),k=Object(c.w)("button"),k.textContent="Reselect subtitles",$=Object(c.W)(),S=Object(c.w)("h2"),S.textContent="Alignment",C=Object(c.W)(),F=Object(c.w)("div"),W=Object(c.w)("p"),H=Object(c.ab)(t[6]),_=Object(c.ab)(" ("),A=Object(c.ab)(t[7]),E=Object(c.ab)(")"),T=Object(c.W)(),P=Object(c.w)("div"),K=Object(c.w)("button"),K.textContent="Realign subtitles",N=Object(c.W)(),R=Object(c.w)("button"),R.textContent="Fine adjustment",M=Object(c.W)(),I=Object(c.w)("h3"),I.textContent="Switch to a previous alignment",z=Object(c.W)(),Lt&&Lt.c(),B=Object(c.W)(),Object(c.p)(G.$$.fragment),V=Object(c.W)(),q=Object(c.w)("div"),J=Object(c.w)("h2"),J.textContent="Settings",L=Object(c.W)(),U=Object(c.w)("div"),Z=Object(c.w)("label"),Z.textContent="Subtitle fallback color:",Q=Object(c.W)(),ct=Object(c.w)("input"),st=Object(c.W)(),rt=Object(c.w)("div"),ot=Object(c.w)("input"),lt=Object(c.W)(),it=Object(c.w)("label"),it.innerHTML='Show subs over video (<kbd title="Hotkey: h" class="svelte-dr1m8c">H</kbd>)',bt=Object(c.W)(),at=Object(c.w)("div"),ut=Object(c.w)("input"),dt=Object(c.W)(),ft=Object(c.w)("label"),ft.textContent="Pause when tray is open",jt=Object(c.W)(),pt=Object(c.w)("div"),Ot=Object(c.w)("input"),gt=Object(c.W)(),mt=Object(c.w)("label"),mt.innerHTML='Invert subtitle vertical alignment (<kbd title="Hotkey: i" class="svelte-dr1m8c">I</kbd>) <span class="muted svelte-dr1m8c">(i.e. if subtitles should be near the bottom this will make them show near the top).\n\t\t\t\t\tYou&#39;ll likely want this enabled if you intend to watch with VRV&#39;s subtitles at the same time.</span>',ht=Object(c.W)(),xt=Object(c.w)("h2"),xt.textContent="Debug Information",vt=Object(c.W)(),yt=Object(c.w)("dl"),wt=Object(c.w)("dt"),wt.textContent="Subtitles File",kt=Object(c.w)("dd"),$t=Object(c.ab)(Vt),St=Object(c.w)("dt"),St.textContent="Alignment",Ct=Object(c.w)("dd"),Ft=Object(c.ab)(t[6]),Wt=Object(c.ab)(" ("),Ht=Object(c.ab)(t[7]),_t=Object(c.ab)(")");for(let t=0;t<Ut.length;t+=1)Ut[t].c();At=Object(c.W)(),Et=Object(c.w)("div"),Tt=Object(c.w)("a"),Pt=Object(c.ab)("⬇ Download Parsed Subtitles"),Nt=Object(c.W)(),Rt=Object(c.w)("div"),Rt.innerHTML='<a target="_blank" href="https://github.com/sheodox/jimaku-player/issues" rel="noopener noreferrer" class="svelte-dr1m8c">Issue? Report it here!</a>',n.disabled=r="recent"===t[3],l.disabled=b="setup"===t[3],u.disabled=f="settings"===t[3],Object(c.g)(e,"class","tray-tab-buttons svelte-dr1m8c"),Object(c.g)(O,"class","svelte-dr1m8c"),Object(c.g)(m,"class","recent-subs svelte-dr1m8c"),Object(c.g)(p,"class","tab tab-recent svelte-dr1m8c"),Object(c.cb)(p,"tab-active","recent"===t[3]),Object(c.g)(v,"class","svelte-dr1m8c"),Object(c.g)(k,"class","secondary"),Object(c.g)(w,"class","row svelte-dr1m8c"),Object(c.g)(S,"class","svelte-dr1m8c"),Object(c.g)(F,"class","row svelte-dr1m8c"),Object(c.g)(K,"class","secondary"),Object(c.g)(R,"class","secondary"),Object(c.g)(P,"class","row svelte-dr1m8c"),Object(c.g)(I,"class","svelte-dr1m8c"),Object(c.g)(x,"class","tab svelte-dr1m8c"),Object(c.cb)(x,"tab-active","setup"===t[3]),Object(c.g)(J,"class","svelte-dr1m8c"),Object(c.g)(Z,"for","subtitle-color"),Object(c.g)(ct,"type","color"),Object(c.g)(ct,"id","subtitle-color"),Object(c.g)(U,"class","row svelte-dr1m8c"),Object(c.g)(ot,"id","show-subs"),Object(c.g)(ot,"type","checkbox"),Object(c.g)(it,"for","show-subs"),Object(c.g)(rt,"class","row svelte-dr1m8c"),Object(c.g)(ut,"id","pause-on-tray"),Object(c.g)(ut,"type","checkbox"),Object(c.g)(ft,"for","pause-on-tray"),Object(c.g)(at,"class","row svelte-dr1m8c"),Object(c.g)(Ot,"id","invert-subtitle-alignment"),Object(c.g)(Ot,"type","checkbox"),Object(c.g)(mt,"for","invert-subtitle-alignment"),Object(c.g)(pt,"class","row svelte-dr1m8c"),Object(c.g)(xt,"class","svelte-dr1m8c"),Object(c.g)(wt,"class","svelte-dr1m8c"),Object(c.g)(kt,"class","svelte-dr1m8c"),Object(c.g)(St,"class","svelte-dr1m8c"),Object(c.g)(Ct,"class","svelte-dr1m8c"),Object(c.g)(Tt,"href",Kt=t[15]()),Object(c.g)(Tt,"download","parsed-subtitles.json"),Object(c.g)(Tt,"class","svelte-dr1m8c"),Object(c.g)(Et,"class","row svelte-dr1m8c"),Object(c.g)(Rt,"class","row svelte-dr1m8c"),Object(c.g)(q,"class","tab tab-settings svelte-dr1m8c"),Object(c.cb)(q,"tab-active","settings"===t[3])},m(r,b){Object(c.F)(r,e,b),Object(c.e)(e,n),Object(c.e)(n,s),Object(c.e)(e,o),Object(c.e)(e,l),Object(c.e)(l,i),Object(c.e)(e,a),Object(c.e)(e,u),Object(c.e)(u,d),Object(c.F)(r,j,b),Object(c.F)(r,p,b),Object(c.e)(p,O),Object(c.e)(p,g),Object(c.e)(p,m);for(let t=0;t<Bt.length;t+=1)Bt[t].m(m,null);Object(c.F)(r,h,b),Object(c.F)(r,x,b),Object(c.e)(x,v),Object(c.e)(x,y),Object(c.e)(x,w),Object(c.e)(w,k),Object(c.e)(x,$),Object(c.e)(x,S),Object(c.e)(x,C),Object(c.e)(x,F),Object(c.e)(F,W),Object(c.e)(W,H),Object(c.e)(W,_),Object(c.e)(W,A),Object(c.e)(W,E),Object(c.e)(x,T),Object(c.e)(x,P),Object(c.e)(P,K),Object(c.e)(P,N),Object(c.e)(P,R),Object(c.e)(x,M),Object(c.e)(x,I),Object(c.e)(x,z),Lt&&Lt.m(x,null),Object(c.e)(x,B),Object(c.J)(G,x,null),Object(c.F)(r,V,b),Object(c.F)(r,q,b),Object(c.e)(q,J),Object(c.e)(q,L),Object(c.e)(q,U),Object(c.e)(U,Z),Object(c.e)(U,Q),Object(c.e)(U,ct),Object(c.U)(ct,t[9]),Object(c.e)(q,st),Object(c.e)(q,rt),Object(c.e)(rt,ot),ot.checked=t[10],Object(c.e)(rt,lt),Object(c.e)(rt,it),Object(c.e)(q,bt),Object(c.e)(q,at),Object(c.e)(at,ut),ut.checked=t[8],Object(c.e)(at,dt),Object(c.e)(at,ft),Object(c.e)(q,jt),Object(c.e)(q,pt),Object(c.e)(pt,Ot),Ot.checked=t[11],Object(c.e)(pt,gt),Object(c.e)(pt,mt),Object(c.e)(q,ht),Object(c.e)(q,xt),Object(c.e)(q,vt),Object(c.e)(q,yt),Object(c.e)(yt,wt),Object(c.e)(yt,kt),Object(c.e)(kt,$t),Object(c.e)(yt,St),Object(c.e)(yt,Ct),Object(c.e)(Ct,Ft),Object(c.e)(Ct,Wt),Object(c.e)(Ct,Ht),Object(c.e)(Ct,_t);for(let t=0;t<Ut.length;t+=1)Ut[t].m(yt,null);Object(c.e)(q,At),Object(c.e)(q,Et),Object(c.e)(Et,Tt),Object(c.e)(Tt,Pt),Object(c.e)(q,Nt),Object(c.e)(q,Rt),Mt=!0,It||(zt=[Object(c.H)(n,"click",t[18]),Object(c.H)(l,"click",t[19]),Object(c.H)(u,"click",t[20]),Object(c.H)(k,"click",t[22]),Object(c.H)(K,"click",t[23]),Object(c.H)(R,"click",t[24]),Object(c.H)(ct,"input",t[25]),Object(c.H)(ot,"change",t[26]),Object(c.H)(ut,"change",t[27]),Object(c.H)(Ot,"change",t[28])],It=!0)},p(t,e){if((!Mt||8&e[0]&&r!==(r="recent"===t[3]))&&(n.disabled=r),(!Mt||8&e[0]&&b!==(b="setup"===t[3]))&&(l.disabled=b),(!Mt||8&e[0]&&f!==(f="settings"===t[3]))&&(u.disabled=f),20481&e[0]){const n=t[0];Object(c.C)();for(let t=0;t<Bt.length;t+=1)Bt[t].r();Bt=Object(c.fb)(Bt,e,Jt,1,t,n,Gt,m,c.y,tt,null,X);for(let t=0;t<Bt.length;t+=1)Bt[t].a();Object(c.j)()}if(8&e[0]&&Object(c.cb)(p,"tab-active","recent"===t[3]),(!Mt||64&e[0])&&Object(c.T)(H,t[6]),(!Mt||128&e[0])&&Object(c.T)(A,t[7]),t[8]?Lt?Lt.p(t,e):(Lt=et(t),Lt.c(),Lt.m(x,B)):Lt&&(Lt.d(1),Lt=null),8&e[0]&&Object(c.cb)(x,"tab-active","setup"===t[3]),512&e[0]&&Object(c.U)(ct,t[9]),1024&e[0]&&(ot.checked=t[10]),256&e[0]&&(ut.checked=t[8]),2048&e[0]&&(Ot.checked=t[11]),(!Mt||2&e[0])&&Vt!==(Vt=t[1].fileName+"")&&Object(c.T)($t,Vt),(!Mt||64&e[0])&&Object(c.T)(Ft,t[6]),(!Mt||128&e[0])&&Object(c.T)(Ht,t[7]),2&e[0]){let n;for(Dt=t[1].debugInfo(),n=0;n<Dt.length;n+=1){const c=Y(t,Dt,n);Ut[n]?Ut[n].p(c,e):(Ut[n]=nt(c),Ut[n].c(),Ut[n].m(yt,null))}for(;n<Ut.length;n+=1)Ut[n].d(1);Ut.length=Dt.length}8&e[0]&&Object(c.cb)(q,"tab-active","settings"===t[3])},i(t){if(!Mt){for(let t=0;t<qt.length;t+=1)Object(c.db)(Bt[t]);Object(c.db)(G.$$.fragment,t),Mt=!0}},o(t){for(let t=0;t<Bt.length;t+=1)Object(c.eb)(Bt[t]);Object(c.eb)(G.$$.fragment,t),Mt=!1},d(t){t&&Object(c.v)(e),t&&Object(c.v)(j),t&&Object(c.v)(p);for(let t=0;t<Bt.length;t+=1)Bt[t].d();t&&Object(c.v)(h),t&&Object(c.v)(x),Lt&&Lt.d(),Object(c.t)(G),t&&Object(c.v)(V),t&&Object(c.v)(q),Object(c.u)(Ut,t),It=!1,Object(c.R)(zt)}}}function Q(t){let e,n,s,r,o,l,i;return{c(){e=Object(c.w)("div"),n=Object(c.w)("div"),s=Object(c.w)("button"),s.textContent="Select Subtitles",r=Object(c.W)(),o=Object(c.w)("div"),o.innerHTML='<a target="_blank" href="https://github.com/sheodox/jimaku-player/issues" rel="noopener noreferrer" class="svelte-dr1m8c">Issue? Report it here!</a>',Object(c.g)(n,"class","row svelte-dr1m8c"),Object(c.g)(o,"class","row svelte-dr1m8c"),Object(c.g)(e,"class","tab tab-active tab-cancelled svelte-dr1m8c")},m(b,a){Object(c.F)(b,e,a),Object(c.e)(e,n),Object(c.e)(n,s),Object(c.e)(e,r),Object(c.e)(e,o),l||(i=Object(c.H)(s,"click",t[17]),l=!0)},p:c.K,i:c.K,o:c.K,d(t){t&&Object(c.v)(e),l=!1,i()}}}function tt(t,e){let n,s,r,o,l,i,b,a,u,d,f,j,p=(e[38].text||"").trim()+"",g=c.K;return{key:t,first:null,c(){n=Object(c.w)("li"),s=Object(c.w)("a"),r=Object(c.ab)(p),l=Object(c.W)(),Object(c.g)(s,"target","_blank"),Object(c.g)(s,"href",o=`https://jisho.org/search/${encodeURIComponent(e[38].text.trim())}`),Object(c.g)(s,"rel","noopener noreferrer"),Object(c.g)(s,"class","svelte-dr1m8c"),Object(c.g)(n,"style",i=e[14](e[40])),Object(c.g)(n,"class","svelte-dr1m8c"),this.first=n},m(t,o){Object(c.F)(t,n,o),Object(c.e)(n,s),Object(c.e)(s,r),Object(c.e)(n,l),d=!0,f||(j=Object(c.H)(s,"click",e[21]),f=!0)},p(t,e){(!d||1&e[0])&&p!==(p=(t[38].text||"").trim()+"")&&Object(c.T)(r,p),(!d||1&e[0]&&o!==(o=`https://jisho.org/search/${encodeURIComponent(t[38].text.trim())}`))&&Object(c.g)(s,"href",o),(!d||1&e[0]&&i!==(i=t[14](t[40])))&&Object(c.g)(n,"style",i)},r(){u=n.getBoundingClientRect()},f(){Object(c.z)(n),g(),Object(c.d)(n,u)},a(){g(),g=Object(c.n)(n,u,m,{duration:200})},i(t){d||(Object(c.c)(()=>{a&&a.end(1),b||(b=Object(c.q)(n,O.b,{y:-50,duration:200})),b.start()}),d=!0)},o(t){b&&b.invalidate(),a=Object(c.r)(n,O.b,{y:50,duration:200}),d=!1},d(t){t&&Object(c.v)(n),t&&a&&a.end(),f=!1,j()}}}function et(t){let e,n,s;return{c(){e=Object(c.w)("button"),e.textContent="Resume Video",Object(c.g)(e,"id","resume-button"),Object(c.g)(e,"class","secondary svelte-dr1m8c")},m(t,r){Object(c.F)(t,e,r),n||(s=Object(c.H)(e,"click",rt),n=!0)},p:c.K,d(t){t&&Object(c.v)(e),n=!1,s()}}}function nt(t){let e,n,s,r,o=t[35].title+"",l=t[35].detail+"";return{c(){e=Object(c.w)("dt"),n=Object(c.ab)(o),s=Object(c.w)("dd"),r=Object(c.ab)(l),Object(c.g)(e,"class","svelte-dr1m8c"),Object(c.g)(s,"class","svelte-dr1m8c")},m(t,o){Object(c.F)(t,e,o),Object(c.e)(e,n),Object(c.F)(t,s,o),Object(c.e)(s,r)},p(t,e){2&e[0]&&o!==(o=t[35].title+"")&&Object(c.T)(n,o),2&e[0]&&l!==(l=t[35].detail+"")&&Object(c.T)(r,l)},d(t){t&&Object(c.v)(e),t&&Object(c.v)(s)}}}function ct(t){let e,n;return e=new R({}),e.$on("close",t[29]),{c(){Object(c.p)(e.$$.fragment)},m(t,s){Object(c.J)(e,t,s),n=!0},p:c.K,i(t){n||(Object(c.db)(e.$$.fragment,t),n=!0)},o(t){Object(c.eb)(e.$$.fragment,t),n=!1},d(t){Object(c.t)(e,t)}}}function st(t){let e,n,s,r,o,l,i,b,a,u,d,f;const j=[Q,Z],p=[];function O(t,e){return"cancelled"===t[2]?0:"normal"===t[2]?1:-1}~(r=O(t))&&(o=p[r]=j[r](t));let g=t[4]&&ct(t);return{c(){e=Object(c.w)("div"),n=Object(c.w)("h1"),n.textContent="字幕プレーヤー",s=Object(c.W)(),o&&o.c(),l=Object(c.W)(),i=Object(c.w)("div"),i.innerHTML='<a target="_blank" href="https://discord.gg/Vyjjyj4" rel="noopener noreferrer" class="svelte-dr1m8c">Release notes and discussion here on Discord!</a>',b=Object(c.W)(),g&&g.c(),a=Object(c.x)(),Object(c.g)(n,"class","svelte-dr1m8c"),Object(c.g)(i,"class","row svelte-dr1m8c"),Object(c.g)(e,"class","tray svelte-dr1m8c"),Object(c.V)(e,"right",t[5]+"rem"),Object(c.cb)(e,"hidden",t[4])},m(o,j){Object(c.F)(o,e,j),Object(c.e)(e,n),Object(c.e)(e,s),~r&&p[r].m(e,null),Object(c.e)(e,l),Object(c.e)(e,i),Object(c.F)(o,b,j),g&&g.m(o,j),Object(c.F)(o,a,j),u=!0,d||(f=[Object(c.H)(e,"mouseenter",t[16](!0)),Object(c.H)(e,"mouseleave",t[16](!1))],d=!0)},p(t,n){let s=r;r=O(t),r===s?~r&&p[r].p(t,n):(o&&(Object(c.C)(),Object(c.eb)(p[s],1,1,()=>{p[s]=null}),Object(c.j)()),~r?(o=p[r],o||(o=p[r]=j[r](t),o.c()),Object(c.db)(o,1),o.m(e,l)):o=null),(!u||32&n[0])&&Object(c.V)(e,"right",t[5]+"rem"),16&n[0]&&Object(c.cb)(e,"hidden",t[4]),t[4]?g?(g.p(t,n),16&n[0]&&Object(c.db)(g,1)):(g=ct(t),g.c(),Object(c.db)(g,1),g.m(a.parentNode,a)):g&&(Object(c.C)(),Object(c.eb)(g,1,1,()=>{g=null}),Object(c.j)())},i(t){u||(Object(c.db)(o),Object(c.db)(g),u=!0)},o(t){Object(c.eb)(o),Object(c.eb)(g),u=!1},d(t){t&&Object(c.v)(e),~r&&p[r].d(),t&&Object(c.v)(b),g&&g.d(t),t&&Object(c.v)(a),d=!1,Object(c.R)(f)}}}function rt(){document.querySelector("video").play()}function ot(t,e,n){let r,o,i,b,a,u,O;Object(c.k)(t,T,t=>n(6,o=t)),Object(c.k)(t,E,t=>n(7,i=t)),Object(c.k)(t,j,t=>n(8,b=t)),Object(c.k)(t,d,t=>n(9,a=t)),Object(c.k)(t,f,t=>n(10,u=t)),Object(c.k)(t,p,t=>n(11,O=t));const m=Object(s.a)(),h=-26,v=0,y=function(t,e={}){const n=l(t);let s,r=t;function o(o,l){if(null==t)return n.set(t=o),Promise.resolve();r=o;let i=s,b=!1,{delay:a=0,duration:u=400,easing:d=g.c,interpolate:f=x}=Object(c.f)(Object(c.f)({},e),l);if(0===u)return i&&(i.abort(),i=null),n.set(t=r),Promise.resolve();const j=Object(c.L)()+a;let p;return s=Object(c.I)(e=>{if(e<j)return!0;b||(p=f(t,o),"function"==typeof u&&(u=u(t,o)),b=!0),i&&(i.abort(),i=null);const c=e-j;return c>u?(n.set(t=o),!1):(n.set(t=p(d(c/u))),!0)}),s.promise}return{set:o,update:(e,n)=>o(e(r,t),n),subscribe:n.subscribe}}(h,{duration:300,easing:g.b});Object(c.k)(t,y,t=>n(5,r=t));let{recentSubs:w=[]}=e,{subtitles:k={}}=e,{mode:$="normal"}=e;let S="recent",C=!1;return t.$$set=t=>{"recentSubs"in t&&n(0,w=t.recentSubs),"subtitles"in t&&n(1,k=t.subtitles),"mode"in t&&n(2,$=t.mode)},[w,k,$,S,C,r,o,i,b,a,u,O,m,y,function(t){return`font-size: ${20*(.5+(t+1)/w.length*.5)}px`},function(){const t=new Blob([k.serialize()],{type:"application/json"});return URL.createObjectURL(t)},function(t){return()=>{y.set(t?v:h),t&&!Object(c.A)(j)||m("tray-pauser",t)}},()=>m("restart"),()=>n(3,S="recent"),()=>n(3,S="setup"),()=>n(3,S="settings"),()=>m("define-pauser"),()=>m("restart"),()=>m("realign"),()=>n(4,C=!0),function(){a=this.value,d.set(a)},function(){u=this.checked,f.set(u)},function(){b=this.checked,j.set(b)},function(){O=this.checked,p.set(O)},()=>n(4,C=!1)]}class lt extends c.a{constructor(t){var e;super(),U.getElementById("svelte-dr1m8c-style")||((e=Object(c.w)("style")).id="svelte-dr1m8c-style",e.textContent='.tray.svelte-dr1m8c.svelte-dr1m8c{width:28rem;margin-top:0.5rem;background:rgba(255, 255, 255, 0.2);position:fixed;right:0;top:0;color:white;height:calc(100% - 5rem);display:flex;flex-direction:column;text-align:center}.tray.svelte-dr1m8c>.svelte-dr1m8c{visibility:hidden}.tray.svelte-dr1m8c.svelte-dr1m8c:hover{background:#111218;overflow:auto;border-radius:3px}.tray.svelte-dr1m8c:hover>.svelte-dr1m8c{visibility:visible}.tray.svelte-dr1m8c h1.svelte-dr1m8c{font-size:2rem;padding:0.5rem 0;border-radius:3px;margin:0}.tray.svelte-dr1m8c h2.svelte-dr1m8c{text-decoration:underline;margin:0 0 0.4rem}ul.svelte-dr1m8c.svelte-dr1m8c{list-style:none;padding:0;display:flex;flex-direction:column-reverse}a.svelte-dr1m8c.svelte-dr1m8c{color:white;transform:scaleY(0);transform-origin:top;transition:transform 0.5s ease;font-family:"Source Han Sans", "源ノ角ゴシック", "Hiragino Sans", "HiraKakuProN-W3", "Hiragino Kaku Gothic ProN W3", "Hiragino Kaku Gothic ProN", "ヒラギノ角ゴ ProN W3", "Noto Sans", "Noto Sans CJK JP", "メイリオ", Meiryo, "游ゴシック", YuGothic, "ＭＳ Ｐゴシック", "MS PGothic", "ＭＳ ゴシック", "MS Gothic", sans-serif}.tab-recent.svelte-dr1m8c a.svelte-dr1m8c:not(:hover){text-decoration:none}a.svelte-dr1m8c.svelte-dr1m8c:hover{color:#0aff8c;cursor:pointer;text-decoration:underline}li.svelte-dr1m8c.svelte-dr1m8c{padding-bottom:0.2rem}li.svelte-dr1m8c a.svelte-dr1m8c{white-space:pre}li.svelte-dr1m8c.svelte-dr1m8c:not(:first-of-type)::after{content:\' \';height:0;position:relative;border:1px solid #4a4a6a;display:block;margin:0 auto;border-radius:4px}dt.svelte-dr1m8c.svelte-dr1m8c{font-weight:bold}dd.svelte-dr1m8c.svelte-dr1m8c{font-style:italic}.tab.svelte-dr1m8c.svelte-dr1m8c{display:none;text-align:left;padding:2rem;background:#1c1825;border-top:2px solid #f47521}.tab-active.svelte-dr1m8c.svelte-dr1m8c{display:block;flex:1}.tray-tab-buttons.svelte-dr1m8c.svelte-dr1m8c{margin:0.2rem}.row.svelte-dr1m8c.svelte-dr1m8c:not(:last-child){margin-bottom:0.5rem}.tab-cancelled.svelte-dr1m8c.svelte-dr1m8c{text-align:center}.hidden.svelte-dr1m8c.svelte-dr1m8c{display:none}h3.svelte-dr1m8c.svelte-dr1m8c{margin:0}#resume-button.svelte-dr1m8c.svelte-dr1m8c{width:100%}kbd.svelte-dr1m8c.svelte-dr1m8c{color:white;background:#2f2d2d;border:1px solid #444;border-radius:0.2rem;padding:0 0.2rem;font-family:monospace}.muted.svelte-dr1m8c.svelte-dr1m8c{color:#5b5c6f}',Object(c.e)(U.head,e)),Object(c.E)(this,t,ot,st,c.S,{recentSubs:0,subtitles:1,mode:2},[-1,-1])}}var it=lt;function bt(t,e,n){const c=t.slice();return c[14]=e[n],c}function at(t,e,n){const c=t.slice();return c[11]=e[n],c}function ut(t){let e,n,s=[],r=new Map,o=t[0];const l=t=>t[11].text;for(let e=0;e<o.length;e+=1){let n=at(t,o,e),c=l(n);r.set(c,s[e]=pt(c,n))}return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=Object(c.x)()},m(t,r){for(let e=0;e<s.length;e+=1)s[e].m(t,r);Object(c.F)(t,e,r),n=!0},p(t,n){if(13&n){const o=t[0];Object(c.C)(),s=Object(c.fb)(s,n,l,1,t,o,r,e.parentNode,c.O,pt,e,at),Object(c.j)()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)Object(c.db)(s[t]);n=!0}},o(t){for(let t=0;t<s.length;t+=1)Object(c.eb)(s[t]);n=!1},d(t){for(let e=0;e<s.length;e+=1)s[e].d(t);t&&Object(c.v)(e)}}}function dt(t){let e,n=t[11].text+"";return{c(){e=Object(c.ab)(n)},m(t,n){Object(c.F)(t,e,n)},p(t,s){1&s&&n!==(n=t[11].text+"")&&Object(c.T)(e,n)},i:c.K,o:c.K,d(t){t&&Object(c.v)(e)}}}function ft(t){let e,n,s=t[11].phrases,r=[];for(let e=0;e<s.length;e+=1)r[e]=jt(bt(t,s,e));const o=t=>Object(c.eb)(r[t],1,1,()=>{r[t]=null});return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=Object(c.x)()},m(t,s){for(let e=0;e<r.length;e+=1)r[e].m(t,s);Object(c.F)(t,e,s),n=!0},p(t,n){if(1&n){let l;for(s=t[11].phrases,l=0;l<s.length;l+=1){const o=bt(t,s,l);r[l]?(r[l].p(o,n),Object(c.db)(r[l],1)):(r[l]=jt(o),r[l].c(),Object(c.db)(r[l],1),r[l].m(e.parentNode,e))}for(Object(c.C)(),l=s.length;l<r.length;l+=1)o(l);Object(c.j)()}},i(t){if(!n){for(let t=0;t<s.length;t+=1)Object(c.db)(r[t]);n=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)Object(c.eb)(r[t]);n=!1},d(t){Object(c.u)(r,t),t&&Object(c.v)(e)}}}function jt(t){let e,n,s,r,o,l,i=t[14].text+"";return{c(){e=Object(c.w)("span"),n=Object(c.ab)(i),Object(c.g)(e,"style",s=mt(t[14]))},m(t,s){Object(c.F)(t,e,s),Object(c.e)(e,n),l=!0},p(r,o){t=r,(!l||1&o)&&i!==(i=t[14].text+"")&&Object(c.T)(n,i),(!l||1&o&&s!==(s=mt(t[14])))&&Object(c.g)(e,"style",s)},i(n){l||(Object(c.c)(()=>{o&&o.end(1),r||(r=Object(c.q)(e,O.a,ht(t[14].fadeIn))),r.start()}),l=!0)},o(n){r&&r.invalidate(),o=Object(c.r)(e,O.a,ht(t[14].fadeOut)),l=!1},d(t){t&&Object(c.v)(e),t&&o&&o.end()}}}function pt(t,e){let n,s,r,o,l,i,b,a,u;const d=[ft,dt],f=[];function j(t,e){return t[11].phrases?0:1}function p(...t){return e[6](e[11],...t)}return s=j(e),r=f[s]=d[s](e),{key:t,first:null,c(){n=Object(c.w)("p"),r.c(),o=Object(c.W)(),Object(c.g)(n,"style",l=e[3](e[11])),Object(c.g)(n,"data-sub-style",i=e[11].style),Object(c.g)(n,"title","click to search this phrase on Jisho.org"),Object(c.g)(n,"class","svelte-nduvur"),this.first=n},m(t,e){Object(c.F)(t,n,e),f[s].m(n,null),Object(c.e)(n,o),b=!0,a||(u=Object(c.H)(n,"click",p),a=!0)},p(t,a){let u=s;s=j(e=t),s===u?f[s].p(e,a):(Object(c.C)(),Object(c.eb)(f[u],1,1,()=>{f[u]=null}),Object(c.j)(),r=f[s],r||(r=f[s]=d[s](e),r.c()),Object(c.db)(r,1),r.m(n,o)),(!b||1&a&&l!==(l=e[3](e[11])))&&Object(c.g)(n,"style",l),(!b||1&a&&i!==(i=e[11].style))&&Object(c.g)(n,"data-sub-style",i)},i(t){b||(Object(c.db)(r),b=!0)},o(t){Object(c.eb)(r),b=!1},d(t){t&&Object(c.v)(n),f[s].d(),a=!1,u()}}}function Ot(t){let e,n,s=t[1]&&ut(t);return{c(){e=Object(c.w)("div"),s&&s.c(),Object(c.g)(e,"class","subtitles")},m(t,r){Object(c.F)(t,e,r),s&&s.m(e,null),n=!0},p(t,[n]){t[1]?s?(s.p(t,n),2&n&&Object(c.db)(s,1)):(s=ut(t),s.c(),Object(c.db)(s,1),s.m(e,null)):s&&(Object(c.C)(),Object(c.eb)(s,1,1,()=>{s=null}),Object(c.j)())},i(t){n||(Object(c.db)(s),n=!0)},o(t){Object(c.eb)(s),n=!1},d(t){t&&Object(c.v)(e),s&&s.d()}}}function gt(t){return t.filter(t=>!!t).join(";")}function mt(t){return gt([t.inline])}function ht(t){return"number"!=typeof t&&(t=0),{delay:0,duration:t}}function xt(t,e,n){let r;Object(c.k)(t,f,t=>n(1,r=t));let{current:o=[]}=e,{styles:l={}}=e,{format:i=""}=e;const b=Object(s.a)();let a,u;const j=[d.subscribe(t=>{a=t}),p.subscribe(t=>{u=t?"inverted":"normal"})];function O(t){b("define-pauser"),window.open(`https://jisho.org/search/${encodeURIComponent(t.trim())}`)}Object(s.b)(()=>{j.forEach(t=>t())});return t.$$set=t=>{"current"in t&&n(0,o=t.current),"styles"in t&&n(4,l=t.styles),"format"in t&&n(5,i=t.format)},[o,r,O,function(t){let e=[`color: ${a}`];if("ass"===i&&t.style in l){const n=l[t.style];e.push(n.inline),e.push(n.verticalAlignment[u])}return t.verticalAlignment&&e.push(t.verticalAlignment[u]),e=e.concat([t.inline||""]),gt(e)},l,i,t=>O(t.text)]}class vt extends c.a{constructor(t){var e;super(),document.getElementById("svelte-nduvur-style")||((e=Object(c.w)("style")).id="svelte-nduvur-style",e.textContent='p.svelte-nduvur{cursor:pointer;color:white;margin:0;padding:0;white-space:pre;font-family:"Source Han Sans", "源ノ角ゴシック", "Hiragino Sans", "HiraKakuProN-W3", "Hiragino Kaku Gothic ProN W3", "Hiragino Kaku Gothic ProN", "ヒラギノ角ゴ ProN W3", "Noto Sans", "Noto Sans CJK JP", "メイリオ", Meiryo, "游ゴシック", YuGothic, "ＭＳ Ｐゴシック", "MS PGothic", "ＭＳ ゴシック", "MS Gothic", sans-serif;text-align:center}p.svelte-nduvur:hover{color:#0aff8c !important}',Object(c.e)(document.head,e)),Object(c.E)(this,t,xt,Ot,c.S,{current:0,styles:4,format:5})}}var yt=vt;class wt{constructor(){this.video=null,this.reasons=[]}setVideo(t){this.reasons=[],this.video=t}addPauser(t){this.reasons.includes("user-paused")&&!this.video.paused&&this.reasons.splice(this.reasons.indexOf("user-paused")),0===this.reasons.length&&this.video.paused&&this.reasons.push("user-paused"),this.reasons.includes(t)||this.reasons.push(t),this._checkPause()}removePauser(t){const e=this.reasons.indexOf(t);-1!==e&&(this.reasons.splice(e,1),this._checkPause())}_checkPause(){this.reasons.length?this.video.pause():this.video.play()}}var kt=n(15),$t=n.n(kt),St=n(14),Ct=n.n(St);const Ft={"line-left":"0%",center:"-50%","line-right":"-100%"};class Wt extends Ct.a{constructor(t,e){super("srt",e);const n=t.replace(/\r/g,"").split("\n\n");this.subs=n.reduce((t,e)=>{let n=e.trim().split("\n");function c(){n.shift()}try{/^\d*$/.test(n[0])&&c();let[e,s]=n[0].replace(/,/g,".").match(/^([\d:\.\-> ]*)/)[0].split(/\-\->/),r=n[0].match(/([a-zA-Z].*)/);r=r&&r.length?r[1]:"";let o=[],l=[];const i=n.length-1,b=(t,e)=>{const n=r.match(new RegExp(`${t}:([\\d\\.]*)%`));return n?parseInt(n[1],10):e},a=t=>{const e=r.match(new RegExp(`${t}:([w-]*?)`));if(e)return e[1]},u=()=>{const t=r.match(/position:([\d.]*)%(?:,(\w*))?/);return t?{position:parseInt(t[1]),positionAlignment:"middle"===t[2]?"center":t[2]}:{position:50,positionAlignment:"center"}},d=5;let{position:f,positionAlignment:j="center"}=u(),p=(a("align"),b("line",90-i*d)),O=b("size",100);l.push(`position: fixed; left: ${f}vw`),j&&j in Ft&&o.push(`transform: translateX(${Ft[j]})`),o.push(`display:block; width: ${O}vw`),c();const g=n.join("\n").replace(/<\/?c.Japanese>/g,"");o.push(`font-size: ${d}vh`),o.push("text-shadow: -4px -4px 0px rgba(9, 9, 9, 255), -4px -3px 0px rgba(9, 9, 9, 255), -4px -2px 0px rgba(9, 9, 9, 255), -4px -1px 0px rgba(9, 9, 9, 255), -4px 0px 0px rgba(9, 9, 9, 255), -4px 1px 0px rgba(9, 9, 9, 255), -4px 2px 0px rgba(9, 9, 9, 255), -4px 3px 0px rgba(9, 9, 9, 255), -4px 4px 0px rgba(9, 9, 9, 255), -3px -4px 0px rgba(9, 9, 9, 255), -3px -3px 0px rgba(9, 9, 9, 255), -3px -2px 0px rgba(9, 9, 9, 255), -3px -1px 0px rgba(9, 9, 9, 255), -3px 0px 0px rgba(9, 9, 9, 255), -3px 1px 0px rgba(9, 9, 9, 255), -3px 2px 0px rgba(9, 9, 9, 255), -3px 3px 0px rgba(9, 9, 9, 255), -3px 4px 0px rgba(9, 9, 9, 255), -2px -4px 0px rgba(9, 9, 9, 255), -2px -3px 0px rgba(9, 9, 9, 255), -2px -2px 0px rgba(9, 9, 9, 255), -2px -1px 0px rgba(9, 9, 9, 255), -2px 0px 0px rgba(9, 9, 9, 255), -2px 1px 0px rgba(9, 9, 9, 255), -2px 2px 0px rgba(9, 9, 9, 255), -2px 3px 0px rgba(9, 9, 9, 255), -2px 4px 0px rgba(9, 9, 9, 255), -1px -4px 0px rgba(9, 9, 9, 255), -1px -3px 0px rgba(9, 9, 9, 255), -1px -2px 0px rgba(9, 9, 9, 255), -1px -1px 0px rgba(9, 9, 9, 255), -1px 0px 0px rgba(9, 9, 9, 255), -1px 1px 0px rgba(9, 9, 9, 255), -1px 2px 0px rgba(9, 9, 9, 255), -1px 3px 0px rgba(9, 9, 9, 255), -1px 4px 0px rgba(9, 9, 9, 255), 0px -4px 0px rgba(9, 9, 9, 255), 0px -3px 0px rgba(9, 9, 9, 255), 0px -2px 0px rgba(9, 9, 9, 255), 0px -1px 0px rgba(9, 9, 9, 255), 0px 0px 0px rgba(9, 9, 9, 255), 0px 1px 0px rgba(9, 9, 9, 255), 0px 2px 0px rgba(9, 9, 9, 255), 0px 3px 0px rgba(9, 9, 9, 255), 0px 4px 0px rgba(9, 9, 9, 255), 1px -4px 0px rgba(9, 9, 9, 255), 1px -3px 0px rgba(9, 9, 9, 255), 1px -2px 0px rgba(9, 9, 9, 255), 1px -1px 0px rgba(9, 9, 9, 255), 1px 0px 0px rgba(9, 9, 9, 255), 1px 1px 0px rgba(9, 9, 9, 255), 1px 2px 0px rgba(9, 9, 9, 255), 1px 3px 0px rgba(9, 9, 9, 255), 1px 4px 0px rgba(9, 9, 9, 255), 2px -4px 0px rgba(9, 9, 9, 255), 2px -3px 0px rgba(9, 9, 9, 255), 2px -2px 0px rgba(9, 9, 9, 255), 2px -1px 0px rgba(9, 9, 9, 255), 2px 0px 0px rgba(9, 9, 9, 255), 2px 1px 0px rgba(9, 9, 9, 255), 2px 2px 0px rgba(9, 9, 9, 255), 2px 3px 0px rgba(9, 9, 9, 255), 2px 4px 0px rgba(9, 9, 9, 255), 3px -4px 0px rgba(9, 9, 9, 255), 3px -3px 0px rgba(9, 9, 9, 255), 3px -2px 0px rgba(9, 9, 9, 255), 3px -1px 0px rgba(9, 9, 9, 255), 3px 0px 0px rgba(9, 9, 9, 255), 3px 1px 0px rgba(9, 9, 9, 255), 3px 2px 0px rgba(9, 9, 9, 255), 3px 3px 0px rgba(9, 9, 9, 255), 3px 4px 0px rgba(9, 9, 9, 255), 4px -4px 0px rgba(9, 9, 9, 255), 4px -3px 0px rgba(9, 9, 9, 255), 4px -2px 0px rgba(9, 9, 9, 255), 4px -1px 0px rgba(9, 9, 9, 255), 4px 0px 0px rgba(9, 9, 9, 255), 4px 1px 0px rgba(9, 9, 9, 255), 4px 2px 0px rgba(9, 9, 9, 255), 4px 3px 0px rgba(9, 9, 9, 255), 4px 4px 0px rgba(9, 9, 9, 255), 2px 2px 0px rgba(20, 20, 20, 195)");const m=i*10;t.push({start:this.timeToMs(e),end:this.timeToMs(s),verticalAlignment:{normal:`position: fixed; top: calc(${p}vh - ${m}px);`,inverted:`position: fixed; top: calc(${100-p}vh + ${m}px); transform: translateY(-100%)`},text:g,inline:l.join("; "),phrases:[{text:g,inline:o.join("; ")}]})}catch(t){}return t},[])}serialize(){return JSON.stringify(this.subs,null,4)}debugInfo(){return[{title:"Number of subtitles",detail:this.subs.length}]}}function Ht(t){let e,n,s,r,o,l,i,b;return{c(){e=Object(c.w)("div"),n=Object(c.w)("button"),n.textContent="⨯ Skip Subtitling For This Episode",s=Object(c.W)(),r=Object(c.w)("label"),r.textContent="≡ Select a subtitle file to begin",o=Object(c.W)(),l=Object(c.w)("input"),Object(c.g)(n,"class","small-button secondary svelte-1n5tabm"),Object(c.g)(r,"for","srt-upload"),Object(c.g)(r,"class","svelte-1n5tabm"),Object(c.g)(l,"type","file"),Object(c.g)(l,"id","srt-upload"),Object(c.g)(l,"accept",".srt,.ass,.ssa,.vtt"),Object(c.g)(l,"class","svelte-1n5tabm"),Object(c.g)(e,"class","column svelte-1n5tabm")},m(a,u){Object(c.F)(a,e,u),Object(c.e)(e,n),Object(c.e)(e,s),Object(c.e)(e,r),Object(c.e)(e,o),Object(c.e)(e,l),i||(b=[Object(c.H)(n,"click",t[1]),Object(c.H)(l,"change",t[0])],i=!0)},p:c.K,i:c.K,o:c.K,d(t){t&&Object(c.v)(e),i=!1,Object(c.R)(b)}}}function _t(t){const e=Object(s.a)();return[function(t){const n=t.target.files[0],c=new FileReader;c.onload=t=>{const c={ass:$t.a,ssa:$t.a,srt:Wt,vtt:Wt},[s,r]=n.name.match(/\.(\w{3})$/);e("subtitles-loaded",new c[r](t.target.result,n.name))},c.readAsText(n)},function(){e("cancel")}]}class At extends c.a{constructor(t){var e;super(),document.getElementById("svelte-1n5tabm-style")||((e=Object(c.w)("style")).id="svelte-1n5tabm-style",e.textContent=".column.svelte-1n5tabm.svelte-1n5tabm{display:flex;flex-direction:column}.column.svelte-1n5tabm>.svelte-1n5tabm{align-self:center;margin:0.5rem}label.svelte-1n5tabm.svelte-1n5tabm{background:#fd0;border:none;cursor:pointer;padding:10px;line-height:1;font-weight:bold;color:black;text-transform:uppercase;display:inline-block;font-size:1.2rem}label.svelte-1n5tabm.svelte-1n5tabm:hover{background:#ffea6d}input.svelte-1n5tabm.svelte-1n5tabm{display:none}",Object(c.e)(document.head,e)),Object(c.E)(this,t,_t,Ht,c.S,{})}}var Et=At;const{document:Tt}=c.B;function Pt(t,e,n){const c=t.slice();return c[29]=e[n],c}function Kt(t,e,n){const c=t.slice();return c[26]=e[n],c}function Nt(t){let e;return{c(){e=Object(c.ab)("← Back")},m(t,n){Object(c.F)(t,e,n)},d(t){t&&Object(c.v)(e)}}}function Rt(t){let e;return{c(){e=Object(c.ab)("↺ Reselect Subtitles")},m(t,n){Object(c.F)(t,e,n)},d(t){t&&Object(c.v)(e)}}}function Mt(t){let e,n,s,r,o,l,i,b,a,u,d,f,j;return{c(){e=Object(c.w)("div"),n=Object(c.w)("form"),s=Object(c.w)("label"),s.textContent="Offset subtitle display times (in seconds):",r=Object(c.W)(),o=Object(c.w)("div"),l=Object(c.w)("input"),b=Object(c.W)(),a=Object(c.w)("button"),a.textContent="Use this",u=Object(c.W)(),d=Object(c.w)("p"),d.textContent="Positive numbers will delay subtitles.\n\t\t\t\t\tNegative numbers will show the subtitles earlier.",Object(c.g)(s,"for","manual-alignment"),Object(c.g)(s,"class","svelte-xgf48k"),Object(c.g)(l,"type","text"),Object(c.g)(l,"id","manual-alignment"),Object(c.g)(l,"autocomplete","off"),Object(c.g)(l,"class","svelte-xgf48k"),Object(c.g)(a,"class","svelte-xgf48k"),Object(c.g)(o,"class","row svelte-xgf48k"),Object(c.g)(n,"class","column svelte-xgf48k"),Object(c.g)(d,"class","alignment-sign-hint svelte-xgf48k"),Object(c.g)(e,"class","column svelte-xgf48k")},m(p,O){Object(c.F)(p,e,O),Object(c.e)(e,n),Object(c.e)(n,s),Object(c.e)(n,r),Object(c.e)(n,o),Object(c.e)(o,l),Object(c.U)(l,t[1]),Object(c.e)(o,b),Object(c.e)(o,a),Object(c.e)(e,u),Object(c.e)(e,d),f||(j=[Object(c.H)(l,"input",t[23]),Object(c.H)(l,"keydown",t[10]),Object(c.b)(i=Xt.call(null,l)),Object(c.H)(n,"submit",Object(c.P)(t[11]))],f=!0)},p(t,e){2&e[0]&&l.value!==t[1]&&Object(c.U)(l,t[1])},i:c.K,o:c.K,d(t){t&&Object(c.v)(e),f=!1,Object(c.R)(j)}}}function It(t){let e,n,s,r,o,l,i,b,a,u,d,f,j,p,O,g=0===t[0].length&&Bt(t),m=t[0],h=[];for(let e=0;e<m.length;e+=1)h[e]=Jt(Kt(t,m,e));return{c(){e=Object(c.w)("label"),n=Object(c.ab)("Can't find a line? Search all subtitles:\n\t\t\t\t"),s=Object(c.w)("br"),r=Object(c.W)(),o=Object(c.w)("input"),l=Object(c.W)(),i=Object(c.w)("fieldset"),b=Object(c.w)("legend"),b.textContent="Click a subtitle as soon as you hear it said",a=Object(c.W)(),u=Object(c.w)("div"),g&&g.c(),d=Object(c.W)();for(let t=0;t<h.length;t+=1)h[t].c();f=Object(c.W)(),j=Object(c.w)("button"),j.textContent="Or manually enter an offset...",Object(c.g)(o,"type","text"),Object(c.g)(o,"placeholder","type something you heard"),Object(c.g)(o,"class","svelte-xgf48k"),Object(c.g)(e,"id","subtitle-search"),Object(c.g)(e,"class","svelte-xgf48k"),Object(c.g)(b,"class","svelte-xgf48k"),Object(c.g)(u,"id","subtitle-options"),Object(c.g)(u,"class","column svelte-xgf48k"),Object(c.g)(i,"class","svelte-xgf48k"),Object(c.g)(j,"class","secondary svelte-xgf48k")},m(m,x){Object(c.F)(m,e,x),Object(c.e)(e,n),Object(c.e)(e,s),Object(c.e)(e,r),Object(c.e)(e,o),Object(c.U)(o,t[3]),Object(c.F)(m,l,x),Object(c.F)(m,i,x),Object(c.e)(i,b),Object(c.e)(i,a),Object(c.e)(i,u),g&&g.m(u,null),Object(c.e)(u,d);for(let t=0;t<h.length;t+=1)h[t].m(u,null);Object(c.F)(m,f,x),Object(c.F)(m,j,x),p||(O=[Object(c.H)(o,"input",t[19]),Object(c.H)(j,"click",t[22])],p=!0)},p(t,e){if(8&e[0]&&o.value!==t[3]&&Object(c.U)(o,t[3]),0===t[0].length?g?g.p(t,e):(g=Bt(t),g.c(),g.m(u,d)):g&&(g.d(1),g=null),8193&e[0]){let n;for(m=t[0],n=0;n<m.length;n+=1){const c=Kt(t,m,n);h[n]?h[n].p(c,e):(h[n]=Jt(c),h[n].c(),h[n].m(u,null))}for(;n<h.length;n+=1)h[n].d(1);h.length=m.length}},i:c.K,o:c.K,d(t){t&&Object(c.v)(e),t&&Object(c.v)(l),t&&Object(c.v)(i),g&&g.d(),Object(c.u)(h,t),t&&Object(c.v)(f),t&&Object(c.v)(j),p=!1,Object(c.R)(O)}}}function zt(t){let e,n,s,r,o,l,i;function b(t,e){return t[4]?Dt:Lt}let a=b(t),u=a(t),d=t[6].length&&Ut(t);return{c(){u.c(),e=Object(c.W)(),n=Object(c.w)("button"),n.textContent="Choose a different alignment...",s=Object(c.W)(),d&&d.c(),r=Object(c.x)(),Object(c.g)(n,"class","secondary svelte-xgf48k")},m(b,a){u.m(b,a),Object(c.F)(b,e,a),Object(c.F)(b,n,a),Object(c.F)(b,s,a),d&&d.m(b,a),Object(c.F)(b,r,a),o=!0,l||(i=Object(c.H)(n,"click",t[18]),l=!0)},p(t,n){a===(a=b(t))&&u?u.p(t,n):(u.d(1),u=a(t),u&&(u.c(),u.m(e.parentNode,e))),t[6].length?d?(d.p(t,n),64&n[0]&&Object(c.db)(d,1)):(d=Ut(t),d.c(),Object(c.db)(d,1),d.m(r.parentNode,r)):d&&(Object(c.C)(),Object(c.eb)(d,1,1,()=>{d=null}),Object(c.j)())},i(t){o||(Object(c.db)(d),o=!0)},o(t){Object(c.eb)(d),o=!1},d(t){u.d(t),t&&Object(c.v)(e),t&&Object(c.v)(n),t&&Object(c.v)(s),d&&d.d(t),t&&Object(c.v)(r),l=!1,i()}}}function Bt(t){let e,n,s,r;return{c(){e=Object(c.w)("p"),n=Object(c.ab)('No subtitles matching "'),s=Object(c.ab)(t[3]),r=Object(c.ab)('".'),Object(c.g)(e,"class","svelte-xgf48k")},m(t,o){Object(c.F)(t,e,o),Object(c.e)(e,n),Object(c.e)(e,s),Object(c.e)(e,r)},p(t,e){8&e[0]&&Object(c.T)(s,t[3])},d(t){t&&Object(c.v)(e)}}}function Gt(t){let e,n,s,r,o,l,i,b,a,u=t[26].offset+"",d=t[26].text.trim()+"";function f(...e){return t[21](t[26],...e)}return{c(){e=Object(c.w)("button"),n=Object(c.ab)("("),s=Object(c.ab)(u),r=Object(c.ab)(")"),o=Object(c.w)("br"),l=Object(c.ab)(d),i=Object(c.W)(),Object(c.g)(e,"class","svelte-xgf48k")},m(t,u){Object(c.F)(t,e,u),Object(c.e)(e,n),Object(c.e)(e,s),Object(c.e)(e,r),Object(c.e)(e,o),Object(c.e)(e,l),Object(c.e)(e,i),b||(a=Object(c.H)(e,"click",f),b=!0)},p(e,n){t=e,1&n[0]&&u!==(u=t[26].offset+"")&&Object(c.T)(s,u),1&n[0]&&d!==(d=t[26].text.trim()+"")&&Object(c.T)(l,d)},d(t){t&&Object(c.v)(e),b=!1,a()}}}function Vt(t){let e,n,s,r,o,l,i,b=t[26].sub.text.trim()+"",a=t[26].subsequent,u=[];for(let e=0;e<a.length;e+=1)u[e]=qt(Pt(t,a,e));return{c(){e=Object(c.w)("div"),n=Object(c.w)("fieldset"),s=Object(c.w)("legend"),r=Object(c.ab)(b),o=Object(c.W)(),l=Object(c.w)("div");for(let t=0;t<u.length;t+=1)u[t].c();i=Object(c.W)(),Object(c.g)(s,"class","svelte-xgf48k"),Object(c.g)(l,"class","column svelte-xgf48k"),Object(c.g)(n,"class","svelte-xgf48k"),Object(c.g)(e,"class","search-match svelte-xgf48k")},m(t,b){Object(c.F)(t,e,b),Object(c.e)(e,n),Object(c.e)(n,s),Object(c.e)(s,r),Object(c.e)(n,o),Object(c.e)(n,l);for(let t=0;t<u.length;t+=1)u[t].m(l,null);Object(c.e)(e,i)},p(t,e){if(1&e[0]&&b!==(b=t[26].sub.text.trim()+"")&&Object(c.T)(r,b),8193&e[0]){let n;for(a=t[26].subsequent,n=0;n<a.length;n+=1){const c=Pt(t,a,n);u[n]?u[n].p(c,e):(u[n]=qt(c),u[n].c(),u[n].m(l,null))}for(;n<u.length;n+=1)u[n].d(1);u.length=a.length}},d(t){t&&Object(c.v)(e),Object(c.u)(u,t)}}}function qt(t){let e,n,s,r,o,l,i,b,a,u=t[29].offset+"",d=t[29].text.trim()+"";function f(...e){return t[20](t[29],...e)}return{c(){e=Object(c.w)("button"),n=Object(c.ab)("("),s=Object(c.ab)(u),r=Object(c.ab)(")"),o=Object(c.w)("br"),l=Object(c.ab)(d),i=Object(c.W)(),Object(c.g)(e,"class","svelte-xgf48k")},m(t,u){Object(c.F)(t,e,u),Object(c.e)(e,n),Object(c.e)(e,s),Object(c.e)(e,r),Object(c.e)(e,o),Object(c.e)(e,l),Object(c.e)(e,i),b||(a=Object(c.H)(e,"click",f),b=!0)},p(e,n){t=e,1&n[0]&&u!==(u=t[29].offset+"")&&Object(c.T)(s,u),1&n[0]&&d!==(d=t[29].text.trim()+"")&&Object(c.T)(l,d)},d(t){t&&Object(c.v)(e),b=!1,a()}}}function Jt(t){let e;function n(t,e){return"search-match"===t[26].type?Vt:Gt}let s=n(t),r=s(t);return{c(){r.c(),e=Object(c.x)()},m(t,n){r.m(t,n),Object(c.F)(t,e,n)},p(t,c){s===(s=n(t))&&r?r.p(t,c):(r.d(1),r=s(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&Object(c.v)(e)}}}function Lt(t){let e,n,s,r,o;return{c(){e=Object(c.w)("p"),e.textContent="You haven't set an alignment for this show before",n=Object(c.W)(),s=Object(c.w)("button"),s.textContent="Assume subtitles are properly timed",Object(c.g)(e,"class","svelte-xgf48k"),Object(c.g)(s,"class","svelte-xgf48k")},m(l,i){Object(c.F)(l,e,i),Object(c.F)(l,n,i),Object(c.F)(l,s,i),r||(o=Object(c.H)(s,"click",t[17]),r=!0)},p:c.K,d(t){t&&Object(c.v)(e),t&&Object(c.v)(n),t&&Object(c.v)(s),r=!1,o()}}}function Dt(t){let e,n,s,r,o,l,i,b,a,u=t[7]&&function(t){let e,n;return{c(){e=Object(c.ab)("for "),n=Object(c.w)("span"),n.textContent=`${t[7]}`,Object(c.g)(n,"class","show-name svelte-xgf48k")},m(t,s){Object(c.F)(t,e,s),Object(c.F)(t,n,s)},p:c.K,d(t){t&&Object(c.v)(e),t&&Object(c.v)(n)}}}(t);return{c(){e=Object(c.w)("button"),n=Object(c.ab)("Use the last alignment\n\t\t\t\t\t\n\t\t\t\t\t"),u&&u.c(),s=Object(c.W)(),r=Object(c.w)("br"),o=Object(c.ab)("\n\t\t\t\t\t("),l=Object(c.ab)(t[5]),i=Object(c.ab)(")"),Object(c.g)(e,"class","svelte-xgf48k")},m(d,f){Object(c.F)(d,e,f),Object(c.e)(e,n),u&&u.m(e,null),Object(c.e)(e,s),Object(c.e)(e,r),Object(c.e)(e,o),Object(c.e)(e,l),Object(c.e)(e,i),b||(a=Object(c.H)(e,"click",t[12]),b=!0)},p(t,e){t[7]&&u.p(t,e),32&e[0]&&Object(c.T)(l,t[5])},d(t){t&&Object(c.v)(e),u&&u.d(),b=!1,a()}}}function Ut(t){let e,n,s,r;return s=new D({}),s.$on("aligned",t[15]),{c(){e=Object(c.w)("h2"),e.textContent="Other Recently Used Alignments",n=Object(c.W)(),Object(c.p)(s.$$.fragment),Object(c.g)(e,"class","svelte-xgf48k")},m(t,o){Object(c.F)(t,e,o),Object(c.F)(t,n,o),Object(c.J)(s,t,o),r=!0},p:c.K,i(t){r||(Object(c.db)(s.$$.fragment,t),r=!0)},o(t){Object(c.eb)(s.$$.fragment,t),r=!1},d(t){t&&Object(c.v)(e),t&&Object(c.v)(n),Object(c.t)(s,t)}}}function Yt(t){let e,n,s,r,o,l,i,b,a,u,d;function f(t,e){return t[2]===t[8].entry?Rt:Nt}let j=f(t),p=j(t);const O=[zt,It,Mt],g=[];function m(t,e){return t[2]===t[8].entry?0:t[2]===t[8].automatic?1:t[2]===t[8].manual?2:-1}return~(i=m(t))&&(b=g[i]=O[i](t)),{c(){e=Object(c.w)("div"),n=Object(c.w)("div"),s=Object(c.w)("button"),p.c(),r=Object(c.W)(),o=Object(c.w)("h1"),o.textContent="Alignment Adjustment",l=Object(c.W)(),b&&b.c(),Object(c.g)(s,"class","small-button secondary svelte-xgf48k"),Object(c.g)(o,"class","svelte-xgf48k"),Object(c.g)(n,"class","alignment-panel svelte-xgf48k"),Object(c.g)(e,"class","column svelte-xgf48k")},m(b,f){Object(c.F)(b,e,f),Object(c.e)(e,n),Object(c.e)(n,s),p.m(s,null),Object(c.e)(n,r),Object(c.e)(n,o),Object(c.e)(n,l),~i&&g[i].m(n,null),a=!0,u||(d=Object(c.H)(s,"click",t[9]),u=!0)},p(t,e){j!==(j=f(t))&&(p.d(1),p=j(t),p&&(p.c(),p.m(s,null)));let r=i;i=m(t),i===r?~i&&g[i].p(t,e):(b&&(Object(c.C)(),Object(c.eb)(g[r],1,1,()=>{g[r]=null}),Object(c.j)()),~i?(b=g[i],b||(b=g[i]=O[i](t),b.c()),Object(c.db)(b,1),b.m(n,null)):b=null)},i(t){a||(Object(c.db)(b),a=!0)},o(t){Object(c.eb)(b),a=!1},d(t){t&&Object(c.v)(e),p.d(),~i&&g[i].d(),u=!1,d()}}}function Xt(t){t.focus(),t.select()}function Zt(t,e,n){let r,o,l;Object(c.k)(t,$,t=>n(4,r=t)),Object(c.k)(t,T,t=>n(5,o=t)),Object(c.k)(t,C,t=>n(6,l=t));let{subtitles:i}=e;const b=Object(s.a)(),a=Object(c.A)(F),u={entry:"entry",manual:"manual",automatic:"automatic"};let d=i.getAlignmentCandidates(),f=Object(c.A)(A),j=d[0],p=u.entry,O="";function g(){const t=parseFloat(f);isNaN(t)?alert("Please enter a valid number!"):h(1e3*t)}function m(t){j=t,h()}function h(t){const e=document.querySelector("video"),n="number"==typeof t?t:1e3*e.currentTime-j.start-400;k.set(n),W(n),x()}function x(){b("done")}return t.$$set=t=>{"subtitles"in t&&n(16,i=t.subtitles)},t.$$.update=()=>{65544&t.$$.dirty[0]&&n(0,d=i.getAlignmentCandidates(O))},[d,f,p,O,r,o,l,a,u,function(){p!==u.entry?n(2,p=p===u.automatic?u.entry:u.automatic):b("reselect")},function(t){t.stopPropagation(),"Enter"===t.key&&g()},g,function(){h(Object(c.A)(k))},m,h,x,i,()=>h(0),()=>n(2,p=u.automatic),function(){O=this.value,n(3,O)},t=>m(t),t=>m(t),()=>n(2,p=u.manual),function(){f=this.value,n(1,f)}]}class Qt extends c.a{constructor(t){var e;super(),Tt.getElementById("svelte-xgf48k-style")||((e=Object(c.w)("style")).id="svelte-xgf48k-style",e.textContent=".column.svelte-xgf48k.svelte-xgf48k{display:flex;flex-direction:column;text-align:center}button.svelte-xgf48k.svelte-xgf48k{margin:0.5rem;align-self:center;max-width:20rem}.row.svelte-xgf48k.svelte-xgf48k{display:flex;flex-direction:row;justify-content:center;align-content:center}.row.svelte-xgf48k button.svelte-xgf48k{max-width:15rem}.show-name.svelte-xgf48k.svelte-xgf48k{font-style:italic}.alignment-panel.svelte-xgf48k.svelte-xgf48k{background:rgba(27, 26, 38, 0.9);align-self:center;padding:0.5rem;display:flex;flex-direction:column;border-radius:4px;justify-content:center;max-height:80vh;left:50vw;transform:translateX(-50%);position:absolute}fieldset.svelte-xgf48k.svelte-xgf48k{overflow:auto}.alignment-panel.svelte-xgf48k>.svelte-xgf48k:not(select):not(button){color:white}h1.svelte-xgf48k.svelte-xgf48k{margin:0}h1.svelte-xgf48k.svelte-xgf48k{font-size:1.3rem;border-bottom:2px solid #f47521}h2.svelte-xgf48k.svelte-xgf48k{font-size:0.9rem}p.svelte-xgf48k.svelte-xgf48k,label.svelte-xgf48k.svelte-xgf48k{max-width:14rem}.alignment-sign-hint.svelte-xgf48k.svelte-xgf48k{font-size:0.8rem}#manual-alignment.svelte-xgf48k.svelte-xgf48k{width:5rem;align-self:center}@media(max-width: 700px){button.svelte-xgf48k.svelte-xgf48k,input.svelte-xgf48k.svelte-xgf48k,label.svelte-xgf48k.svelte-xgf48k,legend.svelte-xgf48k.svelte-xgf48k,p.svelte-xgf48k.svelte-xgf48k{font-size:0.7rem !important;margin:0.2rem}.alignment-sign-hint.svelte-xgf48k.svelte-xgf48k{font-size:0.6rem}button.svelte-xgf48k.svelte-xgf48k{padding:4px}h1.svelte-xgf48k.svelte-xgf48k{font-size:1rem}h2.svelte-xgf48k.svelte-xgf48k{font-size:0.9rem}#subtitle-options.svelte-xgf48k.svelte-xgf48k{max-height:30vh}}h2.svelte-xgf48k.svelte-xgf48k{margin:0}p.svelte-xgf48k.svelte-xgf48k{align-self:center}.search-match.svelte-xgf48k.svelte-xgf48k:not(:last-child){margin-bottom:1rem}.search-match.svelte-xgf48k legend.svelte-xgf48k{white-space:pre;margin:0 auto}#subtitle-search.svelte-xgf48k.svelte-xgf48k{align-self:center;max-width:100%}",Object(c.e)(Tt.head,e)),Object(c.E)(this,t,Zt,Yt,c.S,{subtitles:16},[-1,-1])}}var te=Qt;function ee(t){let e,n;return{c:c.K,m(s,r){e||(n=Object(c.H)(window,"keydown",t[0]),e=!0)},p:c.K,i:c.K,o:c.K,d(t){e=!1,n()}}}function ne(t){return[function(t){const e=t.key.toLowerCase();"h"===e?f.update(t=>!t):"i"===e&&p.update(t=>!t)}]}class ce extends c.a{constructor(t){super(),Object(c.E)(this,t,ne,ee,c.S,{})}}var se=ce;const{document:re}=c.B;function oe(t){let e,n;return e=new it({props:{mode:"cancelled"}}),e.$on("restart",t[5]),{c(){Object(c.p)(e.$$.fragment)},m(t,s){Object(c.J)(e,t,s),n=!0},p:c.K,i(t){n||(Object(c.db)(e.$$.fragment,t),n=!0)},o(t){Object(c.eb)(e.$$.fragment,t),n=!1},d(t){Object(c.t)(e,t)}}}function le(t){let e,n,s,r;return e=new yt({props:{format:t[1].format,styles:t[1].styles,current:t[4]}}),e.$on("define-pauser",t[9]),s=new it({props:{recentSubs:t[2],subtitles:t[1]}}),s.$on("restart",t[5]),s.$on("tray-pauser",t[8]),s.$on("define-pauser",t[9]),s.$on("realign",t[12]),{c(){Object(c.p)(e.$$.fragment),n=Object(c.W)(),Object(c.p)(s.$$.fragment)},m(t,o){Object(c.J)(e,t,o),Object(c.F)(t,n,o),Object(c.J)(s,t,o),r=!0},p(t,n){const c={};2&n&&(c.format=t[1].format),2&n&&(c.styles=t[1].styles),16&n&&(c.current=t[4]),e.$set(c);const r={};4&n&&(r.recentSubs=t[2]),2&n&&(r.subtitles=t[1]),s.$set(r)},i(t){r||(Object(c.db)(e.$$.fragment,t),Object(c.db)(s.$$.fragment,t),r=!0)},o(t){Object(c.eb)(e.$$.fragment,t),Object(c.eb)(s.$$.fragment,t),r=!1},d(t){Object(c.t)(e,t),t&&Object(c.v)(n),Object(c.t)(s,t)}}}function ie(t){let e,n;return e=new te({props:{subtitles:t[1]}}),e.$on("done",t[6]),e.$on("reselect",t[11]),{c(){Object(c.p)(e.$$.fragment)},m(t,s){Object(c.J)(e,t,s),n=!0},p(t,n){const c={};2&n&&(c.subtitles=t[1]),e.$set(c)},i(t){n||(Object(c.db)(e.$$.fragment,t),n=!0)},o(t){Object(c.eb)(e.$$.fragment,t),n=!1},d(t){Object(c.t)(e,t)}}}function be(t){let e,n;return e=new Et({}),e.$on("subtitles-loaded",t[7]),e.$on("cancel",t[10]),{c(){Object(c.p)(e.$$.fragment)},m(t,s){Object(c.J)(e,t,s),n=!0},p:c.K,i(t){n||(Object(c.db)(e.$$.fragment,t),n=!0)},o(t){Object(c.eb)(e.$$.fragment,t),n=!1},d(t){Object(c.t)(e,t)}}}function ae(t){let e,n,s,r,o,l;const i=[be,ie,le,oe],b=[];function a(t,e){return"prompt"===t[0]?0:"align"===t[0]?1:"play"===t[0]?2:"cancelled"===t[0]?3:-1}return~(n=a(t))&&(s=b[n]=i[n](t)),o=new se({}),{c(){e=Object(c.w)("div"),s&&s.c(),r=Object(c.W)(),Object(c.p)(o.$$.fragment),Object(c.g)(e,"class","subtitles-app svelte-1vyp4w1")},m(t,s){Object(c.F)(t,e,s),~n&&b[n].m(e,null),Object(c.F)(t,r,s),Object(c.J)(o,t,s),l=!0},p(t,[r]){let o=n;n=a(t),n===o?~n&&b[n].p(t,r):(s&&(Object(c.C)(),Object(c.eb)(b[o],1,1,()=>{b[o]=null}),Object(c.j)()),~n?(s=b[n],s||(s=b[n]=i[n](t),s.c()),Object(c.db)(s,1),s.m(e,null)):s=null)},i(t){l||(Object(c.db)(s),Object(c.db)(o.$$.fragment,t),l=!0)},o(t){Object(c.eb)(s),Object(c.eb)(o.$$.fragment,t),l=!1},d(t){t&&Object(c.v)(e),~n&&b[n].d(),t&&Object(c.v)(r),Object(c.t)(o,t)}}}function ue(t,e,n){let r,o=c.K;t.$$.on_destroy.push(()=>o());const l=new wt;let i,b,a="prompt",u=[],d=null,f=null,j=-1,p=[];function O(){n(0,a="prompt"),n(1,d=null),u=[]}k.subscribe(t=>j=t),Object(s.c)(()=>{document.addEventListener("visibilitychange",()=>{document.hidden||l.removePauser("define")});let t="",e="";setInterval(()=>{const n=document.querySelector("video").getAttribute("src");n&&n!==t&&(t=n,O());const c=document.querySelector(".video-title"),s=c?c.textContent:"";s!==e&&(e=s,F.set(s))},50)});return[a,d,p,i,r,O,function(){f=document.querySelector("video"),l.setVideo(f),n(2,p=[]),n(0,a="play"),b&&b(),M=d,n(3,i=I(k)),o(),o=Object(c.Y)(i,t=>n(4,r=t)),b=i.subscribe(t=>{!function(t){let e=t[t.length-1],c=p[p.length-1];!e||c&&e.text===c.text||n(2,p=[...p,e]);p.length>10&&n(2,p=p.slice(p.length-10))}(t)})},function(t){n(1,d=t.detail),0===d.subs.length?(console.log("subtitles object failed to parse: ",d),alert("No subtitles were able to be parsed from the selected subtitle file, verify nothing is wrong with the file. If it appears normal please submit a bug report with the episode and the subtitles file you used to the issue tracker (a link can be found in the tray on the right side of the video player)!"),n(0,a="cancelled")):n(0,a="align")},function(t){t.detail?l.addPauser("tray"):l.removePauser("tray")},function(){l.addPauser("define")},()=>n(0,a="cancelled"),()=>n(0,a="prompt"),()=>n(0,a="align")]}class de extends c.a{constructor(t){var e;super(),re.getElementById("svelte-1vyp4w1-style")||((e=Object(c.w)("style")).id="svelte-1vyp4w1-style",e.textContent='.subtitles-app.svelte-1vyp4w1{position:relative;font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;text-align:center}.subtitles-app.svelte-1vyp4w1>*{z-index:1000000000}.subtitles-app.svelte-1vyp4w1 button,.subtitles-app.svelte-1vyp4w1 .button{background:#fd0;border:none;padding:10px;line-height:1;font-weight:bold;color:black;text-transform:uppercase;font-size:0.9rem;margin-bottom:0.2rem}.subtitles-app.svelte-1vyp4w1 .small-button{font-size:0.6rem}.subtitles-app.svelte-1vyp4w1 button:disabled,.subtitles-app.svelte-1vyp4w1 .button:disabled{background:#2a3450}.subtitles-app.svelte-1vyp4w1 button.secondary,.subtitles-app.svelte-1vyp4w1 .button.secondary{background:#11121863;border:1px solid #fd0;color:#fd0}.subtitles-app.svelte-1vyp4w1 button:not(:disabled):hover,.subtitles-app.svelte-1vyp4w1 .button:not(:disabled):hover{background:#ffea6d;cursor:pointer;color:black}.subtitles-app.svelte-1vyp4w1 input[type=text],.subtitles-app.svelte-1vyp4w1 input:not([type]){color:white;background:#0b0b26;border:1px solid #364962;padding:0.2rem}.subtitles-app.svelte-1vyp4w1 input[type=text]:focus,.subtitles-app.svelte-1vyp4w1 input:not([type]):focus{border-color:#fd0}.subtitles-app.svelte-1vyp4w1 .sr{position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden}',Object(c.e)(re.head,e)),Object(c.E)(this,t,ue,ae,c.S,{})}}var fe=de;const je=document.createElement("div");location.host.includes("crunchyroll")?document.getElementById("vilosRoot").appendChild(je):document.body.appendChild(je),je.id="sheodox-jimaku-player",je.style.position="fixed",je.style.width="100%";new fe({target:je})}]);
